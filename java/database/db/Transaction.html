<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://x.app/java/database/db/Transaction.html"><meta property="og:site_name" content="doc"><meta property="og:title" content="äº‹åŠ¡ä¸é”æœºåˆ¶"><meta property="og:description" content="MySQL Transaction äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼šæ˜¯ç”±ä¸€ç³»åˆ—å¯¹æ•°æ®åº“ä¸­æ•°æ®è¿›â¾è®¿é—®ï¼ˆæŸ¥è¯¢ï¼‰ä¸æ›´æ–°ï¼ˆå¢åˆ æ”¹ï¼‰çš„æ“ä½œæ‰€ç»„æˆçš„â¼€ä¸ªç¨‹åºæ‰§è¡Œé€»è¾‘å•å…ƒã€‚è¿™äº›æ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½ä¸æˆåŠŸã€‚ äº‹åŠ¡çš„ACIDç‰¹æ€§ äº‹åŠ¡å…·æœ‰å››ä¸ªé‡è¦ç‰¹å¾ï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œéš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼ŒæŒä¹…æ€§ï¼ˆDurabi..."><meta property="og:type" content="article"><meta property="og:image" content="https://image.ventix.top/img02/20220119212913677.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-01-21T13:53:36.000Z"><meta property="article:author" content="ventixy"><meta property="article:modified_time" content="2025-01-21T13:53:36.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"äº‹åŠ¡ä¸é”æœºåˆ¶","image":["https://image.ventix.top/img02/20220119212913677.png"],"dateModified":"2025-01-21T13:53:36.000Z","author":[{"@type":"Person","name":"ventixy","url":"https://www.ventix.top"}]}</script><link rel="icon" href="/jav.ico"><title>äº‹åŠ¡ä¸é”æœºåˆ¶ | doc</title><meta name="description" content="MySQL Transaction äº‹åŠ¡ï¼ˆTransactionï¼‰ï¼šæ˜¯ç”±ä¸€ç³»åˆ—å¯¹æ•°æ®åº“ä¸­æ•°æ®è¿›â¾è®¿é—®ï¼ˆæŸ¥è¯¢ï¼‰ä¸æ›´æ–°ï¼ˆå¢åˆ æ”¹ï¼‰çš„æ“ä½œæ‰€ç»„æˆçš„â¼€ä¸ªç¨‹åºæ‰§è¡Œé€»è¾‘å•å…ƒã€‚è¿™äº›æ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½ä¸æˆåŠŸã€‚ äº‹åŠ¡çš„ACIDç‰¹æ€§ äº‹åŠ¡å…·æœ‰å››ä¸ªé‡è¦ç‰¹å¾ï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œéš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼ŒæŒä¹…æ€§ï¼ˆDurabi...">
    <link rel="preload" href="/assets/style-B_XoRuKw.css" as="style"><link rel="stylesheet" href="/assets/style-B_XoRuKw.css">
    <link rel="modulepreload" href="/assets/app-CYbEao8O.js"><link rel="modulepreload" href="/assets/Transaction.html-B0Aih_ag.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-Cygfyzri.js" as="script"><link rel="prefetch" href="/assets/blog.html-Bbisoqvi.js" as="script"><link rel="prefetch" href="/assets/intro.html-_kecMhKB.js" as="script"><link rel="prefetch" href="/assets/index.html-CaxeAqLC.js" as="script"><link rel="prefetch" href="/assets/dev.html-DzAgkaN2.js" as="script"><link rel="prefetch" href="/assets/lang.html-DTz82Fex.js" as="script"><link rel="prefetch" href="/assets/mcp.html-V80QfQVq.js" as="script"><link rel="prefetch" href="/assets/program.html-iQpmuO6a.js" as="script"><link rel="prefetch" href="/assets/prompt.html-BhUndXTb.js" as="script"><link rel="prefetch" href="/assets/rag.html-CJmfPqwM.js" as="script"><link rel="prefetch" href="/assets/springai.html-3PjEwPdH.js" as="script"><link rel="prefetch" href="/assets/index.html-B-jUVxnq.js" as="script"><link rel="prefetch" href="/assets/index.html-BUf57QO5.js" as="script"><link rel="prefetch" href="/assets/index.html-C3_Au531.js" as="script"><link rel="prefetch" href="/assets/index.html-BTnDf4bI.js" as="script"><link rel="prefetch" href="/assets/Gradle.html-fb1QzWuk.js" as="script"><link rel="prefetch" href="/assets/index.html-CHD_1IOR.js" as="script"><link rel="prefetch" href="/assets/maven.html-C2qTN1ya.js" as="script"><link rel="prefetch" href="/assets/theme.html-CzKVvEle.js" as="script"><link rel="prefetch" href="/assets/index.html-DOEh-8hM.js" as="script"><link rel="prefetch" href="/assets/index.html-C35HaWf2.js" as="script"><link rel="prefetch" href="/assets/index.html-B8Udp1vy.js" as="script"><link rel="prefetch" href="/assets/c.html-C501vqVq.js" as="script"><link rel="prefetch" href="/assets/c2.html-Dzf1cWkX.js" as="script"><link rel="prefetch" href="/assets/core.html-B39mlT32.js" as="script"><link rel="prefetch" href="/assets/index.html-DvchOMxj.js" as="script"><link rel="prefetch" href="/assets/Annotation.html-D8r6T2pQ.js" as="script"><link rel="prefetch" href="/assets/Enum.html-BfNjNGe2.js" as="script"><link rel="prefetch" href="/assets/HashMap.html-SQisto7k.js" as="script"><link rel="prefetch" href="/assets/JavaåŸºç¡€.html-Cn8XUAXB.js" as="script"><link rel="prefetch" href="/assets/Javaå¸¸ç”¨ç±»åº“.html-Bx7uaMMC.js" as="script"><link rel="prefetch" href="/assets/Javaé¢å‘å¯¹è±¡.html-x-67g_N7.js" as="script"><link rel="prefetch" href="/assets/Lambda.html-D4FJ1FqO.js" as="script"><link rel="prefetch" href="/assets/index.html-DrxkdYdb.js" as="script"><link rel="prefetch" href="/assets/Reflection.html-C6WH4Hi5.js" as="script"><link rel="prefetch" href="/assets/Stream.html-BX5Jz0kj.js" as="script"><link rel="prefetch" href="/assets/collection.html-DIk4Mcpe.js" as="script"><link rel="prefetch" href="/assets/generics.html-dZTkr-aR.js" as="script"><link rel="prefetch" href="/assets/javaIO.html-C1eAg7-Q.js" as="script"><link rel="prefetch" href="/assets/setå’Œmap.html-dXSG_TpO.js" as="script"><link rel="prefetch" href="/assets/æ•°ç»„å’Œå­—ç¬¦ä¸².html-DpIN09Ao.js" as="script"><link rel="prefetch" href="/assets/index.html-BzGemQho.js" as="script"><link rel="prefetch" href="/assets/index.html-6FV98iwi.js" as="script"><link rel="prefetch" href="/assets/index.html-B87Jt2wX.js" as="script"><link rel="prefetch" href="/assets/index.html-EIeHqQM6.js" as="script"><link rel="prefetch" href="/assets/index.html-BNuVXJ5q.js" as="script"><link rel="prefetch" href="/assets/index.html-CtyHu41a.js" as="script"><link rel="prefetch" href="/assets/idea.html-282Lx6Bo.js" as="script"><link rel="prefetch" href="/assets/mac.html-DTDpWnqv.js" as="script"><link rel="prefetch" href="/assets/nuc8.html-aJmKFRT7.js" as="script"><link rel="prefetch" href="/assets/picgo.html-FJ29dmzO.js" as="script"><link rel="prefetch" href="/assets/usual.html-0PtZaXRt.js" as="script"><link rel="prefetch" href="/assets/vps.html-CwGQK0kE.js" as="script"><link rel="prefetch" href="/assets/website.html-BFCNpuDJ.js" as="script"><link rel="prefetch" href="/assets/windows.html-Nxk3R8uK.js" as="script"><link rel="prefetch" href="/assets/index.html-CgsDZvWm.js" as="script"><link rel="prefetch" href="/assets/encoding.html-DfKrGdSt.js" as="script"><link rel="prefetch" href="/assets/harddisk.html-htMBvwMD.js" as="script"><link rel="prefetch" href="/assets/index.html-BZw9XDYb.js" as="script"><link rel="prefetch" href="/assets/mysql-binlog.html-Cj7vTgYP.js" as="script"><link rel="prefetch" href="/assets/mysql-lock.html-BahfOMhX.js" as="script"><link rel="prefetch" href="/assets/mysql.html-DFzMHqJs.js" as="script"><link rel="prefetch" href="/assets/postgres.html-CDsrHAu4.js" as="script"><link rel="prefetch" href="/assets/ulimit.html-DCmoLP7O.js" as="script"><link rel="prefetch" href="/assets/index.html-LtAD785R.js" as="script"><link rel="prefetch" href="/assets/env.html-Xo4TUOWl.js" as="script"><link rel="prefetch" href="/assets/history.html-DC9k8D05.js" as="script"><link rel="prefetch" href="/assets/jar.html-CcUhZZB-.js" as="script"><link rel="prefetch" href="/assets/kryo.html-Bo_2zDmK.js" as="script"><link rel="prefetch" href="/assets/index.html-DabYQfXK.js" as="script"><link rel="prefetch" href="/assets/k8s.html-CS4B4XAM.js" as="script"><link rel="prefetch" href="/assets/ks-install.html-IhQezYAS.js" as="script"><link rel="prefetch" href="/assets/vm.html-_W0Ta4DN.js" as="script"><link rel="prefetch" href="/assets/index.html-ZJiDlG8g.js" as="script"><link rel="prefetch" href="/assets/crossDomain.html-ChswF6dq.js" as="script"><link rel="prefetch" href="/assets/excel.html-Dyz5e82X.js" as="script"><link rel="prefetch" href="/assets/springboot.html-XsrWyu-P.js" as="script"><link rel="prefetch" href="/assets/index.html-DmLBgxaD.js" as="script"><link rel="prefetch" href="/assets/index.html-C5xbaPEt.js" as="script"><link rel="prefetch" href="/assets/PICO.html-DDaywnzr.js" as="script"><link rel="prefetch" href="/assets/index.html-DeR6BtIG.js" as="script"><link rel="prefetch" href="/assets/ch9329.html-CRmxwCjf.js" as="script"><link rel="prefetch" href="/assets/damb.html-Cl1ZA0ea.js" as="script"><link rel="prefetch" href="/assets/hid.html-D7l9GbCd.js" as="script"><link rel="prefetch" href="/assets/index.html-DinpFnT9.js" as="script"><link rel="prefetch" href="/assets/base.html-CQ8w10kQ.js" as="script"><link rel="prefetch" href="/assets/data.html-BLyFoxwX.js" as="script"><link rel="prefetch" href="/assets/file.html-B6y96nQl.js" as="script"><link rel="prefetch" href="/assets/function.html-CwGerRS1.js" as="script"><link rel="prefetch" href="/assets/oop.html-BvS5Zi-s.js" as="script"><link rel="prefetch" href="/assets/index.html-CX8hbQ_w.js" as="script"><link rel="prefetch" href="/assets/pywin32.html-CWnnlANQ.js" as="script"><link rel="prefetch" href="/assets/yolo.html-CK7U_dmO.js" as="script"><link rel="prefetch" href="/assets/index.html-BqwCZPwM.js" as="script"><link rel="prefetch" href="/assets/base.html-B7cq7clz.js" as="script"><link rel="prefetch" href="/assets/numpy.html-D-NDQqET.js" as="script"><link rel="prefetch" href="/assets/opencv.html-BMuxAxgk.js" as="script"><link rel="prefetch" href="/assets/pillow.html-DTt08qN2.js" as="script"><link rel="prefetch" href="/assets/python.html-B0uKeY6j.js" as="script"><link rel="prefetch" href="/assets/sd.html-B-GvrXsU.js" as="script"><link rel="prefetch" href="/assets/index.html-Dr8hl0wd.js" as="script"><link rel="prefetch" href="/assets/application.html-BV8BxRo7.js" as="script"><link rel="prefetch" href="/assets/call.html-BtKIRSIl.js" as="script"><link rel="prefetch" href="/assets/http.html-CgQDytuM.js" as="script"><link rel="prefetch" href="/assets/interface.html-ld5qkKIK.js" as="script"><link rel="prefetch" href="/assets/io.html-AJHEsWDu.js" as="script"><link rel="prefetch" href="/assets/memory.html-C9kzedI-.js" as="script"><link rel="prefetch" href="/assets/network.html-Dp74x59S.js" as="script"><link rel="prefetch" href="/assets/os.html-BcsRXHge.js" as="script"><link rel="prefetch" href="/assets/process.html-_arsgibw.js" as="script"><link rel="prefetch" href="/assets/transport.html-BqoGc87Z.js" as="script"><link rel="prefetch" href="/assets/index.html-ddv3MG6G.js" as="script"><link rel="prefetch" href="/assets/index.html-DrsnyzlP.js" as="script"><link rel="prefetch" href="/assets/Linux.html-Cm_aFsmu.js" as="script"><link rel="prefetch" href="/assets/index.html-D0JAEB--.js" as="script"><link rel="prefetch" href="/assets/file.html-Cq0lDRon.js" as="script"><link rel="prefetch" href="/assets/setting.html-Cz-RyOK7.js" as="script"><link rel="prefetch" href="/assets/shell.html-BHso3m1Q.js" as="script"><link rel="prefetch" href="/assets/Docker.html-4nTlno4G.js" as="script"><link rel="prefetch" href="/assets/index.html-DzC3JnIL.js" as="script"><link rel="prefetch" href="/assets/install.html-H0NFS6Uc.js" as="script"><link rel="prefetch" href="/assets/k8s.html-BcTbdTcG.js" as="script"><link rel="prefetch" href="/assets/index.html-BnF-DX8i.js" as="script"><link rel="prefetch" href="/assets/git.html-CJGGVixb.js" as="script"><link rel="prefetch" href="/assets/git1.html-DaOtr_kC.js" as="script"><link rel="prefetch" href="/assets/jenkins.html-B2v-aWc0.js" as="script"><link rel="prefetch" href="/assets/index.html-B_KeBbR4.js" as="script"><link rel="prefetch" href="/assets/index.html-BDVTA5ym.js" as="script"><link rel="prefetch" href="/assets/index.html-Dfj41VEs.js" as="script"><link rel="prefetch" href="/assets/index.html-CPLwhCcN.js" as="script"><link rel="prefetch" href="/assets/index.html-Clkv0jFl.js" as="script"><link rel="prefetch" href="/assets/netty.html-DVDprFfo.js" as="script"><link rel="prefetch" href="/assets/nio.html-DlFbzpZx.js" as="script"><link rel="prefetch" href="/assets/socket.html-B0OiM2FD.js" as="script"><link rel="prefetch" href="/assets/theory.html-DME1w7It.js" as="script"><link rel="prefetch" href="/assets/Jvmå†…å­˜ç®¡ç†.html-j8Re9xLU.js" as="script"><link rel="prefetch" href="/assets/Jvmç±»åŠ è½½.html-DJ-ysQ1Y.js" as="script"><link rel="prefetch" href="/assets/index.html-Yma0YYGg.js" as="script"><link rel="prefetch" href="/assets/bytecode.html-QH1zTLls.js" as="script"><link rel="prefetch" href="/assets/pt.html-CB1_7Phu.js" as="script"><link rel="prefetch" href="/assets/index.html-C8as36N9.js" as="script"><link rel="prefetch" href="/assets/lock.html-C1yTJ-g3.js" as="script"><link rel="prefetch" href="/assets/pool.html-Dg2l0lOW.js" as="script"><link rel="prefetch" href="/assets/thread.html-CvJd-bdn.js" as="script"><link rel="prefetch" href="/assets/tool.html-BJqeYZJh.js" as="script"><link rel="prefetch" href="/assets/Architecture.html-qnS_E4w6.js" as="script"><link rel="prefetch" href="/assets/index.html-CdvwvR9M.js" as="script"><link rel="prefetch" href="/assets/mysql-index.html-fX29xgPL.js" as="script"><link rel="prefetch" href="/assets/redis-java.html-CzI1g89Z.js" as="script"><link rel="prefetch" href="/assets/redis.html-7RL3CUlo.js" as="script"><link rel="prefetch" href="/assets/sql.html-yN06V877.js" as="script"><link rel="prefetch" href="/assets/Hibernate.html-Nt0GZATi.js" as="script"><link rel="prefetch" href="/assets/index.html-Dv7STxhH.js" as="script"><link rel="prefetch" href="/assets/generator.html-CN5rX70j.js" as="script"><link rel="prefetch" href="/assets/mybatis-resource.html-WXuVV76F.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-PnyhFFzL.js" as="script"><link rel="prefetch" href="/assets/tk-mybatis.html-6orVKYMW.js" as="script"><link rel="prefetch" href="/assets/index.html-8SBcULZn.js" as="script"><link rel="prefetch" href="/assets/Servlet.html-CBEpWT9G.js" as="script"><link rel="prefetch" href="/assets/jsp.html-BF246k5D.js" as="script"><link rel="prefetch" href="/assets/mvc.html-H_nZ4f0m.js" as="script"><link rel="prefetch" href="/assets/nginx.html-CNUu-Jds.js" as="script"><link rel="prefetch" href="/assets/tomcat.html-8y2sPrtZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BJfwWPM-.js" as="script"><link rel="prefetch" href="/assets/log.html-DFHlNCTC.js" as="script"><link rel="prefetch" href="/assets/shiro.html-B--dXyuX.js" as="script"><link rel="prefetch" href="/assets/index.html-B8spMVmQ.js" as="script"><link rel="prefetch" href="/assets/design.html-DvbPMGvf.js" as="script"><link rel="prefetch" href="/assets/life.html-CyBmOK95.js" as="script"><link rel="prefetch" href="/assets/mvc-core.html-DO1TK80F.js" as="script"><link rel="prefetch" href="/assets/sb-core.html-Cztp04Wy.js" as="script"><link rel="prefetch" href="/assets/sec.html-Ks1LenAX.js" as="script"><link rel="prefetch" href="/assets/spring.html-BJ17uaA-.js" as="script"><link rel="prefetch" href="/assets/springboot.html-Br9Et0RA.js" as="script"><link rel="prefetch" href="/assets/springmvc.html-CBtc7iWY.js" as="script"><link rel="prefetch" href="/assets/transaction.html-DZ6KIifW.js" as="script"><link rel="prefetch" href="/assets/index.html-rq4jq_Lc.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-DEIvIY_D.js" as="script"><link rel="prefetch" href="/assets/mysql.html-DRg7K0gs.js" as="script"><link rel="prefetch" href="/assets/redis.html-CJRdRYvp.js" as="script"><link rel="prefetch" href="/assets/security.html-B1gh7vfK.js" as="script"><link rel="prefetch" href="/assets/spring.html-DSVwakKn.js" as="script"><link rel="prefetch" href="/assets/springboot.html-CoMpjK2J.js" as="script"><link rel="prefetch" href="/assets/index.html-CDUiSr-c.js" as="script"><link rel="prefetch" href="/assets/base.html-DWgJPIPK.js" as="script"><link rel="prefetch" href="/assets/collect.html-Bl_ZKiQM.js" as="script"><link rel="prefetch" href="/assets/concurrency.html-CnM6diFo.js" as="script"><link rel="prefetch" href="/assets/jvm.html-Dd422-Hx.js" as="script"><link rel="prefetch" href="/assets/index.html-DBtaICdJ.js" as="script"><link rel="prefetch" href="/assets/es.html-C04swIWt.js" as="script"><link rel="prefetch" href="/assets/rocketmq.html-D8GsKibm.js" as="script"><link rel="prefetch" href="/assets/sys.html-Bm3pD7W3.js" as="script"><link rel="prefetch" href="/assets/index.html-Dfi3O-LT.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html--pAav3UF.js" as="script"><link rel="prefetch" href="/assets/RockMQ.html-DdYHY5c6.js" as="script"><link rel="prefetch" href="/assets/Sentinel.html-BZQgvmWt.js" as="script"><link rel="prefetch" href="/assets/dubbo.html-BK_2ezpk.js" as="script"><link rel="prefetch" href="/assets/es.html-Cc0ong64.js" as="script"><link rel="prefetch" href="/assets/eureka.html-Do3472Gl.js" as="script"><link rel="prefetch" href="/assets/gateway.html-lrPlHM9a.js" as="script"><link rel="prefetch" href="/assets/hystrix.html-C_-tkA95.js" as="script"><link rel="prefetch" href="/assets/kafka.html-2-kqHeIn.js" as="script"><link rel="prefetch" href="/assets/nacos.html-CH1dI2sX.js" as="script"><link rel="prefetch" href="/assets/zookeeper.html-B3hftmrJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CcW0MVh0.js" as="script"><link rel="prefetch" href="/assets/cron.html-DEBIb9en.js" as="script"><link rel="prefetch" href="/assets/db.html-DTDimjmf.js" as="script"><link rel="prefetch" href="/assets/dup.html-SaHJHaHX.js" as="script"><link rel="prefetch" href="/assets/lock.html-D-jCBfU2.js" as="script"><link rel="prefetch" href="/assets/redis.html-wMGQQXCt.js" as="script"><link rel="prefetch" href="/assets/transac.html-i-gow_fg.js" as="script"><link rel="prefetch" href="/assets/walk.html-ltUpWt1A.js" as="script"><link rel="prefetch" href="/assets/index.html-BG-VdKAi.js" as="script"><link rel="prefetch" href="/assets/numpy.html-DFpDzTud.js" as="script"><link rel="prefetch" href="/assets/pandas.html-B0ghgZGo.js" as="script"><link rel="prefetch" href="/assets/index.html-DHiUkDGF.js" as="script"><link rel="prefetch" href="/assets/css.html-DPlZXza3.js" as="script"><link rel="prefetch" href="/assets/css2.html-BBTuDL6p.js" as="script"><link rel="prefetch" href="/assets/css3.html-Dd1JshDN.js" as="script"><link rel="prefetch" href="/assets/css4.html-dxClVPyX.js" as="script"><link rel="prefetch" href="/assets/html.html-C4uEhZNf.js" as="script"><link rel="prefetch" href="/assets/html5.html-DXi8zT_t.js" as="script"><link rel="prefetch" href="/assets/index.html-BjmfCjsU.js" as="script"><link rel="prefetch" href="/assets/dom.html-D6C0GmUH.js" as="script"><link rel="prefetch" href="/assets/es6.html-Dd6gGVU6.js" as="script"><link rel="prefetch" href="/assets/js.html-BKCfzT2z.js" as="script"><link rel="prefetch" href="/assets/js2.html-B0xHqbgN.js" as="script"><link rel="prefetch" href="/assets/index.html-Dnn-5Myu.js" as="script"><link rel="prefetch" href="/assets/ts.html-DLkDEW9O.js" as="script"><link rel="prefetch" href="/assets/ts2.html-iUxniJdR.js" as="script"><link rel="prefetch" href="/assets/index.html-Z2FcNKHI.js" as="script"><link rel="prefetch" href="/assets/react.html-BhMy19C9.js" as="script"><link rel="prefetch" href="/assets/ui.html-CO1yz8Tj.js" as="script"><link rel="prefetch" href="/assets/vue.html-60Q21q7v.js" as="script"><link rel="prefetch" href="/assets/index.html-i2FGAbTJ.js" as="script"><link rel="prefetch" href="/assets/backend.html-BbZVQMc0.js" as="script"><link rel="prefetch" href="/assets/nestjs.html-CWNgYskl.js" as="script"><link rel="prefetch" href="/assets/index.html--L0U4DLt.js" as="script"><link rel="prefetch" href="/assets/build.html-DDrHDtgy.js" as="script"><link rel="prefetch" href="/assets/format.html-BM91zCOx.js" as="script"><link rel="prefetch" href="/assets/node.html-CLIsFeSZ.js" as="script"><link rel="prefetch" href="/assets/index.html-GWJfLyyN.js" as="script"><link rel="prefetch" href="/assets/index.html-D2uSN1GF.js" as="script"><link rel="prefetch" href="/assets/index.html-D8rEBkRy.js" as="script"><link rel="prefetch" href="/assets/baz.html-DCoDkWxB.js" as="script"><link rel="prefetch" href="/assets/index.html-BkO9UHwJ.js" as="script"><link rel="prefetch" href="/assets/ray.html-CpD8kU-D.js" as="script"><link rel="prefetch" href="/assets/404.html-B-r8-OX6.js" as="script"><link rel="prefetch" href="/assets/index.html-CfN3Hcaw.js" as="script"><link rel="prefetch" href="/assets/index.html-Kjyi5J2A.js" as="script"><link rel="prefetch" href="/assets/index.html-DFDTwjUa.js" as="script"><link rel="prefetch" href="/assets/index.html-BfYrSWsb.js" as="script"><link rel="prefetch" href="/assets/index.html-CmVvGxuU.js" as="script"><link rel="prefetch" href="/assets/index.html-DIvrx9M_.js" as="script"><link rel="prefetch" href="/assets/index.html-DymN6sBe.js" as="script"><link rel="prefetch" href="/assets/index.html-D12kYdZ7.js" as="script"><link rel="prefetch" href="/assets/index.html-CE9-vc7S.js" as="script"><link rel="prefetch" href="/assets/index.html-R4-wXX9q.js" as="script"><link rel="prefetch" href="/assets/index.html-C5lWNcEB.js" as="script"><link rel="prefetch" href="/assets/index.html-CNBC7h0k.js" as="script"><link rel="prefetch" href="/assets/index.html-CwtCQoEq.js" as="script"><link rel="prefetch" href="/assets/index.html-FpvglhkP.js" as="script"><link rel="prefetch" href="/assets/index.html-DYewPzYK.js" as="script"><link rel="prefetch" href="/assets/index.html-DlHraM5W.js" as="script"><link rel="prefetch" href="/assets/index.html-B1U9NMIg.js" as="script"><link rel="prefetch" href="/assets/index.html-CMVjLthT.js" as="script"><link rel="prefetch" href="/assets/index.html-BAIUxd4b.js" as="script"><link rel="prefetch" href="/assets/index.html-CcXHauUc.js" as="script"><link rel="prefetch" href="/assets/index.html-DlWFhQAh.js" as="script"><link rel="prefetch" href="/assets/index.html-5Y8FuIY3.js" as="script"><link rel="prefetch" href="/assets/index.html-J1p_eGlb.js" as="script"><link rel="prefetch" href="/assets/index.html-BZCRz5gv.js" as="script"><link rel="prefetch" href="/assets/index.html-CQhckmWh.js" as="script"><link rel="prefetch" href="/assets/index.html-jHP9nIpi.js" as="script"><link rel="prefetch" href="/assets/index.html-Cm26WBxm.js" as="script"><link rel="prefetch" href="/assets/index.html-B3hg6GV3.js" as="script"><link rel="prefetch" href="/assets/index.html-BIX27Gmp.js" as="script"><link rel="prefetch" href="/assets/index.html-DVHEGjMt.js" as="script"><link rel="prefetch" href="/assets/index.html-RK-J8b_u.js" as="script"><link rel="prefetch" href="/assets/index.html-B16ztYg-.js" as="script"><link rel="prefetch" href="/assets/index.html-DDrc9TiV.js" as="script"><link rel="prefetch" href="/assets/index.html-DKjI7Y2e.js" as="script"><link rel="prefetch" href="/assets/index.html-CnwSR7Wc.js" as="script"><link rel="prefetch" href="/assets/index.html-B8nSGQOu.js" as="script"><link rel="prefetch" href="/assets/index.html-nNkowOzK.js" as="script"><link rel="prefetch" href="/assets/index.html-D1UCmhni.js" as="script"><link rel="prefetch" href="/assets/index.html-CDxMLJ1l.js" as="script"><link rel="prefetch" href="/assets/index.html-BDPZVId-.js" as="script"><link rel="prefetch" href="/assets/index.html-BcSiMV1v.js" as="script"><link rel="prefetch" href="/assets/index.html-dpHuK_DW.js" as="script"><link rel="prefetch" href="/assets/index.html-DC2uo5lk.js" as="script"><link rel="prefetch" href="/assets/index.html-id-krpAg.js" as="script"><link rel="prefetch" href="/assets/index.html-B-k9gcpd.js" as="script"><link rel="prefetch" href="/assets/index.html-Bg_WCly5.js" as="script"><link rel="prefetch" href="/assets/index.html-C_W5ueSp.js" as="script"><link rel="prefetch" href="/assets/index.html-CGs-6kN0.js" as="script"><link rel="prefetch" href="/assets/index.html-DOki0epm.js" as="script"><link rel="prefetch" href="/assets/index.html-D-NEPBbq.js" as="script"><link rel="prefetch" href="/assets/index.html-De-X1HAS.js" as="script"><link rel="prefetch" href="/assets/index.html-DL5BYvCo.js" as="script"><link rel="prefetch" href="/assets/index.html-abQVA6uc.js" as="script"><link rel="prefetch" href="/assets/index.html-jDzwgSn3.js" as="script"><link rel="prefetch" href="/assets/index.html-DOCal--h.js" as="script"><link rel="prefetch" href="/assets/index.html-BOJ9A6eV.js" as="script"><link rel="prefetch" href="/assets/index.html-CfB_E_cN.js" as="script"><link rel="prefetch" href="/assets/index.html-CxNo7H5e.js" as="script"><link rel="prefetch" href="/assets/index.html-DqVxGmUF.js" as="script"><link rel="prefetch" href="/assets/index.html-6rJ2y6ZE.js" as="script"><link rel="prefetch" href="/assets/index.html-BDCXUTNd.js" as="script"><link rel="prefetch" href="/assets/index.html-ZZMw3JNl.js" as="script"><link rel="prefetch" href="/assets/index.html-mOHm16pi.js" as="script"><link rel="prefetch" href="/assets/index.html-3Rh-0wxr.js" as="script"><link rel="prefetch" href="/assets/index.html-DJgGto4P.js" as="script"><link rel="prefetch" href="/assets/index.html-DT4XkccF.js" as="script"><link rel="prefetch" href="/assets/index.html-F0b1YsrA.js" as="script"><link rel="prefetch" href="/assets/index.html-CL83qZdD.js" as="script"><link rel="prefetch" href="/assets/index.html-ChFeFdmx.js" as="script"><link rel="prefetch" href="/assets/index.html-DoMFsb2J.js" as="script"><link rel="prefetch" href="/assets/index.html-CP1_xS0g.js" as="script"><link rel="prefetch" href="/assets/index.html-D_cKi3ai.js" as="script"><link rel="prefetch" href="/assets/index.html-CPQBrBFc.js" as="script"><link rel="prefetch" href="/assets/index.html-BBjUgv6N.js" as="script"><link rel="prefetch" href="/assets/index.html-DDN9wQxt.js" as="script"><link rel="prefetch" href="/assets/index.html-YjWLNNBB.js" as="script"><link rel="prefetch" href="/assets/index.html-CH-icHGX.js" as="script"><link rel="prefetch" href="/assets/index.html-BcHdmWER.js" as="script"><link rel="prefetch" href="/assets/index.html-GgGR4x_9.js" as="script"><link rel="prefetch" href="/assets/index.html-Br06Ugs_.js" as="script"><link rel="prefetch" href="/assets/index.html-Bs7Umwxc.js" as="script"><link rel="prefetch" href="/assets/index.html-Dbp1NkcC.js" as="script"><link rel="prefetch" href="/assets/index.html-DL4uIEZx.js" as="script"><link rel="prefetch" href="/assets/index.html-DkJeuH-O.js" as="script"><link rel="prefetch" href="/assets/flowchart-CTwbLKUk.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-B5TJVwBc.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">doc</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/AI/" aria-label="  AI  "><!--[--><span class="font-icon icon iconfont icon-ai-robot" style=""></span><!--]-->  AI  <!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Java"><!--[--><span class="font-icon icon iconfont icon-java" style=""></span>Java<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Javaå¼€å‘çŸ¥è¯†ä½“ç³»</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/base/" aria-label="JavaåŸºç¡€è¯­æ³•å…¥é—¨"><!---->JavaåŸºç¡€è¯­æ³•å…¥é—¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/core/" aria-label="Javaè¿›é˜¶åŠæ ¸å¿ƒç‰¹æ€§"><!---->Javaè¿›é˜¶åŠæ ¸å¿ƒç‰¹æ€§<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/frame/" aria-label="JavaWebåŠå¸¸ç”¨æ¡†æ¶"><!---->JavaWebåŠå¸¸ç”¨æ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/java/database/" aria-label="æ•°æ®åº“ä¸ORMæ¡†æ¶"><!---->æ•°æ®åº“ä¸ORMæ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/service/" aria-label="åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡æ¶æ„"><!---->åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡æ¶æ„<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Javaé¡¹ç›®åŠè§£å†³æ–¹æ¡ˆ</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/base/" aria-label="å¸¸è§å·¥å…·å’Œç¯å¢ƒ"><!---->å¸¸è§å·¥å…·å’Œç¯å¢ƒ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/mall/" aria-label="ç”µå•†é¡¹ç›®ç»¼åˆå®è·µ"><!---->ç”µå•†é¡¹ç›®ç»¼åˆå®è·µ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/solution/" aria-label="é¡¹ç›®åœºæ™¯è§£å†³æ–¹æ¡ˆ"><!---->é¡¹ç›®åœºæ™¯è§£å†³æ–¹æ¡ˆ<!----></a></li></ul></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/java/interview/" aria-label="Javaå¸¸è§é¢è¯•é¢˜åˆ†æ"><!--[--><span class="font-icon icon iconfont icon-microservice" style=""></span><!--]-->Javaå¸¸è§é¢è¯•é¢˜åˆ†æ<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Web"><!--[--><span class="font-icon icon iconfont icon-net" style=""></span>Web<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/base/" aria-label="å‰ç«¯åŸºç¡€çŸ¥è¯†"><!--[--><span class="font-icon icon iconfont icon-net" style=""></span><!--]-->å‰ç«¯åŸºç¡€çŸ¥è¯†<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/core/" aria-label="å¼€å‘æ¡†æ¶å’Œå·¥å…·"><!--[--><span class="font-icon icon iconfont icon-cloud" style=""></span><!--]-->å¼€å‘æ¡†æ¶å’Œå·¥å…·<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/security/" aria-label="æ€§èƒ½ä¼˜åŒ–ä¸Webå®‰å…¨"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span><!--]-->æ€§èƒ½ä¼˜åŒ–ä¸Webå®‰å…¨<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Python"><!--[--><span class="font-icon icon iconfont icon-python" style=""></span>Python<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/base/" aria-label="å¼€å‘ç¯å¢ƒå’ŒåŸºç¡€è¯­æ³•"><!--[--><span class="font-icon icon iconfont icon-python" style=""></span><!--]-->å¼€å‘ç¯å¢ƒå’ŒåŸºç¡€è¯­æ³•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/frame/" aria-label="å¸¸ç”¨åº“å’Œæ¡†æ¶"><!--[--><span class="font-icon icon iconfont icon-app" style=""></span><!--]-->å¸¸ç”¨åº“å’Œæ¡†æ¶<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/image/" aria-label="Pythonå›¾åƒå¤„ç†"><!--[--><span class="font-icon icon iconfont icon-img" style=""></span><!--]-->Pythonå›¾åƒå¤„ç†<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/Project/" aria-label="ç›¸å…³é¡¹ç›®åŠåº”ç”¨"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span><!--]-->ç›¸å…³é¡¹ç›®åŠåº”ç”¨<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="C++"><!--[--><span class="font-icon icon iconfont icon-cpp" style=""></span>C++<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/cpp/base/" aria-label="C/C++åŸºç¡€è¯­æ³•å…¥é—¨"><!---->C/C++åŸºç¡€è¯­æ³•å…¥é—¨<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/cpp/ed/" aria-label="å•ç‰‡æœºå’ŒåµŒå…¥å¼å¼€å‘"><!---->å•ç‰‡æœºå’ŒåµŒå…¥å¼å¼€å‘<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Blog"><!--[--><span class="font-icon icon iconfont icon-blog" style=""></span>Blog<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog.html" aria-label="Blog HomePage"><!--[--><span class="font-icon icon iconfont icon-home" style=""></span><!--]-->Blog HomePage<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/blog/" aria-label="å¯¼èˆª/æ—¥å¸¸åšå®¢è®°å½•"><!---->å¯¼èˆª/æ—¥å¸¸åšå®¢è®°å½•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/cs/" aria-label="è®¡ç®—æœºç†è®ºåŸºç¡€"><!---->è®¡ç®—æœºç†è®ºåŸºç¡€<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="Java/AIå¼€å‘ç›¸å…³è®°å½•"><!---->Java/AIå¼€å‘ç›¸å…³è®°å½•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/db/" aria-label="æ•°æ®åº“ç›¸å…³åšå®¢"><!---->æ•°æ®åº“ç›¸å…³åšå®¢<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/om/" aria-label="è¿ç»´åŸºç¡€åŠç¯å¢ƒæ­å»º"><!---->è¿ç»´åŸºç¡€åŠç¯å¢ƒæ­å»º<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/ventixy/notebook" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-db" style=""></span><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/java/database/" aria-label="æ•°æ®åº“ä¸ORMæ¡†æ¶"><!---->æ•°æ®åº“ä¸ORMæ¡†æ¶<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><!----><span class="vp-sidebar-title">å¸¸ç”¨æ•°æ®åº“</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/sql.html" aria-label="MySQLæ•°æ®åº“"><!---->MySQLæ•°æ®åº“<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/Architecture.html" aria-label="MySQLä½“ç³»æ¶æ„"><!---->MySQLä½“ç³»æ¶æ„<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/java/database/db/Transaction.html" aria-label="äº‹åŠ¡ä¸é”æœºåˆ¶"><!---->äº‹åŠ¡ä¸é”æœºåˆ¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/mysql-index.html" aria-label="ç´¢å¼•åŠä¼˜åŒ–"><!---->ç´¢å¼•åŠä¼˜åŒ–<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/redis.html" aria-label="Redisæ•°æ®ç¼“å­˜"><!---->Redisæ•°æ®ç¼“å­˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/redis-java.html" aria-label="Javaæ“ä½œRedis"><!---->Javaæ“ä½œRedis<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">ORMæ¡†æ¶</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/Hibernate.html" aria-label="Hibernate"><!---->Hibernate<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/mybatis.html" aria-label="Mybatis"><!---->Mybatis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/tk-mybatis.html" aria-label="tk-mybatis"><!---->tk-mybatis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/generator.html" aria-label="ä»£ç ç”Ÿæˆ"><!---->ä»£ç ç”Ÿæˆ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/mybatis-resource.html" aria-label="mybatisæºç å‰–æ"><!---->mybatisæºç å‰–æ<!----></a></li></ul></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->äº‹åŠ¡ä¸é”æœºåˆ¶</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.ventix.top" target="_blank" rel="noopener noreferrer">ventixy</a></span><span property="author" content="ventixy"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2025-01-19T15:33:28.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 27 min</span><meta property="timeRequired" content="PT27M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysql-transaction">MySQL Transaction</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹åŠ¡çš„acidç‰¹æ€§">äº‹åŠ¡çš„ACIDç‰¹æ€§</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹åŠ¡çš„å¹¶å‘é—®é¢˜">äº‹åŠ¡çš„å¹¶å‘é—®é¢˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#äº‹åŠ¡çš„éš”ç¦»çº§åˆ«">äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mvccæœºåˆ¶è¯¦è§£">MVCCæœºåˆ¶è¯¦è§£</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•°æ®è¡Œéšè—å­—æ®µ">æ•°æ®è¡Œéšè—å­—æ®µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#undologä¸ç‰ˆæœ¬é“¾">UndoLogä¸ç‰ˆæœ¬é“¾</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#read-view">Read View</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¯è§æ€§è§„åˆ™">å¯è§æ€§è§„åˆ™</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¤ºä¾‹">ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¿«ç…§è¯»ä¸å½“å‰è¯»">å¿«ç…§è¯»ä¸å½“å‰è¯»</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysqlé”çš„åˆ†ç±»">MySQLé”çš„åˆ†ç±»</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å…±äº«æ’ä»–é”">å…±äº«æ’ä»–é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å‘é”">æ„å‘é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è®°å½•é”å’Œç´¢å¼•">è®°å½•é”å’Œç´¢å¼•</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é—´éš™é”">é—´éš™é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸´é”®é”">ä¸´é”®é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ’å…¥æ„å‘é”">æ’å…¥æ„å‘é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªå¢é”å’Œè°“è¯é”">è‡ªå¢é”å’Œè°“è¯é”</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­»é”åˆ†æ">æ­»é”åˆ†æ</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å¹»è¯»é—®é¢˜å›é¡¾ä¸æ€»ç»“">å¹»è¯»é—®é¢˜å›é¡¾ä¸æ€»ç»“</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="mysql-transaction" tabindex="-1"><a class="header-anchor" href="#mysql-transaction"><span>MySQL Transaction</span></a></h2><p><strong>äº‹åŠ¡ï¼ˆTransactionï¼‰</strong>ï¼šæ˜¯ç”±ä¸€ç³»åˆ—å¯¹æ•°æ®åº“ä¸­æ•°æ®è¿›â¾è®¿é—®ï¼ˆæŸ¥è¯¢ï¼‰ä¸æ›´æ–°ï¼ˆå¢åˆ æ”¹ï¼‰çš„æ“ä½œæ‰€ç»„æˆçš„â¼€ä¸ªç¨‹åºæ‰§è¡Œé€»è¾‘å•å…ƒã€‚è¿™äº›æ“ä½œï¼Œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½ä¸æˆåŠŸã€‚</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ç›¸å…³å‘½ä»¤ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">begin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å¼€å§‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‹åˆ—è¯­æ³•ï¼š</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">start transaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">commit</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;               </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æäº¤ï¼šä½¿å¾—å½“å‰çš„ä¿®æ”¹ç¡®è®¤</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">rollback</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;             </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å›æ»šï¼šä½¿å¾—å½“å‰çš„ä¿®æ”¹è¢«æ”¾å¼ƒ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="äº‹åŠ¡çš„acidç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡çš„acidç‰¹æ€§"><span>äº‹åŠ¡çš„ACIDç‰¹æ€§</span></a></h3><p>äº‹åŠ¡å…·æœ‰å››ä¸ªé‡è¦ç‰¹å¾ï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œéš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼ŒæŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚ç®€ç§°<strong>ACIDç‰¹æ€§</strong></p><div class="hint-container info"><p class="hint-container-title">äº‹åŠ¡çš„ACIDç‰¹æ€§</p><h4 id="åŸå­æ€§-atomicity" tabindex="-1"><a class="header-anchor" href="#åŸå­æ€§-atomicity"><span>åŸå­æ€§ï¼ˆAtomicityï¼‰</span></a></h4><p>äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ‰§è¡Œã€‚äº‹åŠ¡æ‰§â¾è¿‡ç¨‹ä¸­å¦‚æœå‡ºé”™ï¼Œ ä¼šå›æ»šåˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œæ‰€æœ‰çš„æ“ä½œå°±åƒæ²¡æœ‰å‘â½£ä¸€æ ·ã€‚</p><ul><li>ä½œç”¨ï¼šä¿è¯äº‹åŠ¡çš„å®Œæ•´æ€§ï¼Œé˜²æ­¢éƒ¨åˆ†æ“ä½œæˆåŠŸè€Œéƒ¨åˆ†æ“ä½œå¤±è´¥å¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´ã€‚</li><li>å®ç°æ–¹å¼: é€šè¿‡<code>Undo Log</code> æ”¯æŒäº‹åŠ¡çš„å›æ»š</li></ul><h4 id="ä¸€è‡´æ€§-consistency" tabindex="-1"><a class="header-anchor" href="#ä¸€è‡´æ€§-consistency"><span>â¼€è‡´æ€§ï¼ˆConsistencyï¼‰</span></a></h4><p>ä¸€ä¸ªäº‹åŠ¡åœ¨æ‰§â¾ä¹‹å‰å’Œæ‰§è¡Œä¹‹åï¼Œæ•°æ®åº“éƒ½å¿…é¡»å¤„äºâ¼€è‡´æ€§çŠ¶æ€ã€‚å³äº‹åŠ¡å¿…é¡»æ˜¯æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚<br><em>æ¯”å¦‚ï¼šå¦‚æœä»Aè´¦æˆ·è½¬è´¦åˆ°Bè´¦æˆ·ï¼Œä¸å¯èƒ½å› ä¸ºAè´¦æˆ·æ‰£äº†é’±ï¼Œâ½½Bè´¦æˆ·æ²¡æœ‰åŠ é’±ï¼ˆä¸¤ä¸ªè´¦å·çš„æ€»é‡‘é¢è¦ä¿æŒä¸€è‡´çŠ¶æ€ï¼‰</em></p><ul><li>ä½œç”¨ï¼šç¡®ä¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´çŠ¶æ€ï¼Œå³ä½¿äº‹åŠ¡å¤±è´¥ä¹Ÿä¸ä¼šç ´åæ•°æ®åº“çš„ä¸€è‡´æ€§ã€‚</li><li>å®ç°æ–¹å¼ï¼šæ—¥å¿—å’Œçº¦æŸæœºåˆ¶ï¼Œäº‹åŠ¡çš„è‡ªåŠ¨å›æ»š (æˆ–è€…è¯´ç”±A,I,Då…±åŒä¿è¯)</li></ul><h4 id="éš”ç¦»æ€§-isolation" tabindex="-1"><a class="header-anchor" href="#éš”ç¦»æ€§-isolation"><span>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</span></a></h4><p><mark>äº‹åŠ¡çš„æ‰§è¡Œæ˜¯ç‹¬ç«‹çš„ï¼Œä¸å—å…¶ä»–äº‹åŠ¡çš„å¹²æ‰°</mark>ã€‚ä¸€ä¸ªäº‹åŠ¡çš„ä¸­é—´çŠ¶æ€å¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</p><p>åœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼Œå¹¶å‘çš„äº‹åŠ¡æ˜¯äº’ç›¸éš”ç¦»çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„äº‹åŠ¡å¹¶å‘æ“ä½œç›¸åŒçš„æ•°æ®æ—¶ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰å„è‡ªå®Œæ•´çš„æ•°æ®ç©ºé—´ã€‚ â¼€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å…¶å®ƒå¹¶å‘äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡æ˜¯ä¸èƒ½äº’ç›¸å¹²æ‰°çš„ã€‚</p><ul><li>ä½œç”¨ï¼šé˜²æ­¢å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶äº§ç”Ÿçš„ç›¸äº’å¹²æ‰°ï¼Œç¡®ä¿äº‹åŠ¡çš„æ‰§è¡Œç»“æœæ˜¯æ­£ç¡®çš„ã€‚</li><li>å®ç°æ–¹å¼ï¼šä¸åŒçš„éš”ç¦»çº§åˆ«ï¼ŒMVCC</li></ul><p>åœ¨äº‹åŠ¡ä¸­ï¼Œæœ‰éš”ç¦»çº§åˆ«çš„å®šä¹‰ï¼Œä¸åŒçš„éš”ç¦»çº§åˆ«æœ‰ä¸åŒçš„å½±å“çš„ç¨‹åº¦ã€‚</p><h4 id="æŒä¹…æ€§-durability" tabindex="-1"><a class="header-anchor" href="#æŒä¹…æ€§-durability"><span>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</span></a></h4><p>ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œå…¶å¯¹æ•°æ®åº“çš„æ”¹å˜æ˜¯æ°¸ä¹…çš„ï¼Œå³ä½¿ç³»ç»Ÿå‘ç”Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><ul><li>ä½œç”¨ï¼šç¡®ä¿äº‹åŠ¡çš„ç»“æœèƒ½å¤ŸæŒä¹…ä¿å­˜ï¼Œä¸ä¼šå› ä¸ºç³»ç»Ÿå´©æºƒæˆ–å…¶ä»–é—®é¢˜è€Œä¸¢å¤±ã€‚</li><li>å®ç°æ–¹å¼ï¼š<strong>Redo Log &amp; <a href="https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_doublewrite_buffer" target="_blank" rel="noopener noreferrer">doublewrite buffer</a></strong></li></ul></div><h3 id="äº‹åŠ¡çš„å¹¶å‘é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡çš„å¹¶å‘é—®é¢˜"><span>äº‹åŠ¡çš„å¹¶å‘é—®é¢˜</span></a></h3><p>åœ¨ä¸åŒçš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶å¯èƒ½ä¼šäº§ç”Ÿä¸€äº›é—®é¢˜ï¼Œå¦‚ï¼šè„è¯»ï¼Œä¸å¯é‡å¤è¯»ï¼Œå¹»è¯»</p><div class="hint-container caution"><p class="hint-container-title">äº‹åŠ¡çš„å¹¶å‘é—®é¢˜</p><h4 id="è„è¯»-dirty-read" tabindex="-1"><a class="header-anchor" href="#è„è¯»-dirty-read"><span>è„è¯»ï¼ˆDirty Readï¼‰</span></a></h4><ul><li><p><strong>ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦å¤–ä¸€ä¸ªäº‹åŠ¡è¿˜æ²¡æäº¤çš„æ•°æ®</strong>ã€‚ä¾‹ï¼šäº‹åŠ¡Aè¯»å–äº†äº‹åŠ¡Bæ›´æ–°ä½†æœªæäº¤çš„æ•°æ®ï¼ˆè„æ•°æ®ï¼‰ <em>è„æ•°æ®</em>ï¼šæ˜¯æŒ‡äº‹åŠ¡å¯¹ç¼“å†²æ± ä¸­è¡Œè®°å½•çš„ä¿®æ”¹ï¼Œè¿˜æ²¡æœ‰è¢«æäº¤ï¼ˆcommitï¼‰</p></li><li><p>è„è¯»å‘ç”Ÿçš„æ¡ä»¶æ˜¯éœ€è¦äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ä¸º <code>READ UNCOMMITTED</code></p></li></ul><h4 id="ä¸å¯é‡å¤è¯»-nonrepeatable-read" tabindex="-1"><a class="header-anchor" href="#ä¸å¯é‡å¤è¯»-nonrepeatable-read"><span>ä¸å¯é‡å¤è¯»ï¼ˆNonrepeatable Readï¼‰</span></a></h4><ul><li><p><strong>ä¸€ä¸ªäº‹åŠ¡åœ¨ä¸¤æ¬¡è¯»å–åŒä¸€æ•°æ®æ—¶ï¼Œç”±äºå¦ä¸€ä¸ªäº‹åŠ¡åœ¨è¿™ä¸¤æ¬¡è¯»å–ä¹‹é—´ä¿®æ”¹äº†æ•°æ®ï¼Œå¯¼è‡´ä¸¤æ¬¡è¯»å–çš„ç»“æœä¸åŒ</strong>ã€‚</p></li><li><p><em>ä¸å¯é‡å¤è¯»å’Œè„è¯»çš„åŒºåˆ«</em> æ˜¯ï¼šè„è¯»æ˜¯è¯»åˆ°æœªæäº¤çš„æ•°æ®ï¼Œè€Œä¸å¯é‡å¤è¯»è¯»åˆ°çš„å´æ˜¯å·²ç»æäº¤çš„æ•°æ®</p></li></ul><p>æœ‰æ—¶å€™ï¼Œä¸å¯é‡å¤è¯»çš„é—®é¢˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºå…¶è¯»åˆ°çš„æ˜¯å·²ç»æäº¤çš„æ•°æ®ï¼Œæœ¬èº«å¹¶ä¸ä¼šå¸¦æ¥å¾ˆå¤§çš„é—®é¢˜</p><h4 id="å¹»è¯»-phantom-read" tabindex="-1"><a class="header-anchor" href="#å¹»è¯»-phantom-read"><span>å¹»è¯»ï¼ˆPhantom Readï¼‰</span></a></h4><p><strong>åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œè¯»å–æ•°æ®è®°å½•æ¡æ•°å‰åä¸ä¸€è‡´</strong>ã€‚è¯¦ç»†æ¥è¯´ï¼šä¸€ä¸ªäº‹åŠ¡åœ¨ä¸¤æ¬¡æŸ¥è¯¢ç›¸åŒèŒƒå›´çš„æ•°æ®æ—¶ï¼Œç”±äºå¦ä¸€ä¸ªäº‹åŠ¡åœ¨è¿™ä¸¤æ¬¡æŸ¥è¯¢ä¹‹é—´æ’å…¥äº†æ–°çš„æ•°æ®ï¼Œå¯¼è‡´ç¬¬äºŒæ¬¡æŸ¥è¯¢çš„ç»“æœé›†åŒ…å«äº†ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ²¡æœ‰çš„æ•°æ®ã€‚</p><blockquote><p>ä¾‹å¦‚ï¼š</p><ol><li>äº‹åŠ¡ A ï¼š <code>select * from student where age &gt; 10</code>ï¼Œå‡è®¾æŸ¥åˆ°äº† 10 è¡Œæ•°æ®ï¼›</li><li>ç„¶åäº‹åŠ¡ B å¾€é‡Œé¢åŠ å…¥äº†ä¸€æ‰¹æ•°æ® ï¼ˆæˆ–è€…åˆ é™¤äº†ä¸€äº›æ•°æ®ï¼‰</li><li>äº‹åŠ¡ A å†æŸ¥çš„ç”¨æ¡ä»¶æŸ¥è¯¢è¯­å¥æŸ¥è¯¢çš„æ—¶å€™ï¼Œå‘ç°æŸ¥åˆ°äº†15æ¡</li></ol></blockquote></div><p><strong>è„å†™æˆ–æ›´æ–°ä¸¢å¤±(Lost Update)</strong> ï¼š å½“ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡æ›´æ–°åŒä¸€è¡Œè®°å½•ï¼Œä¼šäº§ç”Ÿæ›´æ–°ä¸¢å¤±ç°è±¡:</p><ul><li>å›æ»šè¦†ç›–ï¼šä¸€ä¸ªäº‹åŠ¡å›æ»šæ“ä½œï¼ŒæŠŠå…¶ä»–äº‹åŠ¡å·²æäº¤çš„æ•°æ®ç»™è¦†ç›–äº†ã€‚</li><li>æäº¤è¦†ç›–ï¼šä¸€ä¸ªäº‹åŠ¡æäº¤æ“ä½œï¼ŒæŠŠå…¶ä»–äº‹åŠ¡å·²æäº¤çš„æ•°æ®ç»™è¦†ç›–äº†ã€‚</li></ul><h3 id="äº‹åŠ¡çš„éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡çš„éš”ç¦»çº§åˆ«"><span>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</span></a></h3><p>ä¸ºäº†å¤„ç†å¹¶å‘é—®é¢˜ï¼ŒSQLæ ‡å‡†å®šä¹‰äº†å››ç§éš”ç¦»çº§åˆ«ï¼Œæ¯ç§çº§åˆ«æä¾›äº†ä¸åŒç¨‹åº¦çš„éš”ç¦»æ€§ï¼š</p><div class="hint-container info"><p class="hint-container-title">äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</p><h4 id="â‘-read-uncommitted-è¯»æœªæäº¤" tabindex="-1"><a class="header-anchor" href="#â‘-read-uncommitted-è¯»æœªæäº¤"><span>â‘ Read Uncommittedï¼ˆè¯»æœªæäº¤ï¼‰</span></a></h4><p>æœ€ä½/æœ€ä¸å®‰å…¨çš„éš”ç¦»çº§åˆ«(å”¯ä¸€èƒ½è¯»åˆ°è„æ•°æ®çš„éš”ç¦»çº§åˆ«) æœ‰è„è¯»ã€ä¸å¯é‡å¤è¯»ã€è™šå¹»è¯»çš„é—®é¢˜</p><h4 id="â‘-read-committed-è¯»å·²æäº¤" tabindex="-1"><a class="header-anchor" href="#â‘-read-committed-è¯»å·²æäº¤"><span>â‘ Read Committedï¼ˆè¯»å·²æäº¤ï¼‰</span></a></h4><p>åªèƒ½è¯»å–å·²ç»æäº¤çš„æ•°æ®ã€è§£å†³äº†è„è¯»é—®é¢˜ï¼Œä½†æ˜¯ä»å­˜åœ¨å¯é‡å¤è¯»é—®é¢˜å’Œå¹»è¯»</p><h4 id="â‘-repeatable-read-å¯é‡å¤è¯»" tabindex="-1"><a class="header-anchor" href="#â‘-repeatable-read-å¯é‡å¤è¯»"><span>â‘ Repeatable Readï¼ˆå¯é‡å¤è¯»ï¼‰</span></a></h4><p>æ ‡å‡†SQLçš„å®šä¹‰ä¸‹ä»å¯èƒ½å­˜åœ¨å¹»è¯»é—®é¢˜ï¼Œä½†MySQLä¸‹æ²¡æœ‰å¹»è¯»é—®é¢˜</p><h4 id="â‘-serializable-é¡ºåºè¯»-å¯ä¸²è¡ŒåŒ–-åºåˆ—åŒ–" tabindex="-1"><a class="header-anchor" href="#â‘-serializable-é¡ºåºè¯»-å¯ä¸²è¡ŒåŒ–-åºåˆ—åŒ–"><span>â‘ Serializableï¼ˆé¡ºåºè¯» / å¯ä¸²è¡ŒåŒ– / åºåˆ—åŒ–ï¼‰</span></a></h4><p>æœ€ä¸¥æ ¼çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ã€äº‹åŠ¡åªèƒ½ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å¤„ç†ï¼Œä¸èƒ½å¹¶å‘(æœ‰æ•ˆç‡é—®é¢˜)</p></div><p>ä¸åŒäº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹çš„ä¸åŒçš„é—®é¢˜æ€»ç»“ï¼š</p><table><thead><tr><th>äº‹åŠ¡éš”ç¦»çº§åˆ« \ å¹¶å‘é—®é¢˜</th><th style="text-align:center;">è„è¯»(Dirty Read)</th><th style="text-align:center;">ä¸å¯é‡å¤è¯»</th><th style="text-align:center;">ï¼ˆè™šï¼‰å¹»è¯»</th></tr></thead><tbody><tr><td>read uncommittedï¼ˆè¯»æœªæäº¤ï¼‰</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td></tr><tr><td>read committedï¼ˆè¯»å·²æäº¤ï¼‰</td><td style="text-align:center;">X</td><td style="text-align:center;">âˆš</td><td style="text-align:center;">âˆš</td></tr><tr><td>repeatable readï¼ˆå¯é‡å¤è¯»ï¼‰</td><td style="text-align:center;">X</td><td style="text-align:center;">X</td><td style="text-align:center;">X(åœ¨MySQLä¸‹æ²¡æœ‰)</td></tr><tr><td>serializableï¼ˆåºåˆ—åŒ–ï¼‰</td><td style="text-align:center;">X</td><td style="text-align:center;">X</td><td style="text-align:center;">X</td></tr></tbody></table><p>MySQLä¸­InnoDBå­˜å‚¨å¼•æ“é»˜è®¤æ”¯æŒçš„éš”ç¦»çº§åˆ«æ˜¯ <code>REPEATABLE READ</code>ï¼Œä½†æ˜¯ä¸æ ‡å‡†SQLä¸åŒçš„æ˜¯ï¼ŒInnoDBå­˜å‚¨å¼•æ“åœ¨<code>REPEATABLE READ</code>äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ï¼Œé€šè¿‡<strong>Next-Key Lock</strong> æœ‰æ•ˆåœ°é˜²æ­¢äº†å¹»è¯»é—®é¢˜</p><div class="hint-container tip"><p class="hint-container-title">å…³äºMySQLé»˜è®¤éš”ç¦»çº§åˆ«çš„ä»‹ç»</p><ul><li><p><code>InnoDB</code> offers all four transaction isolation levels described by the SQL:1992 standard:<br><a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html#isolevel_read-uncommitted" target="_blank" rel="noopener noreferrer"><code>READ UNCOMMITTED</code></a>, <a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html#isolevel_read-committed" target="_blank" rel="noopener noreferrer"><code>READ COMMITTED</code></a>, <a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html#isolevel_repeatable-read" target="_blank" rel="noopener noreferrer"><code>REPEATABLE READ</code></a>, and <a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html#isolevel_serializable" target="_blank" rel="noopener noreferrer"><code>SERIALIZABLE</code></a>.</p></li><li><p>The default isolation level for <code>InnoDB</code> is <a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html#isolevel_repeatable-read" target="_blank" rel="noopener noreferrer"><code>REPEATABLE READ</code></a>.</p></li></ul></div><h2 id="mvccæœºåˆ¶è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#mvccæœºåˆ¶è¯¦è§£"><span>MVCCæœºåˆ¶è¯¦è§£</span></a></h2><p>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMulti-Version Concurrency Controlï¼Œç®€ç§° MVCCï¼Œ<code>Copy on Write</code>çš„æ€æƒ³ï¼‰é€šè¿‡ç»´æŠ¤æ•°æ®çš„ä¸åŒç‰ˆæœ¬æ¥å®ç°<strong>å¯¹åŒä¸€æ•°æ®çš„æ— é”å¹¶å‘è®¿é—®</strong>ï¼Œå¤§å¤§æé«˜äº†æ•°æ®åº“çš„ååé‡åŠè¯»å†™æ€§èƒ½ã€‚</p><p>MVCCæœ€å¤§çš„å¥½å¤„æ˜¯è¯»ä¸åŠ é”ï¼Œè¯»å†™ä¸å†²çªã€‚åœ¨è¯»å¤šå†™å°‘çš„ç³»ç»Ÿåº”ç”¨ä¸­ï¼Œè¯»å†™ä¸å†²çªæ˜¯éå¸¸é‡è¦çš„ï¼Œæå¤§çš„æå‡ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç°é˜¶æ®µå‡ ä¹æ‰€æœ‰çš„å…³ç³»å‹æ•°æ®åº“éƒ½æ”¯æŒ MVCC çš„åŸå› ï¼ŒMVCCæ˜¯ <code>Read Commited</code> å’Œ <code>Repeatable Read</code> ä¸¤ç§éš”ç¦»çº§çš„å®ç°åŸºç¡€ã€‚</p><div class="hint-container important"><p class="hint-container-title">MVCCæ ¸å¿ƒåŸºç¡€</p><ul><li>æ•°æ®è¡Œçš„éšè—å­—æ®µï¼šåŒ…å«ç”¨äº<code>æŒ‡å‘å†å²ç‰ˆæœ¬çš„æŒ‡é’ˆ</code>ï¼Œæ¯è¡Œæ•°æ®å¯å‡­æ­¤æ‰¾åˆ°å®ƒçš„å†å²ç‰ˆæœ¬</li><li>undo logï¼šå­˜å‚¨æ•°æ®è¡Œçš„å¤šä¸ªç‰ˆæœ¬ä¿¡æ¯</li><li>read viewï¼šæä¾›äº†æ•°æ®ç‰ˆæœ¬ç¡®å®šçš„ä¾æ®ï¼Œç”¨äºç¡®å®šåº”è¯¥è·å–å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®</li></ul></div><p>MySQLå®˜ç½‘å…³äºMVCCçš„ä»‹ç»å‚ç…§ï¼š<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-multi-versioning.html" target="_blank" rel="noopener noreferrer">innodb-multi-versioning</a>, <a href="https://dev.mysql.com/doc/refman/8.0/en/innodb-consistent-read.html" target="_blank" rel="noopener noreferrer">Consistent Nonlocking Reads</a></p><h3 id="æ•°æ®è¡Œéšè—å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#æ•°æ®è¡Œéšè—å­—æ®µ"><span>æ•°æ®è¡Œéšè—å­—æ®µ</span></a></h3><p>InnoDB å­˜å‚¨å¼•æ“åœ¨æ¯ä¸ªæ•°æ®è¡Œä¸­æ·»åŠ äº†å‡ ä¸ªéšè—å­—æ®µï¼Œç”¨äºæ”¯æŒ MVCCï¼š</p><ul><li><p><strong>DB_TRX_ID</strong>ï¼šè®°å½•æœ€è¿‘ä¸€æ¬¡å¯¹æœ¬è®°å½•è¿›è¡Œæ’å…¥æˆ–ä¿®æ”¹çš„äº‹åŠ¡IDã€‚ï¼ˆå å…­ä¸ªå­—èŠ‚ï¼‰<br> åˆ é™¤æ“ä½œä¹Ÿä¼šè¢«è§†ä¸ºä¸€ä¸ªupdateæ“ä½œï¼Œåªæ˜¯æœ‰é¢å¤–çš„åˆ é™¤æ ‡è®°ï¼ˆDelete Bitï¼‰</p></li><li><p><strong>DB_ROLL_PTR</strong>ï¼šæŒ‡å‘è¯¥è¡Œçš„å›æ»šæ®µï¼ˆundo logï¼‰çš„æŒ‡é’ˆï¼Œç”¨äºæ‰¾åˆ°è¯¥è¡Œçš„æ—§ç‰ˆæœ¬ã€‚(å ç”¨ä¸ƒä¸ªå­—èŠ‚)</p></li><li><p><strong>DB_ROW_ID</strong>ï¼šéšç€æ–°è¡Œæ’å…¥è€Œå•è°ƒé€’å¢çš„è¡ŒIDï¼Œæ•°æ®è¡Œæ²¡æœ‰ä¸»é”®æ—¶ï¼Œä¸ºè¡Œæä¾›ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†<br> DB_ROW_IDå ç”¨å…­ä¸ªå­—èŠ‚, è‹¥æ— èšç°‡ç´¢å¼•åˆ™ä½œä¸ºèšç°‡ç´¢å¼•ä½¿ç”¨ã€‚</p></li></ul><figure><img src="https://image.ventix.top/img02/20220119212913677.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="undologä¸ç‰ˆæœ¬é“¾" tabindex="-1"><a class="header-anchor" href="#undologä¸ç‰ˆæœ¬é“¾"><span>UndoLogä¸ç‰ˆæœ¬é“¾</span></a></h3><p>äº‹åŠ¡åœ¨å¯¹æ•°æ®æ“ä½œå‰ï¼Œundologä¼šè®°å½•<mark>å¯ä»¥é€šè¿‡äº‹åŠ¡å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬æ•°æ®</mark>çš„ä¿¡æ¯</p><ul><li><code>insert undo log</code>: äº‹åŠ¡insertæ–°è®°å½•æ—¶äº§ç”Ÿçš„undolog, åªåœ¨äº‹åŠ¡å›æ»šæ—¶éœ€è¦ï¼Œå¹¶ä¸”åœ¨äº‹åŠ¡æäº¤åå°±å¯ä»¥ç«‹å³ä¸¢å¼ƒ</li><li><code>update undo log</code>: äº‹åŠ¡è¿›è¡Œdeleteå’Œupdateæ“ä½œæ—¶äº§ç”Ÿçš„undo log<br> ä¸ä»…äº‹åŠ¡å›æ»šéœ€è¦ï¼Œå¿«ç…§è¯»ä¹Ÿéœ€è¦ï¼Œåªæœ‰å½“æ•°æ®åº“æ‰€ä½¿ç”¨çš„å¿«ç…§ä¸­ä¸æ¶‰åŠ å¯¹åº”çš„undo logæ‰ä¼šè¢«<code>purge</code>çº¿ç¨‹åˆ é™¤</li></ul><div class="hint-container warning"><p class="hint-container-title">ç‰ˆæœ¬é“¾</p><p>æ¯æ¬¡æ›´æ–°æ“ä½œï¼Œæ—§å€¼ä¼šè¢«ä¿å­˜åˆ°ä¸€æ¡undoæ—¥å¿—ä¸­ï¼Œéšç€æ›´æ–°æ¬¡æ•°çš„å¢åŠ ï¼Œæ‰€æœ‰çš„ç‰ˆæœ¬éƒ½ä¼šé€šè¿‡<code>DB_ROLL_PTR</code>è¿æ¥æˆä¸€ä¸ªé“¾è¡¨ï¼Œç§°ä¹‹ä¸º<strong>ç‰ˆæœ¬é“¾</strong>ã€‚</p></div><h3 id="read-view" tabindex="-1"><a class="header-anchor" href="#read-view"><span>Read View</span></a></h3><p>readviewè§†å›¾å­˜åœ¨å¦‚ä¸‹4ä¸ªå­—æ®µ</p><ul><li><code>m_ids</code>ï¼šm_idsä¸­ç»´æŠ¤äº†ä¸€ä¸ªæœ‰åºæ•°ç»„ï¼ˆå‡åºï¼‰ï¼Œè¯¥æ•°ç»„ä¿å­˜äº†ReadViewç”Ÿæˆæ—¶ï¼Œæ´»è·ƒçš„äº‹åŠ¡id</li><li><code>m_low_limit_idï¼ˆmax_trx_idï¼‰</code>ï¼šé¢„åˆ†é…äº‹åŠ¡idï¼Œç­‰äºå½“å‰æœ€å¤§äº‹åŠ¡id + 1ï¼ˆäº‹åŠ¡æ˜¯è‡ªå¢çš„ï¼‰</li><li><code>m_up_limit_idï¼ˆmin_trx_idï¼‰</code>ï¼šæœ€å°æ´»è·ƒäº‹åŠ¡id</li><li><code>m_creator_trx_id</code>ï¼šReadViewåˆ›å»ºè€…çš„id</li></ul><div class="hint-container important"><p class="hint-container-title">Read View ä¸äº‹åŠ¡éš”ç¦»çº§åˆ«</p><p>ä¸åŒçš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¼šå½±å“ Read View çš„è¡Œä¸ºï¼š</p><ul><li><p><strong>READ COMMITTED</strong>ï¼šæ¯æ¬¡SELECTéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„<code>ReadView</code>ï¼Œèƒ½çœ‹åˆ°å·²æäº¤çš„æ•°æ®ç‰ˆæœ¬</p></li><li><p><strong>REPEATABLE READ</strong>ï¼ˆé»˜è®¤ï¼‰ï¼šåœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´ä¿æŒåŒä¸€ä¸ª<code>ReadView</code>ï¼Œå¤šæ¬¡æŸ¥è¯¢ç»“æœä¸€è‡´</p></li></ul></div><p><code>è¯»å·²æäº¤</code>ï¼ˆRead Committedï¼ŒRCï¼‰å’Œ<code>å¯é‡å¤è¯»</code>ï¼ˆRepeatable Readï¼ŒRRï¼‰çš„æœ¬è´¨åŒºåˆ«ï¼š</p><ul><li><strong>è¯»å·²æäº¤ï¼ˆRCï¼‰</strong>ï¼š<mark>æ¯æ¬¡æŸ¥è¯¢åˆ›å»ºæ–°çš„è¯»è§†å›¾</mark>ï¼Œäº‹åŠ¡å†…çš„å¤šæ¬¡æŸ¥è¯¢å¯èƒ½ä¼šçœ‹åˆ°ä¸åŒçš„æ•°æ®ç‰ˆæœ¬ã€‚</li><li><strong>å¯é‡å¤è¯»ï¼ˆRRï¼‰</strong>ï¼šäº‹åŠ¡å¼€å§‹æ—¶åˆ›å»ºè¯»è§†å›¾ï¼Œäº‹åŠ¡å†…çš„å¤šæ¬¡æŸ¥è¯¢ä¼šçœ‹åˆ°ç›¸åŒçš„å¿«ç…§ã€‚</li></ul><p>å› æ­¤åœ¨MVCCæœºåˆ¶ä¸­ï¼Œåœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹åŒä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢ä½¿ç”¨çš„å‡æ˜¯åŒä¸€ä¸ªè§†å›¾ï¼Œè§£å†³äº†ä¸å¯é‡è¯»çš„é—®é¢˜å’Œéƒ¨åˆ†å¹»è¯»é—®é¢˜ã€‚</p><p>å‚ç…§Blogï¼š<a href="https://blog.csdn.net/qq_62835094/article/details/136669636" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/qq_62835094/article/details/136669636</a></p><h3 id="å¯è§æ€§è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#å¯è§æ€§è§„åˆ™"><span>å¯è§æ€§è§„åˆ™</span></a></h3><p>MVCCæœºåˆ¶é€šè¿‡ä¸‹é¢çš„ç®—æ³•ï¼Œåˆ†æç‰ˆæœ¬é“¾ä¸­è®¿é—®ç‰ˆæœ¬çš„ <code>DB_TRX_ID</code> å±æ€§å€¼ä¸<code>Read view</code>æ•°æ®ï¼Œç¡®å®šç‰ˆæœ¬çš„å¯è§æ€§(èƒ½å¦è¢«å½“å‰äº‹åŠ¡è®¿é—®)ï¼š</p><div class="hint-container info"><p class="hint-container-title">ç‰ˆæœ¬å¯è§æ€§åˆ†æç®—æ³•</p><ul><li><p>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ <code>DB_TRX_ID</code> å±æ€§å€¼ä¸ Read View ä¸­çš„ <code>m_creator_trx_id</code> å€¼ç›¸åŒï¼Œè¡¨ç¤ºå½“å‰äº‹åŠ¡æ­£åœ¨è®¿é—®è‡ªå·±æ‰€ä¿®æ”¹çš„è®°å½•ï¼Œå› æ­¤è¯¥ç‰ˆæœ¬<strong>å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®</strong>ã€‚</p></li><li><p>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ <code>DB_TRX_ID</code> å±æ€§å€¼å°äº Read View ä¸­çš„ <code>m_up_limit_id</code> å€¼ï¼Œè¯´æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”Ÿæˆ Read View ä¹‹å‰å·²ç»æäº¤ï¼Œå› æ­¤è¯¥ç‰ˆæœ¬<strong>å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®</strong>ã€‚</p></li><li><p>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ <code>DB_TRX_ID</code> å±æ€§å€¼å¤§äºæˆ–ç­‰äº Read View ä¸­çš„ <code>m_low_limit_id</code> å€¼ï¼Œè¯´æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”Ÿæˆ Read View ä¹‹åæ‰æäº¤ï¼Œå› æ­¤è¯¥ç‰ˆæœ¬<strong>ä¸èƒ½è¢«å½“å‰äº‹åŠ¡è®¿é—®</strong>ã€‚</p></li><li><p>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„ <code>DB_TRX_ID</code> å±æ€§å€¼ä½äº Read View çš„ <code>m_up_limit_id</code> å’Œ <code>m_low_limit_id</code> ä¹‹é—´ï¼ˆåŒ…æ‹¬è¾¹ç•Œï¼‰ï¼Œåˆ™éœ€è¦è¿›ä¸€æ­¥æ£€æŸ¥ <code>DB_TRX_ID</code> æ˜¯å¦åœ¨<code>m_ids</code> åˆ—è¡¨ä¸­ã€‚</p><ul><li>å¦‚æœåœ¨åˆ—è¡¨ä¸­ï¼ˆåˆ›å»ºReadViewæ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡ä»å¤„äºæ´»è·ƒçŠ¶æ€ï¼‰è¯¥ç‰ˆæœ¬<strong>ä¸èƒ½è¢«è®¿é—®</strong></li><li>å¦‚æœä¸åœ¨åˆ—è¡¨ä¸­ï¼ˆåˆ›å»º Read View æ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡å·²ç»æäº¤ï¼‰è¯¥ç‰ˆæœ¬<strong>å¯ä»¥è¢«è®¿é—®</strong></li></ul></li></ul></div><p>å¦‚æœç»è¿‡ä¸Šé¢çš„åˆ¤æ–­ç›®æ ‡ç‰ˆæœ¬ä¸èƒ½è¢«è®¿é—®ï¼Œåˆ™ç»§ç»­æ²¿ç€ç‰ˆæœ¬é“¾åˆ¤æ–­ä¸‹ä¸€æ¡ Undo Log</p><h3 id="ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç¤ºä¾‹"><span>ç¤ºä¾‹</span></a></h3><h3 id="å¿«ç…§è¯»ä¸å½“å‰è¯»" tabindex="-1"><a class="header-anchor" href="#å¿«ç…§è¯»ä¸å½“å‰è¯»"><span>å¿«ç…§è¯»ä¸å½“å‰è¯»</span></a></h3><p><strong>å¿«ç…§è¯»å¿«ç…§è¯»ï¼ˆSnapshot Readï¼‰</strong>ï¼š æŒ‡è¯»å–ä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶çš„æ•°æ®å¿«ç…§ï¼Œè€Œä¸æ˜¯æœ€æ–°çš„æ•°æ®ã€‚è¿™æ„å‘³ç€å®ƒä¸ä¼šçœ‹åˆ°å…¶ä»–äº‹åŠ¡åœ¨æ­¤äº‹åŠ¡å¯åŠ¨åæ‰€åšçš„ä»»ä½•æ›´æ”¹ï¼Œå³ä½¿è¿™äº›æ›´æ”¹å·²ç»è¢«æäº¤ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒSELECT æ˜¯éé”å®šçš„ä¸€è‡´æ€§è¯»ï¼ˆconsistent nonlocking readï¼‰ã€‚è¿™ç§ç±»å‹çš„è¯»å–èƒ½å¤Ÿæé«˜å¹¶å‘æ€§èƒ½ï¼Œå› ä¸ºå®ƒå…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è¯»å–è€Œä¸ä¼šç›¸äº’é˜»å¡ã€‚</p><ul><li><p><code>REPEATABLE-READ</code>çº§åˆ«: äº‹åŠ¡beginåï¼Œç¬¬ä¸€æ¡SELECTè¯­å¥ä¼šåˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼Œè¯»å–æ»¡è¶³å¯è§æ€§çš„æ•°æ®ï¼Œä¹‹åè¯¥äº‹åŠ¡ä¼šä¸€ç›´ç”¨è¿™ä¸ªå¿«ç…§ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸ</p></li><li><p><code>READ-COMMITTED</code>çº§åˆ«: äº‹åŠ¡beginåï¼Œæ¯æ¡SELECTè¯­å¥éƒ½ä¼šé‡ç½®å¿«ç…§(é‡æ–°åˆ›å»ºå¿«ç…§)ï¼Œ è¯»å–å½“å‰æ»¡è¶³å¯è§æ€§çš„æ•°æ®</p></li></ul><p><strong>å½“å‰è¯»ï¼ˆCurrent Readï¼‰</strong>ï¼šæ€»æ˜¯è¯»å–æœ€æ–°çš„ã€å·²ç»æäº¤çš„æ•°æ®ç‰ˆæœ¬ã€‚è¿™ä¸ä»…åŒ…æ‹¬äº†æœ¬äº‹åŠ¡æ‰€åšçš„æ›´æ”¹ï¼Œä¹ŸåŒ…æ‹¬æ‰€æœ‰å…¶ä»–å·²ç»æäº¤äº‹åŠ¡çš„ç»“æœã€‚</p><p>ä¸ºäº†ç¡®ä¿è¯»å–åˆ°æœ€æ–°æ•°æ®ï¼Œå½“å‰è¯»å¯èƒ½ä¼šåŠ é”ä»¥é˜²æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ‰€è¯»å–çš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚å› æ­¤ï¼Œå½“å‰è¯»é€šå¸¸æ˜¯é”å®šè¯»ï¼ˆlocking readï¼‰ï¼Œå³åœ¨è¯»å–çš„åŒæ—¶è¿˜ä¼šè·å–é€‚å½“çš„é”æ¥ä¿æŠ¤æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... LOCK </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">IN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SHARE MODE;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SHARE;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... ;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... ;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DELETE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... ;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MySQLä¸­å½“å‰è¯»ä¸€èˆ¬è¯´çš„å°±æ˜¯åŸºäºäº‹åŠ¡çš„<strong>ä¸€è‡´æ€§è¯»ï¼ˆConsistent Readï¼‰</strong> å’Œ <strong>é”å®šè¯»ï¼ˆLocking Readï¼‰</strong></p><p>å¿«ç…§è¯»æŸ¥çœ‹çš„æ˜¯äº‹åŠ¡å¼€å§‹æ—¶çš„æ•°æ®å¿«ç…§ï¼Œè€Œå½“å‰è¯»åˆ™æ€»æ˜¯è¯»å–æœ€æ–°çš„å·²æäº¤æ•°æ®ã€‚</p><h2 id="mysqlé”çš„åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#mysqlé”çš„åˆ†ç±»"><span>MySQLé”çš„åˆ†ç±»</span></a></h2><p>åœ¨ MySQL ä¸­ï¼Œé”æœºåˆ¶æ˜¯ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œå¹¶å‘æ§åˆ¶çš„é‡è¦æ‰‹æ®µã€‚æ ¹æ®ä¸åŒçš„è§’åº¦ï¼ŒMySQL ä¸­çš„é”å¯ä»¥åˆ†ä¸ºå¤šç§ç±»å‹ã€‚</p><p>InnoDB ä¸­çš„é”æœºåˆ¶æ˜¯ç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’Œå¹¶å‘æ§åˆ¶çš„å…³é”®éƒ¨åˆ†ã€‚æ ¹æ®ä¸åŒçš„å±‚æ¬¡å’Œç”¨é€”ï¼ŒInnoDB æä¾›äº†å¤šç§ç±»å‹çš„é”ã€‚<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html" target="_blank" rel="noopener noreferrer">InnoDB Locking</a></p><ul><li>å…±äº«æ’ä»–é”ï¼ˆShared and Exclusive Locksï¼‰ ç”¨äºæ§åˆ¶å¹¶å‘è®¿é—®ï¼Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚</li><li>æ„å‘é”ï¼ˆIntention Locksï¼‰ç”¨äºåè°ƒä¸åŒç²’åº¦çš„é”ï¼Œé¿å…æ­»é”å’Œé”å†²çªã€‚</li><li>è®°å½•é”ï¼ˆRecord Locksï¼‰é˜²æ­¢å¤šä¸ªäº‹åŠ¡åŒæ—¶ä¿®æ”¹åŒä¸€æ•°æ®é¡¹ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚</li><li>é—´éš™é”ï¼ˆGap Locksï¼‰ç”¨äºé˜²æ­¢å¹»è¯»ç°è±¡ï¼Œç‰¹åˆ«æ˜¯åœ¨èŒƒå›´æŸ¥è¯¢ä¸­ã€‚</li><li>ä¸´é”®é”ï¼ˆNext-Key Locksï¼‰é€šè¿‡é”å®šå…·ä½“çš„ç´¢å¼•è®°å½•åŠå…¶ä¹‹å‰çš„é—´éš™ï¼Œæœ‰æ•ˆé˜²æ­¢å¹»è¯»ç°è±¡ã€‚</li><li>æ’å…¥æ„å‘é”ï¼šç”¨äºä¼˜åŒ–å¹¶å‘æ’å…¥æ“ä½œï¼Œé˜²æ­¢å¤šä¸ªäº‹åŠ¡åœ¨åŒä¸€ä¸ªé—´éš™å†…æ’å…¥ç›¸åŒçš„è®°å½•ã€‚</li><li>è‡ªå¢é”ï¼šç¡®ä¿ <code>AUTO_INCREMENT</code> åˆ—ç”Ÿæˆå”¯ä¸€çš„å€¼ï¼Œé€šè¿‡é¢„åˆ†é…è‡ªå¢å€¼æé«˜å¹¶å‘æ€§èƒ½ã€‚</li><li>è°“è¯é”ï¼šæ”¯æŒç©ºé—´ç´¢å¼•ä¸­çš„å¤æ‚æŸ¥è¯¢ï¼Œç¡®ä¿å¯¹ç©ºé—´æ•°æ®çš„æ“ä½œå…·æœ‰ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚</li></ul><h3 id="å…±äº«æ’ä»–é”" tabindex="-1"><a class="header-anchor" href="#å…±äº«æ’ä»–é”"><span>å…±äº«æ’ä»–é”</span></a></h3><p>å…±äº«æ’ä»–é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-shared-exclusive-locks" target="_blank" rel="noopener noreferrer">Shared and Exclusive Locks</a>ï¼‰å±äº<strong>è¡Œçº§é”</strong>ï¼Œåˆ†ä¸ºå…±äº«é”å’Œæ’ä»–é”:</p><ul><li><p>å…±äº«é”(SLock)ï¼šå…è®¸æŒæœ‰è¯¥é”çš„äº‹åŠ¡è¯»å–ä¸€è¡Œæ•°æ®</p></li><li><p>æ’ä»–é”(XLock)ï¼šå…è®¸è¯¥é”çš„äº‹åŠ¡<strong>åˆ é™¤æˆ–æ›´æ–°</strong>ä¸€è¡Œæ•°æ®</p></li></ul><table><thead><tr><th>Shared and Exclusive Locks</th><th>æ’ä»–é”ï¼ˆX é”ï¼‰</th><th>å…±äº«é”ï¼ˆS é”ï¼‰</th></tr></thead><tbody><tr><td>æ’ä»–é”ï¼ˆXLockï¼‰</td><td>âŒ</td><td>âŒ</td></tr><tr><td>å…±äº«é”ï¼ˆSLockï¼‰</td><td>âŒ</td><td>âœ”</td></tr></tbody></table><ul><li><p>Innodbä¼šè‡ªåŠ¨ç»™ <code>delete</code>,<code>update</code> è¯­å¥æ¶‰åŠåˆ°çš„æ•°æ®é›†åŠ  æ’ä»–é”ï¼ˆXLockï¼‰</p></li><li><p>æ™®é€šçš„ <code>select</code> è¯­å¥ä¸ä¼šåŠ é”ï¼Œä½†å¯ä»¥ä½¿ç”¨ä¸‹åˆ—æ–¹å¼åŠ é”ï¼ˆå‚ç…§ï¼š<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locks-set.html" target="_blank" rel="noopener noreferrer">locks-set</a>ï¼‰ï¼š</p></li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... LOCK </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">IN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SHARE MODE;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> SHARE;             </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- MySQL8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>insert</code> è¯­å¥ä¹Ÿä¼šè‡ªåŠ¨åŠ é”ï¼Œä½†ä¸æ˜¯å…±äº«é”/æ’ä»–é”ã€‚</p><h3 id="æ„å‘é”" tabindex="-1"><a class="header-anchor" href="#æ„å‘é”"><span>æ„å‘é”</span></a></h3><p>æ„å‘é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-intention-locks" target="_blank" rel="noopener noreferrer">Intention Locks</a>ï¼‰è¡¨ç¤ºæœªæ¥æŸä¸ªæ—¶åˆ»ï¼Œäº‹åŠ¡è¦åŠ å…±äº«é”/æ’ä»–é”ï¼Œæ‰€ä»¥å…ˆæå‰å£°æ˜<mark>æ„å‘</mark></p><ul><li><p>æ„å‘å…±äº«é”ï¼ˆintention shared lock ï¼ŒISï¼‰è¡¨ç¤ºäº‹åŠ¡æœ‰æ„å‘è¡¨ä¸­çš„æŸäº›è¡ŒåŠ å…±äº«é”</p></li><li><p>æ„å‘æ’ä»–é”ï¼ˆintention exclusive lockï¼ŒIXï¼‰è¡¨ç¤ºäº‹åŠ¡æœ‰æ„å‘è¡¨ä¸­çš„æŸäº›è¡ŒåŠ æ’ä»–é”</p></li></ul><p>æ„å‘é”æ˜¯ä¸€ä¸ª<strong>è¡¨çº§é”</strong>ï¼Œ<mark>äº‹åŠ¡åœ¨è¯·æ±‚Sé”/Xé”å‰ï¼Œéœ€è¦å…ˆè·å¾—å¯¹åº”çš„ISï¼ŒIXé”</mark></p><div class="hint-container tip"><p class="hint-container-title">ä¸ºä»€ä¹ˆæœ‰äº†å…±äº«é”å’Œæ’ä»–é”ï¼Œè¿˜è¦å¼•å…¥æ„å‘é”ï¼Ÿ</p><p>åœ¨æ²¡æœ‰è¡¨çº§æ„å‘é”çš„æƒ…å½¢ä¸‹ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½å¯¹æŸä¸ªè¡¨åŠ è¡¨çº§é”éœ€è¦æ£€æŸ¥æ‰€æœ‰çš„è®°å½•çœ‹æ˜¯å¦æœ‰è¡Œçº§é”ï¼Œè´¹æ—¶è´¹åŠ›ï¼Œè€Œæœ‰äº†ä¹‹å‰åŠ çš„è¡¨çº§æ„å‘é”ï¼Œåœ¨è·å–è¡¨çº§é”æ—¶å¯ä»¥è¿…é€ŸçŸ¥é“è¯¥è¡¨ä¸­æœ‰é”æœªé‡Šæ”¾ï¼Œç›´æ¥ç­‰å¾…å³å¯</p><p>ä¾‹ï¼šäº‹åŠ¡Aéœ€è¦å¯¹è¡¨ä¸­çš„æŸä¸ªæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå…ˆè·å–äº†ä¸€ä¸ªè¡¨çº§çš„IXé”ï¼Œå†å»è·å–å¯¹åº”çš„è¡Œçº§é”ï¼ˆXlockï¼‰ï¼Œå¦‚æœäº‹åŠ¡Aæœªå®Œæˆçš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡Bç°åœ¨éœ€è¦åŠ è¡¨é”<code>LOCK TABLES ... WRITE</code>ï¼Œå°±å¯ä»¥é€šè¿‡ä¹‹å‰çš„äº‹åŠ¡AåŠ çš„è¡¨çº§æ„å‘ç‹¬å é”ï¼ˆIXï¼‰çŸ¥é“è¯¥ç­‰å¾…</p></div><p>MySQLå®˜æ–¹æ–‡æ¡£æœ‰æ˜ç¡®çš„æè¿°ï¼šIntention locks do not block <mark>anything except full table requests (for example, <code>LOCK TABLES ... WRITE</code>)</mark>. The main purpose of intention locks is <strong>to show that someone is locking a row, or going to lock a row in the table</strong>.</p><p>Table-level lock type compatibility ï¼ˆConflictï¼šâŒï¼ŒCompatibleï¼šâœ”ï¼‰ï¼š</p><table><thead><tr><th>è¡¨çº§é”å…¼å®¹æ€§åˆ¤æ–­</th><th>X(ç‹¬å é”/æ’ä»–é”)</th><th>IX(æ„å‘æ’ä»–é”)</th><th>S(å…±äº«é”)</th><th>IS(æ„å‘å…±äº«é”)</th></tr></thead><tbody><tr><td>X(ç‹¬å é”/æ’ä»–é”)</td><td>âŒ</td><td>âŒ</td><td>âŒ</td><td>âŒ</td></tr><tr><td>IX(æ„å‘æ’ä»–é”)</td><td>âŒ</td><td>âœ”</td><td>âŒ</td><td>âœ”</td></tr><tr><td>S(å…±äº«é”)</td><td>âŒ</td><td>âŒ</td><td>âœ”</td><td>âœ”</td></tr><tr><td>IS(æ„å‘å…±äº«é”)</td><td>âŒ</td><td>âœ”</td><td>âœ”</td><td>âœ”</td></tr></tbody></table><p>æ„å‘é”æœ€æ˜æ˜¾çš„ä½œç”¨åœ¨äº<mark>ç®€åŒ–é”å…¼å®¹æ€§æ£€æŸ¥</mark> ï¼Œé€šè¿‡ä½¿ç”¨æ„å‘é”ï¼Œæ•°æ®åº“å¼•æ“å¯ä»¥åœ¨æ›´é«˜å±‚æ¬¡ï¼ˆå¦‚è¡¨çº§åˆ«ï¼‰å¿«é€Ÿåˆ¤æ–­æ˜¯å¦å¯èƒ½å­˜åœ¨å†²çªï¼Œè€Œä¸éœ€è¦é€è¡Œæ£€æŸ¥æ¯ä¸ªé”çš„çŠ¶æ€ã€‚</p><h3 id="è®°å½•é”å’Œç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#è®°å½•é”å’Œç´¢å¼•"><span>è®°å½•é”å’Œç´¢å¼•</span></a></h3><p>è®°å½•é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-record-locks" target="_blank" rel="noopener noreferrer">Record Locks</a>ï¼‰<mark>é”å®šçš„æ˜¯ç´¢å¼•</mark> ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡é’ˆå¯¹åŒä¸€æ¡è®°å½•åŒæ—¶è¿›è¡Œ<strong>å¢åˆ æ”¹</strong>æ“ä½œã€‚</p><p>å½“whereæ¡ä»¶ä½¿ç”¨äºŒçº§ç´¢å¼•æ—¶ï¼ŒInnoDB ä¸ä»…ä¼šå¯¹äºŒçº§ç´¢å¼•ä¸Šçš„è®°å½•åŠ é”ï¼Œè¿˜ä¼šè¿›è¡Œå›è¡¨æ“ä½œæ¥é”å®šèšé›†ç´¢å¼•ä¸Šçš„ç›¸åº”è®°å½•ã€‚</p><h3 id="é—´éš™é”" tabindex="-1"><a class="header-anchor" href="#é—´éš™é”"><span>é—´éš™é”</span></a></h3><p>é—´éš™é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-gap-locks" target="_blank" rel="noopener noreferrer">Gap Locks</a>ï¼‰ï¼šé”ä½<strong>ç´¢å¼•</strong>ä¹‹é—´çš„ <mark>é—´éš™ï¼ˆé”®å€¼åœ¨æ¡ä»¶èŒƒå›´å†…ä½†ä¸å­˜åœ¨çš„ç´¢å¼•è®°å½•ï¼‰</mark></p><p>è¡¨çš„æŸä¸ªç´¢å¼•æ ‘é€šå¸¸åŒ…æ‹¬ä»¥ä¸‹é—´éš™ï¼šç´¢å¼•è®°å½•ä¹‹é—´çš„é—´éš™ï¼Œç¬¬ä¸€æ¡ç´¢å¼•è®°å½•ä¹‹å‰çš„èŒƒå›´ï¼Œæœ€åä¸€æ¡ç´¢å¼•è®°å½•ä¹‹åçš„èŒƒå›´ã€‚ä¾‹ï¼šå‡è®¾æœ‰ä¸€ä¸ªè¡¨ä¸­åŒ…å«ä»¥ä¸‹è®°å½•ï¼ˆç´¢å¼•æœ‰ 2ï¼Œ 4ï¼Œ7ï¼‰ï¼š</p><table><thead><tr><th>customer_id</th><th>first_name</th><th>last_name</th><th>email</th></tr></thead><tbody><tr><td>2</td><td>John</td><td>Doe</td><td><a href="mailto:john.doe@example.com" target="_blank" rel="noopener noreferrer">john.doe@example.com</a></td></tr><tr><td>4</td><td>Jane</td><td>Smith</td><td><a href="mailto:jane.smith@example.com" target="_blank" rel="noopener noreferrer">jane.smith@example.com</a></td></tr><tr><td>7</td><td>Charlie</td><td>Davis</td><td><a href="mailto:charlie.davis@example.com" target="_blank" rel="noopener noreferrer">charlie.davis@example.com</a></td></tr></tbody></table><p>åˆ™å­˜åœ¨ä»¥ä¸‹ç´¢å¼•é—´éš™ï¼š <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="27.155ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 12002.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mo" transform="translate(389,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(1167,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g><g data-mml-node="mo" transform="translate(2167,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(2611.7,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(3111.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3500.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(3945.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(4334.3,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mo" transform="translate(4834.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(5279,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g><g data-mml-node="mo" transform="translate(5779,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(6168,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(6612.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(7001.7,0)"><path data-c="34" d="M462 0Q444 3 333 3Q217 3 199 0H190V46H221Q241 46 248 46T265 48T279 53T286 61Q287 63 287 115V165H28V211L179 442Q332 674 334 675Q336 677 355 677H373L379 671V211H471V165H379V114Q379 73 379 66T385 54Q393 47 442 46H471V0H462ZM293 211V545L74 212L183 211H293Z"></path></g><g data-mml-node="mo" transform="translate(7501.7,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mn" transform="translate(7946.3,0)"><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></g><g data-mml-node="mo" transform="translate(8446.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(8835.3,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mo" transform="translate(9280,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(9669,0)"><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z"></path></g><g data-mml-node="mo" transform="translate(10169,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(10613.7,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g><g data-mml-node="mo" transform="translate(11613.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mo>âˆ’</mo><mi mathvariant="normal">âˆ</mi><mo>,</mo><mn>2</mn><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">(</mo><mn>2</mn><mo>,</mo><mn>4</mn><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">(</mo><mn>4</mn><mo>,</mo><mn>7</mn><mo stretchy="false">)</mo><mo>,</mo><mo stretchy="false">(</mo><mn>7</mn><mo>,</mo><mi mathvariant="normal">âˆ</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container> ï¼Œä¸€ä¸ªé—´éš™å¯èƒ½è¦†ç›–å•ä¸ªç´¢å¼•å€¼ã€å¤šä¸ªç´¢å¼•å€¼ï¼Œç”šè‡³å¯èƒ½æ˜¯ç©ºçš„ã€‚</p><div class="hint-container important"><p class="hint-container-title">é—´éš™é”ä¸äº‹åŠ¡éš”ç¦»çº§åˆ«</p><p>é—´éš™é”åªåœ¨ RR åŠä»¥ä¸Šéš”ç¦»çº§åˆ«æœ‰æ•ˆï¼Œè®¾ç½®äº‹åŠ¡éš”ç¦»ä¸º RC(READ COMMITTEDï¼Œè¯»å·²æäº¤) ç›¸å½“äºç¦ç”¨é—´éš™é”</p><p>åœ¨ <code>å¯é‡å¤è¯»</code>ï¼ˆRepeatable Read, RRï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼ŒInnoDB å¯ä½¿ç”¨é—´éš™é”æ¥é˜²æ­¢å¹»è¯»ã€‚</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ... </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>é€šè¿‡é”å®šé—´éš™ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨è¿™äº›é—´éš™ä¸­æ’å…¥æ–°çš„æ•°æ®ï¼Œä»è€Œé¿å…å¹»è¯»é—®é¢˜ã€‚</p></div><p>é—´éš™é”æ˜¯æ€§èƒ½å’Œå¹¶å‘æ€§ä¹‹é—´çš„ä¸€ç§æƒè¡¡ï¼ŒInnoDB ä¸­çš„é—´éš™é”æ˜¯â€œpurely inhibitive(çº¯ç²¹æŠ‘åˆ¶æ€§çš„)â€ï¼Œå®ƒä»¬å”¯ä¸€çš„ç›®çš„æ˜¯<strong>é˜²æ­¢å…¶ä»–äº‹åŠ¡å‘é—´éš™ä¸­æ’å…¥æ–°è®°å½•</strong>ï¼Œ<mark>é—´éš™é”å¯ä»¥å…±å­˜</mark>ã€‚ä¸€ä¸ªäº‹åŠ¡è·å–çš„é—´éš™é”ä¸ä¼šé˜»æ­¢å¦ä¸€ä¸ªäº‹åŠ¡åœ¨åŒä¸€é—´éš™ä¸Šè·å–é—´éš™é”ã€‚å…±äº«é—´éš™é”å’Œæ’ä»–é—´éš™é”ä¹‹é—´æ²¡æœ‰åŒºåˆ«ã€‚å®ƒä»¬å½¼æ­¤ä¸å†²çª</p><h3 id="ä¸´é”®é”" tabindex="-1"><a class="header-anchor" href="#ä¸´é”®é”"><span>ä¸´é”®é”</span></a></h3><p>ä¸´é”®é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-next-key-locks" target="_blank" rel="noopener noreferrer">Next-Key Locks</a>ï¼‰æ˜¯ç´¢å¼•è®°å½•ä¸Šçš„è®°å½•é”ä¸è¯¥ç´¢å¼•è®°å½•å‰çš„é—´éš™é”çš„ç»„åˆã€‚é€šè¿‡é”å®šå…·ä½“çš„ç´¢å¼•è®°å½•åŠå…¶ä¹‹å‰çš„é—´éš™ï¼Œä¸´é”®é”å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨æ­¤é—´éš™å†…æ’å…¥æ–°è®°å½•ï¼Œä»è€Œé¿å…å¹»è¯»é—®é¢˜ã€‚</p><p>å½“ä¸€ä¸ªäº‹åŠ¡æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ <code>SELECT ... WHERE ... BETWEEN ... AND ... FOR UPDATE</code>ï¼‰æ—¶ï¼ŒInnoDB ä¼šå¯¹æŸ¥è¯¢èŒƒå›´å†…æ‰€æœ‰ç´¢å¼•è®°å½•åŠ ä¸´é”®é”ã€‚è¿™ä¸ä»…åŒ…æ‹¬å®é™…å­˜åœ¨çš„è®°å½•ï¼Œè¿˜åŒ…æ‹¬å®ƒä»¬ä¹‹é—´çš„é—´éš™ã€‚å› æ­¤ï¼Œå³ä½¿åœ¨æŸ¥è¯¢èŒƒå›´å†…æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼ŒInnoDB ä¹Ÿä¼šå¯¹ç›¸åº”çš„é—´éš™åŠ é”ï¼Œä»¥ç¡®ä¿å…¶ä»–äº‹åŠ¡ä¸èƒ½åœ¨æ­¤èŒƒå›´å†…æ’å…¥æ–°è®°å½•ã€‚</p><p>ç¤ºä¾‹ï¼šå‡è®¾æœ‰ä¸€ä¸ªè¡¨ <code>employees</code>ï¼Œå…¶ä¸­ <code>id</code> æ˜¯ä¸»é”®ï¼Œå¹¶ä¸”åŒ…å«ä»¥ä¸‹ <code>id</code> å€¼ï¼š10ã€11ã€13ã€20ã€‚è€ƒè™‘ä»¥ä¸‹äº‹åŠ¡ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> employees </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BETWEEN</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> AND</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 20</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> employees (id, first_name, last_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">12</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Charlie&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Davis&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œäº‹åŠ¡ A å¯¹ <code>id</code> åœ¨ 10 åˆ° 20 èŒƒå›´å†…çš„æ‰€æœ‰ç´¢å¼•è®°å½•åŠ äº†ä¸´é”®é”ï¼Œå…·ä½“åŒ…æ‹¬ï¼š</p><ul><li>è®°å½•é”ï¼š<code>id = 10</code>ã€<code>id = 11</code>ã€<code>id = 13</code>ã€<code>id = 20</code></li><li>é—´éš™é”ï¼š(10, 11]ã€(11, 13]ã€(13, 20]</li></ul><p>å› æ­¤ï¼Œå½“äº‹åŠ¡ B å°è¯•æ’å…¥ <code>id = 12</code> çš„è®°å½•æ—¶ï¼Œä¼šè¢«é˜»å¡ï¼Œç›´åˆ°äº‹åŠ¡ A æäº¤æˆ–å›æ»šã€‚è¿™æœ‰æ•ˆåœ°é˜²æ­¢äº†å¹»è¯»ç°è±¡çš„å‘ç”Ÿã€‚</p><div class="hint-container tip"><p class="hint-container-title">ä¸´é”®é”ï¼ˆNext-Key Locksï¼‰å’Œç´¢å¼•</p><ul><li><p><strong>å”¯ä¸€ç´¢å¼•</strong>ï¼šå¯¹äºå”¯ä¸€ç´¢å¼•ï¼Œå¦‚æœæŸ¥è¯¢æ¡ä»¶èƒ½å¤Ÿå”¯ä¸€ç¡®å®šä¸€æ¡è®°å½•ï¼Œåˆ™ä¸éœ€è¦åŠ é—´éš™é”ï¼Œå› ä¸ºå”¯ä¸€æ€§çº¦æŸå·²ç»ä¿è¯ä¸ä¼šæœ‰é‡å¤å€¼æ’å…¥ã€‚</p></li><li><p><strong>éå”¯ä¸€ç´¢å¼•</strong>ï¼šå¯¹äºéå”¯ä¸€ç´¢å¼•ï¼Œä¸´é”®é”ä¼šè¦†ç›–æ•´ä¸ªæŸ¥è¯¢èŒƒå›´ï¼ŒåŒ…æ‹¬æ‰€æœ‰ç›¸å…³è®°å½•åŠå…¶ä¹‹é—´çš„é—´éš™ã€‚</p></li></ul></div><p><strong>ä¸´é”®é”çš„ä¼˜åŠ¿</strong>:</p><ul><li><strong>é˜²æ­¢å¹»è¯»</strong>ï¼šé€šè¿‡é”å®šç´¢å¼•è®°å½•åŠå…¶ä¹‹å‰çš„é—´éš™ï¼Œä¸´é”®é”æœ‰æ•ˆé˜²æ­¢äº†å…¶ä»–äº‹åŠ¡åœ¨åŒä¸€èŒƒå›´å†…æ’å…¥æ–°è®°å½•ï¼Œä»è€Œé¿å…å¹»è¯»é—®é¢˜ã€‚</li><li><strong>æé«˜å¹¶å‘æ€§</strong>ï¼šç›¸æ¯”äºå®Œå…¨é”å®šæ•´ä¸ªè¡¨ï¼Œä¸´é”®é”åªé”å®šå¿…è¦çš„è®°å½•å’Œé—´éš™ï¼Œæé«˜äº†ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½ã€‚</li></ul><p>ä¸´é”®é”æ˜¯ InnoDB å®ç°é«˜å¹¶å‘æ€§å’Œæ•°æ®ä¸€è‡´æ€§çš„é‡è¦å·¥å…·ï¼Œç‰¹åˆ«æ˜¯åœ¨ <strong>REPEATABLE READ</strong> éš”ç¦»çº§åˆ«ä¸‹ã€‚é€šè¿‡ç»“åˆè®°å½•é”å’Œé—´éš™é”ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆé˜²æ­¢å¹»è¯»ç°è±¡ï¼Œç¡®ä¿äº‹åŠ¡çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚</p><h3 id="æ’å…¥æ„å‘é”" tabindex="-1"><a class="header-anchor" href="#æ’å…¥æ„å‘é”"><span>æ’å…¥æ„å‘é”</span></a></h3><p>æ’å…¥æ„å‘é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-insert-intention-locks" target="_blank" rel="noopener noreferrer">Insert Intention Locks</a>ï¼‰æ˜¯ InnoDB å­˜å‚¨å¼•æ“ä¸­çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„<strong>é—´éš™é”ï¼ˆGap Lockï¼‰</strong>ï¼Œç”¨äºä¼˜åŒ–å¹¶å‘æ’å…¥æ“ä½œã€‚å®ƒè¡¨æ˜ä¸€ä¸ªäº‹åŠ¡æ‰“ç®—åœ¨æŸä¸ªç‰¹å®šçš„é—´éš™å†…æ’å…¥ä¸€æ¡æ–°è®°å½•ï¼Œä½†å¹¶ä¸é”å®šæ•´ä¸ªé—´éš™ã€‚</p><div class="hint-container info"><p class="hint-container-title">æ’å…¥æ„å‘é”çš„å·¥ä½œæœºåˆ¶</p><ul><li>å½“äº‹åŠ¡å°è¯•åœ¨æŸä¸ªç´¢å¼•é—´éš™å†…æ’å…¥è®°å½•æ—¶ï¼Œä¼šå…ˆå°è¯•åœ¨è¯¥é—´éš™ä¸ŠåŠ ä¸€ä¸ªæ’å…¥æ„å‘é”ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–äº‹åŠ¡å¯¹è¯¥é—´éš™æŒæœ‰ä¸å…¼å®¹çš„é”ï¼Œåˆ™æ’å…¥æ„å‘é”æˆåŠŸåŠ é”ã€‚</li><li>æ’å…¥æ„å‘é”ä¹‹é—´æ˜¯å…¼å®¹çš„ï¼Œå› æ­¤å¤šä¸ªäº‹åŠ¡å¯ä»¥åŒæ—¶åœ¨åŒä¸€ä¸ªé—´éš™ä¸ŠæŒæœ‰æ’å…¥æ„å‘é”ã€‚</li><li>åªæœ‰å½“å…¶ä»–äº‹åŠ¡å¯¹è¯¥é—´éš™åŠ äº† <strong>æ’ä»–é”ï¼ˆExclusive Lock, Xé”ï¼‰</strong> æˆ– <strong>å…±äº«é”ï¼ˆShared Lock, Sé”ï¼‰</strong> æ—¶ï¼Œæ’å…¥æ„å‘é”æ‰ä¼šç­‰å¾…ã€‚</li></ul></div><p><strong>ç¤ºä¾‹åœºæ™¯</strong>ï¼šå‡è®¾æœ‰ä¸€ä¸ªè¡¨ <code>employees</code>ï¼Œå…¶ä¸­ <code>id</code> æ˜¯ä¸»é”®ï¼ˆå·²æœ‰çš„ <code>id</code> å€¼ä¸º 2 å’Œ 5ï¼‰</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> employees (id, first_name, last_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Charlie&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Davis&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> employees (id, first_name, last_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Eve&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Smith&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>äº‹åŠ¡ A å’Œäº‹åŠ¡ B éƒ½ä¼šåœ¨åœ¨ç´¢å¼•èŒƒå›´ <code>(2, 5) </code>ä¸ŠåŠ ä¸€ä¸ªæ’å…¥æ„å‘é”ã€‚ç”±äºå®ƒä»¬æ’å…¥çš„ä½ç½®ä¸åŒï¼Œè¿™ä¸¤ä¸ªäº‹åŠ¡å¯ä»¥å¹¶å‘æ‰§è¡Œè€Œä¸ä¼šäº’ç›¸é˜»å¡ã€‚</p><h3 id="è‡ªå¢é”å’Œè°“è¯é”" tabindex="-1"><a class="header-anchor" href="#è‡ªå¢é”å’Œè°“è¯é”"><span>è‡ªå¢é”å’Œè°“è¯é”</span></a></h3><p>è‡ªå¢é”ï¼ˆ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html#innodb-auto-inc-locks" target="_blank" rel="noopener noreferrer">AUTO-INC Locks</a>ï¼‰ç”¨äºç¡®ä¿åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œ<code>AUTO_INCREMENT</code> åˆ—ç”Ÿæˆå”¯ä¸€çš„å€¼ã€‚InnoDB ä½¿ç”¨ä¸¤ç§æ¨¡å¼æ¥å¤„ç†è‡ªå¢é”ï¼š</p><ul><li><strong>ä¼ ç»Ÿæ¨¡å¼ï¼ˆTraditional Modeï¼‰</strong>ï¼šæ¯ä¸ªæ’å…¥æ“ä½œéƒ½ä¼šè·å–ä¸€ä¸ªè¡¨çº§çš„è‡ªå¢é”ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è¾ƒé«˜çš„äº‰ç”¨å’Œè¾ƒä½çš„å¹¶å‘æ€§ã€‚</li><li><strong>æ‰¹é‡æ¨¡å¼ï¼ˆBatch Modeï¼‰</strong>ï¼šä» MySQL 5.7 å¼€å§‹ï¼Œé»˜è®¤ä½¿ç”¨æ‰¹é‡æ¨¡å¼ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼ŒInnoDB ä¼šé¢„å…ˆåˆ†é…ä¸€æ‰¹è‡ªå¢å€¼ï¼Œå¹¶å…è®¸å¤šä¸ªäº‹åŠ¡å¹¶å‘åœ°ä½¿ç”¨è¿™äº›å€¼ï¼Œä»è€Œæé«˜äº†å¹¶å‘æ€§èƒ½ã€‚</li></ul><div class="hint-container info"><p class="hint-container-title">å·¥ä½œæœºåˆ¶</p><ul><li><strong>é¢„åˆ†é…è‡ªå¢å€¼</strong>ï¼šInnoDB ä¼šæ ¹æ®éœ€è¦é¢„å…ˆåˆ†é…ä¸€æ‰¹è‡ªå¢å€¼ï¼Œå¹¶å°†è¿™äº›å€¼å­˜å‚¨åœ¨ä¸€ä¸ªç¼“å­˜ä¸­ã€‚</li><li><strong>å¹¶å‘æ’å…¥</strong>ï¼šå¤šä¸ªäº‹åŠ¡å¯ä»¥ä»ç¼“å­˜ä¸­è·å–è‡ªå¢å€¼ï¼Œè€Œä¸å¿…æ¯æ¬¡éƒ½ç­‰å¾…å…¶ä»–äº‹åŠ¡å®Œæˆæ’å…¥ã€‚</li><li><strong>æŒä¹…åŒ–</strong>ï¼šå³ä½¿æœåŠ¡å™¨é‡å¯ï¼ŒInnoDB ä¹Ÿä¼šè®°ä½æœ€ååˆ†é…çš„è‡ªå¢å€¼ï¼Œä»¥ç¡®ä¿å”¯ä¸€æ€§ã€‚</li></ul></div><p><strong>ç¤ºä¾‹åœºæ™¯</strong>ï¼šå‡è®¾æœ‰ä¸€ä¸ªè¡¨ <code>orders</code>ï¼Œå…¶ä¸­ <code>order_id</code> æ˜¯ <code>AUTO_INCREMENT</code> åˆ—ã€‚å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘è¯¥è¡¨æ’å…¥æ–°è®¢å•æ—¶ï¼ŒInnoDB ä¼šç¡®ä¿æ¯ä¸ªè®¢å•è·å¾—å”¯ä¸€çš„ <code>order_id</code>ï¼Œè€Œä¸ä¼šå› ä¸ºäº‰ç”¨è‡ªå¢é”è€Œå¯¼è‡´æ€§èƒ½ç“¶é¢ˆã€‚</p><p><strong>è°“è¯é”ï¼ˆPredicate Locks for Spatial Indexesï¼‰</strong>ï¼šä¸»è¦ç”¨äºæ”¯æŒç©ºé—´ç´¢å¼•ï¼ˆSpatial Indexesï¼‰ï¼Œå¦‚ GIS æ•°æ®ç±»å‹ã€‚è¿™ç§é”æœºåˆ¶ç¡®ä¿äº†å¯¹ç©ºé—´æ•°æ®çš„æ“ä½œå…·æœ‰ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ï¼Œç‰¹åˆ«æ˜¯åœ¨æ¶‰åŠå¤æ‚çš„ç©ºé—´æŸ¥è¯¢æ—¶ã€‚</p><ul><li><strong>ä½œç”¨</strong>ï¼šé˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨ç›¸åŒçš„ç©ºé—´èŒƒå›´å†…è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œä»è€Œé¿å…æ•°æ®ä¸ä¸€è‡´æˆ–å†²çªã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼šè°“è¯é”åŸºäºæŸ¥è¯¢æ¡ä»¶ï¼ˆå³è°“è¯ï¼‰è€Œä¸æ˜¯å…·ä½“çš„è¡Œæˆ–è®°å½•ã€‚è¿™æ„å‘³ç€å®ƒå¯ä»¥è¦†ç›–æ›´å¤§çš„èŒƒå›´ï¼Œæä¾›æ›´ç»†ç²’åº¦çš„æ§åˆ¶ã€‚ InnoDB ä½¿ç”¨è°“è¯é”æ¥æ”¯æŒå¤æ‚çš„æŸ¥è¯¢ï¼Œå¦‚èŒƒå›´æŸ¥è¯¢ã€é‚»è¿‘æŸ¥è¯¢ç­‰ï¼Œç¡®ä¿åœ¨äº‹åŠ¡æœŸé—´æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li></ul><p><strong>ç¤ºä¾‹åœºæ™¯</strong>ï¼šå‡è®¾æœ‰ä¸€ä¸ªåŒ…å«åœ°ç†åæ ‡çš„æ•°æ®è¡¨ <code>locations</code>ï¼Œå…¶ä¸­ <code>geom</code> åˆ—æ˜¯ä¸€ä¸ªç©ºé—´ç´¢å¼•ã€‚è€ƒè™‘ä»¥ä¸‹äº‹åŠ¡ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> locations </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> MBRContains(ST_GeomFromText(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Polygon((...))&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), geom) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> locations (geom) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (ST_GeomFromText(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Point(...)&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å¦‚æœäº‹åŠ¡ B çš„æ’å…¥ç‚¹ä½äºäº‹åŠ¡ A æŸ¥è¯¢çš„å¤šè¾¹å½¢èŒƒå›´å†…ï¼Œäº‹åŠ¡ B å°†è¢«é˜»å¡ï¼Œç›´åˆ°äº‹åŠ¡ A æäº¤æˆ–å›æ»šã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œäº‹åŠ¡ A å¯¹æ»¡è¶³ <code>MBRContains</code> æ¡ä»¶çš„ç©ºé—´èŒƒå›´åŠ äº†è°“è¯é”ï¼Œå› æ­¤äº‹åŠ¡ B åœ¨å°è¯•æ’å…¥ä½äºè¯¥èŒƒå›´å†…çš„æ–°ç‚¹æ—¶ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°äº‹åŠ¡ A ç»“æŸã€‚</p><h3 id="æ­»é”åˆ†æ" tabindex="-1"><a class="header-anchor" href="#æ­»é”åˆ†æ"><span>æ­»é”åˆ†æ</span></a></h3><h2 id="å¹»è¯»é—®é¢˜å›é¡¾ä¸æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#å¹»è¯»é—®é¢˜å›é¡¾ä¸æ€»ç»“"><span>å¹»è¯»é—®é¢˜å›é¡¾ä¸æ€»ç»“</span></a></h2><p>MySQLçš„å¹¶å‘æ§åˆ¶æœºåˆ¶ä¸»è¦å°±æ˜¯ MVCC å’Œ é” ï¼Œ è¿™ä¸¤è€…åˆéƒ½æ˜¯è§£å†³å¹»è¯»é—®é¢˜çš„å…³é”®</p><div class="hint-container important"><p class="hint-container-title">ä¸åŒæƒ…å½¢çš„å¹»è¯»è§£å†³åŸç†--å¿«ç…§è¯»å’Œå½“å‰è¯»</p><h4 id="_1-æ™®é€š-select-æŸ¥è¯¢-å¿«ç…§è¯»-snapshot-read" tabindex="-1"><a class="header-anchor" href="#_1-æ™®é€š-select-æŸ¥è¯¢-å¿«ç…§è¯»-snapshot-read"><span><strong>1. æ™®é€š <code>SELECT</code> æŸ¥è¯¢ (å¿«ç…§è¯» - Snapshot Read)</strong></span></a></h4><p>å½“ä½¿ç”¨æ™®é€šçš„ <code>SELECT</code> æŸ¥è¯¢æ—¶ï¼Œ<strong>MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰</strong> çš„å¿«ç…§æœºåˆ¶ä¼šç”Ÿæ•ˆï¼š</p><ul><li><strong>MVCC å¿«ç…§</strong>ï¼šäº‹åŠ¡åœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®çš„å¿«ç…§ï¼ˆå½“å‰ä¸€è‡´æ€§è§†å›¾ï¼ŒConsistent Read Viewï¼‰ã€‚æ­¤åï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ™®é€š <code>SELECT</code> æŸ¥è¯¢éƒ½ä¼šåŸºäºè¿™ä¸ªå¿«ç…§è¯»å–æ•°æ®ã€‚</li><li><strong>ä¸€è‡´æ€§</strong>ï¼šç”±äºè¯»å–çš„æ˜¯åŒä¸€ä¸ªå¿«ç…§ï¼Œå³ä½¿å…¶ä»–äº‹åŠ¡æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤äº†æ•°æ®ï¼Œä¹Ÿä¸ä¼šå½±å“å½“å‰äº‹åŠ¡çš„è¯»å–ç»“æœã€‚å› æ­¤ï¼Œä¸ä¼šå‘ç”Ÿå¹»è¯»ã€‚</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New Row&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- å†æ¬¡è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æŸ¥è¯¢ç»“æœä¸ä¼šåŒ…å« id = 101 çš„æ–°è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ˜¯å› ä¸ºäº‹åŠ¡ A å§‹ç»ˆåŸºäºå…¶äº‹åŠ¡å¼€å§‹æ—¶ç”Ÿæˆçš„å¿«ç…§è¯»å–æ•°æ®ã€‚</p><h4 id="_2-select-for-update-æŸ¥è¯¢-å½“å‰è¯»-current-read" tabindex="-1"><a class="header-anchor" href="#_2-select-for-update-æŸ¥è¯¢-å½“å‰è¯»-current-read"><span><strong>2. <code>SELECT ... FOR UPDATE</code> æŸ¥è¯¢ (å½“å‰è¯» - Current Read)</strong></span></a></h4><p>å½“ä½¿ç”¨ <code>SELECT ... FOR UPDATE</code> æˆ– <code>SELECT ... LOCK IN SHARE MODE</code> æŸ¥è¯¢æ—¶ï¼Œæ˜¯ <strong>å½“å‰è¯»ï¼ˆCurrent Readï¼‰</strong>ï¼Œä¼šåŠ é”ä»¥ä¿è¯ä¸€è‡´æ€§ï¼š</p><ul><li><strong>Next-Key Lock</strong>ï¼šåœ¨ REPEATABLE READ éš”ç¦»çº§åˆ«ä¸‹ï¼ŒInnoDB ä¼šä½¿ç”¨ Next-Key Lockï¼ˆç´¢å¼•è®°å½•é” + é—´éš™é”ï¼‰æ¥é”å®šåŒ¹é…çš„è¡Œå’Œç›¸å…³é—´éš™ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åœ¨é”å®šèŒƒå›´å†…æ’å…¥æˆ–ä¿®æ”¹æ•°æ®ã€‚</li><li><strong>ä¸€è‡´æ€§ä¿éšœ</strong>ï¼šé€šè¿‡é”å®šæ¥ç¡®ä¿åœ¨äº‹åŠ¡çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ•°æ®ä¸ä¼šè¢«å…¶ä»–äº‹åŠ¡æ’å…¥æˆ–ä¿®æ”¹ï¼Œä»è€Œé¿å…å¹»è¯»ã€‚</li></ul><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New Row&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">); </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è¢«é˜»å¡ï¼Œå› ä¸º 101 åœ¨ A çš„é”èŒƒå›´å†…</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A å†æ¬¡è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æŸ¥è¯¢ç»“æœä¸€è‡´ï¼Œä¸”æœªå‘ç”Ÿå¹»è¯»</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>é€šè¿‡åŠ é”ï¼Œ<code>SELECT ... FOR UPDATE</code> ç¡®ä¿äº‹åŠ¡ A å¯ä»¥æ„ŸçŸ¥å¹¶é˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®èŒƒå›´çš„ä¿®æ”¹æˆ–æ’å…¥ã€‚</p><hr><h4 id="æ€»ç»“å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“å¯¹æ¯”"><span><strong>æ€»ç»“å¯¹æ¯”</strong></span></a></h4><table><thead><tr><th>æŸ¥è¯¢æ–¹å¼</th><th>æœºåˆ¶/å…³é”®æŠ€æœ¯</th><th>æ˜¯å¦é˜²æ­¢å¹»è¯»</th></tr></thead><tbody><tr><td><strong>æ™®é€š <code>SELECT</code></strong></td><td>MVCC å¿«ç…§ï¼ˆå¿«ç…§è¯»ï¼‰</td><td>é˜²æ­¢å¹»è¯»</td></tr><tr><td><strong><code>SELECT ... FOR UPDATE</code></strong></td><td>Next-Key Lockï¼ˆå½“å‰è¯»ï¼‰</td><td>é˜²æ­¢å¹»è¯»</td></tr></tbody></table><ul><li><strong>æ™®é€š <code>SELECT</code></strong>ï¼šé€šè¿‡ MVCC ä¿è¯ä¸€è‡´æ€§ï¼Œé˜²æ­¢å¹»è¯»ï¼Œæ€§èƒ½æ›´ä¼˜ã€‚</li><li><strong><code>SELECT ... FOR UPDATE</code></strong>ï¼šé€šè¿‡é”æœºåˆ¶é˜»æ­¢å…¶ä»–äº‹åŠ¡çš„æ’å…¥æˆ–ä¿®æ”¹ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§ï¼Œé€‚åˆéœ€è¦ä¿®æ”¹æ•°æ®çš„åœºæ™¯ã€‚</li></ul></div><br><p>åœ¨ MySQL çš„ <strong>REPEATABLE READ (RR)</strong> éš”ç¦»çº§åˆ«ä¸‹ï¼Œæœ‰äººè®¤ä¸ºæ²¡æœ‰å½»åº•è§£å†³å¹»è¯»é—®é¢˜ã€‚å¹¶æå‡ºäº†ä»¥ä¸‹å‡ ç§æƒ…å½¢ï¼š</p><p><strong>æƒ…å½¢ä¸€ å‰åä¸¤æ¬¡æŸ¥è¯¢æ··åˆä½¿ç”¨å½“å‰è¯»å’Œå¿«ç…§è¯»</strong></p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æ²¡æœ‰æŸ¥åˆ°idä¸º101çš„è®°å½•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B ï¼ˆæ’å…¥å®Œè‡ªåŠ¨æäº¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New Row&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡A å†æ¬¡è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FOR</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è¿™é‡Œåˆèƒ½æŸ¥åˆ° id = 101 çš„æ–°è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬äºŒæ¬¡æŸ¥è¯¢ä½¿ç”¨äº† <code>FOR UPDATE</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªé”å®šè¯»ï¼Œå®ƒä¼šè¯»å–æœ€æ–°çš„æ•°æ®å¹¶åŠ é”ï¼Œå› æ­¤å¯ä»¥çœ‹åˆ°æ–°æ’å…¥çš„è®°å½•ã€‚è¿™æ˜¯å› ä¸º<strong>æ··åˆä½¿ç”¨äº†å¿«ç…§è¯»å’Œå½“å‰è¯»</strong>ï¼</p><br><p><strong>æƒ…å½¢äºŒ ä¸¤æ¬¡æŸ¥è¯¢ä¸­é—´æœ¬äº‹åŠ¡æ— æ³•æ’å…¥æ–°æ•°æ®</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æ²¡æœ‰æŸ¥åˆ°idä¸º101çš„è®°å½•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B ï¼ˆæ’å…¥å®Œè‡ªåŠ¨æäº¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New Row&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡A å†æ¬¡è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è¿˜æ˜¯æŸ¥è¯¢ä¸åˆ° id = 101 çš„æ–°è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡Aæ’å…¥æ•°æ®å¤±è´¥ï¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New A&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å› ä¸ºæŸ¥è¯¢ä¸åˆ°æ•°æ®ï¼Œè¿›è¡Œæ’å…¥æ—¶åˆå‘ç°æ’å…¥ä¸äº†ï¼Œä½†è¿™é‡Œæœ¬è´¨åŸå› è¿˜æ˜¯æ²¡æœ‰ä½¿ç”¨<strong>é”å®šè¯»</strong>ï¼Œæ ¹æœ¬æ²¡æœ‰ç”¨åˆ°é”æœºåˆ¶æ¥è§£å†³é—®é¢˜ï¼Œäº‹åŠ¡ä¸­è¦ä¿®æ”¹æˆ–è€…æ’å…¥æ—¶ï¼Œåº”è¯¥å…ˆé€šè¿‡<code>select ... for update</code>æŸ¥è¯¢ï¼Œè€Œä¸æ˜¯æ™®é€šæŸ¥è¯¢</p><br><p><strong>æƒ…å½¢ä¸‰ ä¸¤æ¬¡æŸ¥è¯¢ä¸­é—´æœ¬äº‹åŠ¡æ›´æ–°äº†æ•°æ®</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ A</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">START TRANSACTION</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- æ²¡æœ‰æŸ¥åˆ°idä¸º101çš„è®°å½•</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡ B ï¼ˆæ’å…¥å®Œè‡ªåŠ¨æäº¤ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT INTO</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name (id, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;New Row&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- äº‹åŠ¡A å†æ¬¡è¯»å–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è¿˜æ˜¯æŸ¥è¯¢ä¸åˆ° id = 101 çš„æ–°è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">UPDATE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;new&#39;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 101</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- ä½†æ˜¯è¿™é‡Œèƒ½ä¿®æ”¹ï¼ï¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- è¿™é‡Œåˆèƒ½æŸ¥åˆ° id = 101 çš„æ–°è¡Œ</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>ç¬¬ä¸€æ¬¡æŸ¥è¯¢ï¼šè¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„ <code>SELECT</code>ï¼Œå®ƒæ‰§è¡Œçš„æ˜¯å¿«ç…§è¯»ï¼ˆSnapshot Readï¼‰ï¼Œå› æ­¤çœ‹ä¸åˆ°äº‹åŠ¡ B æ’å…¥çš„æ–°è®°å½•ã€‚</p></li><li><p>ç¬¬äºŒæ¬¡æŸ¥è¯¢ï¼šä»ç„¶æ˜¯å¿«ç…§è¯»ï¼Œæ‰€ä»¥ä»ç„¶çœ‹ä¸åˆ°æ–°æ’å…¥çš„è®°å½•ã€‚</p></li><li><p>æ›´æ–°æ“ä½œï¼šè¿™æ˜¯ä¸€ä¸ªé”å®šè¯»/å½“å‰è¯»ï¼ˆCurrent Readï¼‰ï¼Œå®ƒä¼šè¯»å–æœ€æ–°çš„æ•°æ®å¹¶åŠ é”ï¼Œå› æ­¤å¯ä»¥çœ‹åˆ°å¹¶ä¿®æ”¹æ–°æ’å…¥çš„è®°å½•ã€‚ å®é™…ä¸Šè¿™é‡Œæ ¹æœ¬ä¸å±äºå¸¸è§„æ“ä½œï¼Œè¦æ›´æ–°æ•°æ®ï¼Œä»å¼€å§‹å°±åº”è¯¥ä½¿ç”¨å½“å‰è¯»ã€‚ä»æ­£å¸¸çš„é€»è¾‘ä¹Ÿè¯´ä¸é€šï¼Œéƒ½æ²¡æŸ¥åˆ°æ•°æ®ä½ å»æ›´æ–°ä»€ä¹ˆï¼Ÿè°ä¼šè¿™ä¹ˆå†™ä»£ç ï¼Ÿ</p></li><li><p>ç¬¬ä¸‰æ¬¡æŸ¥è¯¢ï¼šç”±äºä¹‹å‰æ‰§è¡Œäº†é”å®šè¯»ï¼ˆæ›´æ–°æ“ä½œï¼‰ï¼Œäº‹åŠ¡ A å·²ç»çœ‹åˆ°äº†æœ€æ–°æ•°æ®ï¼Œå› æ­¤è¿™æ¬¡æŸ¥è¯¢ä¹Ÿèƒ½çœ‹åˆ°æ–°æ’å…¥çš„è®°å½•ã€‚å³ä¾¿è¿™é‡Œè¿˜è¦ç”¨MVCCçš„readviewä¹Ÿèƒ½è§£é‡Šï¼Œå½“å‰äº‹åŠ¡ä¿®æ”¹è¿‡äº†æ•°æ®ï¼Œé‚£æœ€æ–°ç‰ˆæœ¬ä¸­çš„éšè—å­—æ®µä¸­çš„äº‹åŠ¡IDè‡ªç„¶å˜æˆäº†å½“å‰äº‹åŠ¡IDï¼ŒæŒ‰ç…§å¯è§æ€§è§„åˆ™ä¹Ÿèƒ½è¯»å–åˆ°è¯¥æ•°æ®</p></li></ul><br><p>è¿™äº›æƒ…å½¢å¹¶æ²¡æœ‰è¯´æ˜ RR éš”ç¦»çº§åˆ«æ²¡æœ‰å½»åº•è§£å†³å¹»è¯»é—®é¢˜ã€‚ç›¸åï¼Œå®ƒä»¬å±•ç¤ºäº† RR éš”ç¦»çº§åˆ«ä¸‹å¿«ç…§è¯»å’Œé”å®šè¯»çš„ä¸åŒè¡Œä¸ºã€‚</p><p>å¦‚æœå¸Œæœ›åœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´ä¿æŒç»å¯¹çš„ä¸€è‡´æ€§è§†å›¾ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ›´é«˜çš„éš”ç¦»çº§åˆ« <strong>SERIALIZABLE</strong></p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/ventixy/notebook/edit/main/src/java/database/db/Transaction.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: msdrizzle@outlook.com">drizzle</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/java/database/db/Architecture.html" aria-label="MySQLä½“ç³»æ¶æ„"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->MySQLä½“ç³»æ¶æ„</div></a><a class="route-link auto-link next" href="/java/database/db/mysql-index.html" aria-label="ç´¢å¼•åŠä¼˜åŒ–"><div class="hint">Next<span class="arrow end"></span></div><div class="link">ç´¢å¼•åŠä¼˜åŒ–<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Default footer</div><div class="vp-copyright">Copyright Â© 2025 ventixy </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CYbEao8O.js" defer></script>
  </body>
</html>
