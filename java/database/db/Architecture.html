<!doctype html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.15" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.52" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://x.app/java/database/db/Architecture.html"><meta property="og:site_name" content="doc"><meta property="og:title" content="MySQLä½“ç³»æ¶æ„"><meta property="og:description" content="MySQLä½“ç³»æ¶æ„ MySQL Serveræ¶æ„è‡ªé¡¶å‘ä¸‹å¤§è‡´å¯ä»¥åˆ†ç½‘ç»œè¿æ¥å±‚ã€æœåŠ¡å±‚ã€å­˜å‚¨å¼•æ“å±‚å’Œç³»ç»Ÿæ–‡ä»¶å±‚ã€‚ Connectorsï¼šä¸MySQLæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚ç›®å‰å‡ ä¹æ”¯æŒæ‰€æœ‰ä¸»æµçš„æœåŠ¡ç«¯ç¼–ç¨‹æŠ€æœ¯ï¼Œä¾‹å¦‚å¸¸è§çš„ Javaã€Cã€Pythonã€.NETç­‰ï¼Œå®ƒä»¬é€šè¿‡å„è‡ªAPIæŠ€æœ¯ä¸MySQLå»ºç«‹è¿æ¥ MySQL Serverï¼šæœåŠ¡å±‚æ˜¯MySQLçš„æ ¸å¿ƒï¼Œä¸»è¦åŒ…..."><meta property="og:type" content="article"><meta property="og:image" content="https://image.ventix.top/img02/mysql-architecture.png"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2025-01-19T15:33:28.000Z"><meta property="article:author" content="ventixy"><meta property="article:modified_time" content="2025-01-19T15:33:28.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"MySQLä½“ç³»æ¶æ„","image":["https://image.ventix.top/img02/mysql-architecture.png","https://dev.mysql.com/doc/refman/5.7/en/images/innodb-architecture-5-7.png","https://image.ventix.top/img02/20220118130345103.png","https://image.ventix.top/img02/20220115174918720.png","https://image.ventix.top/img02/20220117040655928.png"],"dateModified":"2025-01-19T15:33:28.000Z","author":[{"@type":"Person","name":"ventixy","url":"https://www.ventix.top"}]}</script><link rel="icon" href="/jav.ico"><title>MySQLä½“ç³»æ¶æ„ | doc</title><meta name="description" content="MySQLä½“ç³»æ¶æ„ MySQL Serveræ¶æ„è‡ªé¡¶å‘ä¸‹å¤§è‡´å¯ä»¥åˆ†ç½‘ç»œè¿æ¥å±‚ã€æœåŠ¡å±‚ã€å­˜å‚¨å¼•æ“å±‚å’Œç³»ç»Ÿæ–‡ä»¶å±‚ã€‚ Connectorsï¼šä¸MySQLæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚ç›®å‰å‡ ä¹æ”¯æŒæ‰€æœ‰ä¸»æµçš„æœåŠ¡ç«¯ç¼–ç¨‹æŠ€æœ¯ï¼Œä¾‹å¦‚å¸¸è§çš„ Javaã€Cã€Pythonã€.NETç­‰ï¼Œå®ƒä»¬é€šè¿‡å„è‡ªAPIæŠ€æœ¯ä¸MySQLå»ºç«‹è¿æ¥ MySQL Serverï¼šæœåŠ¡å±‚æ˜¯MySQLçš„æ ¸å¿ƒï¼Œä¸»è¦åŒ…...">
    <link rel="preload" href="/assets/style-B_XoRuKw.css" as="style"><link rel="stylesheet" href="/assets/style-B_XoRuKw.css">
    <link rel="modulepreload" href="/assets/app-CYbEao8O.js"><link rel="modulepreload" href="/assets/Architecture.html-qnS_E4w6.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-DlAUqK2U.js">
    <link rel="prefetch" href="/assets/index.html-Cygfyzri.js" as="script"><link rel="prefetch" href="/assets/blog.html-Bbisoqvi.js" as="script"><link rel="prefetch" href="/assets/intro.html-_kecMhKB.js" as="script"><link rel="prefetch" href="/assets/index.html-CaxeAqLC.js" as="script"><link rel="prefetch" href="/assets/dev.html-DzAgkaN2.js" as="script"><link rel="prefetch" href="/assets/lang.html-DTz82Fex.js" as="script"><link rel="prefetch" href="/assets/mcp.html-V80QfQVq.js" as="script"><link rel="prefetch" href="/assets/program.html-iQpmuO6a.js" as="script"><link rel="prefetch" href="/assets/prompt.html-BhUndXTb.js" as="script"><link rel="prefetch" href="/assets/rag.html-CJmfPqwM.js" as="script"><link rel="prefetch" href="/assets/springai.html-3PjEwPdH.js" as="script"><link rel="prefetch" href="/assets/index.html-B-jUVxnq.js" as="script"><link rel="prefetch" href="/assets/index.html-BUf57QO5.js" as="script"><link rel="prefetch" href="/assets/index.html-C3_Au531.js" as="script"><link rel="prefetch" href="/assets/index.html-BTnDf4bI.js" as="script"><link rel="prefetch" href="/assets/Gradle.html-fb1QzWuk.js" as="script"><link rel="prefetch" href="/assets/index.html-CHD_1IOR.js" as="script"><link rel="prefetch" href="/assets/maven.html-C2qTN1ya.js" as="script"><link rel="prefetch" href="/assets/theme.html-CzKVvEle.js" as="script"><link rel="prefetch" href="/assets/index.html-DOEh-8hM.js" as="script"><link rel="prefetch" href="/assets/index.html-C35HaWf2.js" as="script"><link rel="prefetch" href="/assets/index.html-B8Udp1vy.js" as="script"><link rel="prefetch" href="/assets/c.html-C501vqVq.js" as="script"><link rel="prefetch" href="/assets/c2.html-Dzf1cWkX.js" as="script"><link rel="prefetch" href="/assets/core.html-B39mlT32.js" as="script"><link rel="prefetch" href="/assets/index.html-DvchOMxj.js" as="script"><link rel="prefetch" href="/assets/Annotation.html-D8r6T2pQ.js" as="script"><link rel="prefetch" href="/assets/Enum.html-BfNjNGe2.js" as="script"><link rel="prefetch" href="/assets/HashMap.html-SQisto7k.js" as="script"><link rel="prefetch" href="/assets/JavaåŸºç¡€.html-Cn8XUAXB.js" as="script"><link rel="prefetch" href="/assets/Javaå¸¸ç”¨ç±»åº“.html-Bx7uaMMC.js" as="script"><link rel="prefetch" href="/assets/Javaé¢å‘å¯¹è±¡.html-x-67g_N7.js" as="script"><link rel="prefetch" href="/assets/Lambda.html-D4FJ1FqO.js" as="script"><link rel="prefetch" href="/assets/index.html-DrxkdYdb.js" as="script"><link rel="prefetch" href="/assets/Reflection.html-C6WH4Hi5.js" as="script"><link rel="prefetch" href="/assets/Stream.html-BX5Jz0kj.js" as="script"><link rel="prefetch" href="/assets/collection.html-DIk4Mcpe.js" as="script"><link rel="prefetch" href="/assets/generics.html-dZTkr-aR.js" as="script"><link rel="prefetch" href="/assets/javaIO.html-C1eAg7-Q.js" as="script"><link rel="prefetch" href="/assets/setå’Œmap.html-dXSG_TpO.js" as="script"><link rel="prefetch" href="/assets/æ•°ç»„å’Œå­—ç¬¦ä¸².html-DpIN09Ao.js" as="script"><link rel="prefetch" href="/assets/index.html-BzGemQho.js" as="script"><link rel="prefetch" href="/assets/index.html-6FV98iwi.js" as="script"><link rel="prefetch" href="/assets/index.html-B87Jt2wX.js" as="script"><link rel="prefetch" href="/assets/index.html-EIeHqQM6.js" as="script"><link rel="prefetch" href="/assets/index.html-BNuVXJ5q.js" as="script"><link rel="prefetch" href="/assets/index.html-CtyHu41a.js" as="script"><link rel="prefetch" href="/assets/idea.html-282Lx6Bo.js" as="script"><link rel="prefetch" href="/assets/mac.html-DTDpWnqv.js" as="script"><link rel="prefetch" href="/assets/nuc8.html-aJmKFRT7.js" as="script"><link rel="prefetch" href="/assets/picgo.html-FJ29dmzO.js" as="script"><link rel="prefetch" href="/assets/usual.html-0PtZaXRt.js" as="script"><link rel="prefetch" href="/assets/vps.html-CwGQK0kE.js" as="script"><link rel="prefetch" href="/assets/website.html-BFCNpuDJ.js" as="script"><link rel="prefetch" href="/assets/windows.html-Nxk3R8uK.js" as="script"><link rel="prefetch" href="/assets/index.html-CgsDZvWm.js" as="script"><link rel="prefetch" href="/assets/encoding.html-DfKrGdSt.js" as="script"><link rel="prefetch" href="/assets/harddisk.html-htMBvwMD.js" as="script"><link rel="prefetch" href="/assets/index.html-BZw9XDYb.js" as="script"><link rel="prefetch" href="/assets/mysql-binlog.html-Cj7vTgYP.js" as="script"><link rel="prefetch" href="/assets/mysql-lock.html-BahfOMhX.js" as="script"><link rel="prefetch" href="/assets/mysql.html-DFzMHqJs.js" as="script"><link rel="prefetch" href="/assets/postgres.html-CDsrHAu4.js" as="script"><link rel="prefetch" href="/assets/ulimit.html-DCmoLP7O.js" as="script"><link rel="prefetch" href="/assets/index.html-LtAD785R.js" as="script"><link rel="prefetch" href="/assets/env.html-Xo4TUOWl.js" as="script"><link rel="prefetch" href="/assets/history.html-DC9k8D05.js" as="script"><link rel="prefetch" href="/assets/jar.html-CcUhZZB-.js" as="script"><link rel="prefetch" href="/assets/kryo.html-Bo_2zDmK.js" as="script"><link rel="prefetch" href="/assets/index.html-DabYQfXK.js" as="script"><link rel="prefetch" href="/assets/k8s.html-CS4B4XAM.js" as="script"><link rel="prefetch" href="/assets/ks-install.html-IhQezYAS.js" as="script"><link rel="prefetch" href="/assets/vm.html-_W0Ta4DN.js" as="script"><link rel="prefetch" href="/assets/index.html-ZJiDlG8g.js" as="script"><link rel="prefetch" href="/assets/crossDomain.html-ChswF6dq.js" as="script"><link rel="prefetch" href="/assets/excel.html-Dyz5e82X.js" as="script"><link rel="prefetch" href="/assets/springboot.html-XsrWyu-P.js" as="script"><link rel="prefetch" href="/assets/index.html-DmLBgxaD.js" as="script"><link rel="prefetch" href="/assets/index.html-C5xbaPEt.js" as="script"><link rel="prefetch" href="/assets/PICO.html-DDaywnzr.js" as="script"><link rel="prefetch" href="/assets/index.html-DeR6BtIG.js" as="script"><link rel="prefetch" href="/assets/ch9329.html-CRmxwCjf.js" as="script"><link rel="prefetch" href="/assets/damb.html-Cl1ZA0ea.js" as="script"><link rel="prefetch" href="/assets/hid.html-D7l9GbCd.js" as="script"><link rel="prefetch" href="/assets/index.html-DinpFnT9.js" as="script"><link rel="prefetch" href="/assets/base.html-CQ8w10kQ.js" as="script"><link rel="prefetch" href="/assets/data.html-BLyFoxwX.js" as="script"><link rel="prefetch" href="/assets/file.html-B6y96nQl.js" as="script"><link rel="prefetch" href="/assets/function.html-CwGerRS1.js" as="script"><link rel="prefetch" href="/assets/oop.html-BvS5Zi-s.js" as="script"><link rel="prefetch" href="/assets/index.html-CX8hbQ_w.js" as="script"><link rel="prefetch" href="/assets/pywin32.html-CWnnlANQ.js" as="script"><link rel="prefetch" href="/assets/yolo.html-CK7U_dmO.js" as="script"><link rel="prefetch" href="/assets/index.html-BqwCZPwM.js" as="script"><link rel="prefetch" href="/assets/base.html-B7cq7clz.js" as="script"><link rel="prefetch" href="/assets/numpy.html-D-NDQqET.js" as="script"><link rel="prefetch" href="/assets/opencv.html-BMuxAxgk.js" as="script"><link rel="prefetch" href="/assets/pillow.html-DTt08qN2.js" as="script"><link rel="prefetch" href="/assets/python.html-B0uKeY6j.js" as="script"><link rel="prefetch" href="/assets/sd.html-B-GvrXsU.js" as="script"><link rel="prefetch" href="/assets/index.html-Dr8hl0wd.js" as="script"><link rel="prefetch" href="/assets/application.html-BV8BxRo7.js" as="script"><link rel="prefetch" href="/assets/call.html-BtKIRSIl.js" as="script"><link rel="prefetch" href="/assets/http.html-CgQDytuM.js" as="script"><link rel="prefetch" href="/assets/interface.html-ld5qkKIK.js" as="script"><link rel="prefetch" href="/assets/io.html-AJHEsWDu.js" as="script"><link rel="prefetch" href="/assets/memory.html-C9kzedI-.js" as="script"><link rel="prefetch" href="/assets/network.html-Dp74x59S.js" as="script"><link rel="prefetch" href="/assets/os.html-BcsRXHge.js" as="script"><link rel="prefetch" href="/assets/process.html-_arsgibw.js" as="script"><link rel="prefetch" href="/assets/transport.html-BqoGc87Z.js" as="script"><link rel="prefetch" href="/assets/index.html-ddv3MG6G.js" as="script"><link rel="prefetch" href="/assets/index.html-DrsnyzlP.js" as="script"><link rel="prefetch" href="/assets/Linux.html-Cm_aFsmu.js" as="script"><link rel="prefetch" href="/assets/index.html-D0JAEB--.js" as="script"><link rel="prefetch" href="/assets/file.html-Cq0lDRon.js" as="script"><link rel="prefetch" href="/assets/setting.html-Cz-RyOK7.js" as="script"><link rel="prefetch" href="/assets/shell.html-BHso3m1Q.js" as="script"><link rel="prefetch" href="/assets/Docker.html-4nTlno4G.js" as="script"><link rel="prefetch" href="/assets/index.html-DzC3JnIL.js" as="script"><link rel="prefetch" href="/assets/install.html-H0NFS6Uc.js" as="script"><link rel="prefetch" href="/assets/k8s.html-BcTbdTcG.js" as="script"><link rel="prefetch" href="/assets/index.html-BnF-DX8i.js" as="script"><link rel="prefetch" href="/assets/git.html-CJGGVixb.js" as="script"><link rel="prefetch" href="/assets/git1.html-DaOtr_kC.js" as="script"><link rel="prefetch" href="/assets/jenkins.html-B2v-aWc0.js" as="script"><link rel="prefetch" href="/assets/index.html-B_KeBbR4.js" as="script"><link rel="prefetch" href="/assets/index.html-BDVTA5ym.js" as="script"><link rel="prefetch" href="/assets/index.html-Dfj41VEs.js" as="script"><link rel="prefetch" href="/assets/index.html-CPLwhCcN.js" as="script"><link rel="prefetch" href="/assets/index.html-Clkv0jFl.js" as="script"><link rel="prefetch" href="/assets/netty.html-DVDprFfo.js" as="script"><link rel="prefetch" href="/assets/nio.html-DlFbzpZx.js" as="script"><link rel="prefetch" href="/assets/socket.html-B0OiM2FD.js" as="script"><link rel="prefetch" href="/assets/theory.html-DME1w7It.js" as="script"><link rel="prefetch" href="/assets/Jvmå†…å­˜ç®¡ç†.html-j8Re9xLU.js" as="script"><link rel="prefetch" href="/assets/Jvmç±»åŠ è½½.html-DJ-ysQ1Y.js" as="script"><link rel="prefetch" href="/assets/index.html-Yma0YYGg.js" as="script"><link rel="prefetch" href="/assets/bytecode.html-QH1zTLls.js" as="script"><link rel="prefetch" href="/assets/pt.html-CB1_7Phu.js" as="script"><link rel="prefetch" href="/assets/index.html-C8as36N9.js" as="script"><link rel="prefetch" href="/assets/lock.html-C1yTJ-g3.js" as="script"><link rel="prefetch" href="/assets/pool.html-Dg2l0lOW.js" as="script"><link rel="prefetch" href="/assets/thread.html-CvJd-bdn.js" as="script"><link rel="prefetch" href="/assets/tool.html-BJqeYZJh.js" as="script"><link rel="prefetch" href="/assets/index.html-CdvwvR9M.js" as="script"><link rel="prefetch" href="/assets/Transaction.html-B0Aih_ag.js" as="script"><link rel="prefetch" href="/assets/mysql-index.html-fX29xgPL.js" as="script"><link rel="prefetch" href="/assets/redis-java.html-CzI1g89Z.js" as="script"><link rel="prefetch" href="/assets/redis.html-7RL3CUlo.js" as="script"><link rel="prefetch" href="/assets/sql.html-yN06V877.js" as="script"><link rel="prefetch" href="/assets/Hibernate.html-Nt0GZATi.js" as="script"><link rel="prefetch" href="/assets/index.html-Dv7STxhH.js" as="script"><link rel="prefetch" href="/assets/generator.html-CN5rX70j.js" as="script"><link rel="prefetch" href="/assets/mybatis-resource.html-WXuVV76F.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-PnyhFFzL.js" as="script"><link rel="prefetch" href="/assets/tk-mybatis.html-6orVKYMW.js" as="script"><link rel="prefetch" href="/assets/index.html-8SBcULZn.js" as="script"><link rel="prefetch" href="/assets/Servlet.html-CBEpWT9G.js" as="script"><link rel="prefetch" href="/assets/jsp.html-BF246k5D.js" as="script"><link rel="prefetch" href="/assets/mvc.html-H_nZ4f0m.js" as="script"><link rel="prefetch" href="/assets/nginx.html-CNUu-Jds.js" as="script"><link rel="prefetch" href="/assets/tomcat.html-8y2sPrtZ.js" as="script"><link rel="prefetch" href="/assets/index.html-BJfwWPM-.js" as="script"><link rel="prefetch" href="/assets/log.html-DFHlNCTC.js" as="script"><link rel="prefetch" href="/assets/shiro.html-B--dXyuX.js" as="script"><link rel="prefetch" href="/assets/index.html-B8spMVmQ.js" as="script"><link rel="prefetch" href="/assets/design.html-DvbPMGvf.js" as="script"><link rel="prefetch" href="/assets/life.html-CyBmOK95.js" as="script"><link rel="prefetch" href="/assets/mvc-core.html-DO1TK80F.js" as="script"><link rel="prefetch" href="/assets/sb-core.html-Cztp04Wy.js" as="script"><link rel="prefetch" href="/assets/sec.html-Ks1LenAX.js" as="script"><link rel="prefetch" href="/assets/spring.html-BJ17uaA-.js" as="script"><link rel="prefetch" href="/assets/springboot.html-Br9Et0RA.js" as="script"><link rel="prefetch" href="/assets/springmvc.html-CBtc7iWY.js" as="script"><link rel="prefetch" href="/assets/transaction.html-DZ6KIifW.js" as="script"><link rel="prefetch" href="/assets/index.html-rq4jq_Lc.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-DEIvIY_D.js" as="script"><link rel="prefetch" href="/assets/mysql.html-DRg7K0gs.js" as="script"><link rel="prefetch" href="/assets/redis.html-CJRdRYvp.js" as="script"><link rel="prefetch" href="/assets/security.html-B1gh7vfK.js" as="script"><link rel="prefetch" href="/assets/spring.html-DSVwakKn.js" as="script"><link rel="prefetch" href="/assets/springboot.html-CoMpjK2J.js" as="script"><link rel="prefetch" href="/assets/index.html-CDUiSr-c.js" as="script"><link rel="prefetch" href="/assets/base.html-DWgJPIPK.js" as="script"><link rel="prefetch" href="/assets/collect.html-Bl_ZKiQM.js" as="script"><link rel="prefetch" href="/assets/concurrency.html-CnM6diFo.js" as="script"><link rel="prefetch" href="/assets/jvm.html-Dd422-Hx.js" as="script"><link rel="prefetch" href="/assets/index.html-DBtaICdJ.js" as="script"><link rel="prefetch" href="/assets/es.html-C04swIWt.js" as="script"><link rel="prefetch" href="/assets/rocketmq.html-D8GsKibm.js" as="script"><link rel="prefetch" href="/assets/sys.html-Bm3pD7W3.js" as="script"><link rel="prefetch" href="/assets/index.html-Dfi3O-LT.js" as="script"><link rel="prefetch" href="/assets/RabbitMQ.html--pAav3UF.js" as="script"><link rel="prefetch" href="/assets/RockMQ.html-DdYHY5c6.js" as="script"><link rel="prefetch" href="/assets/Sentinel.html-BZQgvmWt.js" as="script"><link rel="prefetch" href="/assets/dubbo.html-BK_2ezpk.js" as="script"><link rel="prefetch" href="/assets/es.html-Cc0ong64.js" as="script"><link rel="prefetch" href="/assets/eureka.html-Do3472Gl.js" as="script"><link rel="prefetch" href="/assets/gateway.html-lrPlHM9a.js" as="script"><link rel="prefetch" href="/assets/hystrix.html-C_-tkA95.js" as="script"><link rel="prefetch" href="/assets/kafka.html-2-kqHeIn.js" as="script"><link rel="prefetch" href="/assets/nacos.html-CH1dI2sX.js" as="script"><link rel="prefetch" href="/assets/zookeeper.html-B3hftmrJ.js" as="script"><link rel="prefetch" href="/assets/index.html-CcW0MVh0.js" as="script"><link rel="prefetch" href="/assets/cron.html-DEBIb9en.js" as="script"><link rel="prefetch" href="/assets/db.html-DTDimjmf.js" as="script"><link rel="prefetch" href="/assets/dup.html-SaHJHaHX.js" as="script"><link rel="prefetch" href="/assets/lock.html-D-jCBfU2.js" as="script"><link rel="prefetch" href="/assets/redis.html-wMGQQXCt.js" as="script"><link rel="prefetch" href="/assets/transac.html-i-gow_fg.js" as="script"><link rel="prefetch" href="/assets/walk.html-ltUpWt1A.js" as="script"><link rel="prefetch" href="/assets/index.html-BG-VdKAi.js" as="script"><link rel="prefetch" href="/assets/numpy.html-DFpDzTud.js" as="script"><link rel="prefetch" href="/assets/pandas.html-B0ghgZGo.js" as="script"><link rel="prefetch" href="/assets/index.html-DHiUkDGF.js" as="script"><link rel="prefetch" href="/assets/css.html-DPlZXza3.js" as="script"><link rel="prefetch" href="/assets/css2.html-BBTuDL6p.js" as="script"><link rel="prefetch" href="/assets/css3.html-Dd1JshDN.js" as="script"><link rel="prefetch" href="/assets/css4.html-dxClVPyX.js" as="script"><link rel="prefetch" href="/assets/html.html-C4uEhZNf.js" as="script"><link rel="prefetch" href="/assets/html5.html-DXi8zT_t.js" as="script"><link rel="prefetch" href="/assets/index.html-BjmfCjsU.js" as="script"><link rel="prefetch" href="/assets/dom.html-D6C0GmUH.js" as="script"><link rel="prefetch" href="/assets/es6.html-Dd6gGVU6.js" as="script"><link rel="prefetch" href="/assets/js.html-BKCfzT2z.js" as="script"><link rel="prefetch" href="/assets/js2.html-B0xHqbgN.js" as="script"><link rel="prefetch" href="/assets/index.html-Dnn-5Myu.js" as="script"><link rel="prefetch" href="/assets/ts.html-DLkDEW9O.js" as="script"><link rel="prefetch" href="/assets/ts2.html-iUxniJdR.js" as="script"><link rel="prefetch" href="/assets/index.html-Z2FcNKHI.js" as="script"><link rel="prefetch" href="/assets/react.html-BhMy19C9.js" as="script"><link rel="prefetch" href="/assets/ui.html-CO1yz8Tj.js" as="script"><link rel="prefetch" href="/assets/vue.html-60Q21q7v.js" as="script"><link rel="prefetch" href="/assets/index.html-i2FGAbTJ.js" as="script"><link rel="prefetch" href="/assets/backend.html-BbZVQMc0.js" as="script"><link rel="prefetch" href="/assets/nestjs.html-CWNgYskl.js" as="script"><link rel="prefetch" href="/assets/index.html--L0U4DLt.js" as="script"><link rel="prefetch" href="/assets/build.html-DDrHDtgy.js" as="script"><link rel="prefetch" href="/assets/format.html-BM91zCOx.js" as="script"><link rel="prefetch" href="/assets/node.html-CLIsFeSZ.js" as="script"><link rel="prefetch" href="/assets/index.html-GWJfLyyN.js" as="script"><link rel="prefetch" href="/assets/index.html-D2uSN1GF.js" as="script"><link rel="prefetch" href="/assets/index.html-D8rEBkRy.js" as="script"><link rel="prefetch" href="/assets/baz.html-DCoDkWxB.js" as="script"><link rel="prefetch" href="/assets/index.html-BkO9UHwJ.js" as="script"><link rel="prefetch" href="/assets/ray.html-CpD8kU-D.js" as="script"><link rel="prefetch" href="/assets/404.html-B-r8-OX6.js" as="script"><link rel="prefetch" href="/assets/index.html-CfN3Hcaw.js" as="script"><link rel="prefetch" href="/assets/index.html-Kjyi5J2A.js" as="script"><link rel="prefetch" href="/assets/index.html-DFDTwjUa.js" as="script"><link rel="prefetch" href="/assets/index.html-BfYrSWsb.js" as="script"><link rel="prefetch" href="/assets/index.html-CmVvGxuU.js" as="script"><link rel="prefetch" href="/assets/index.html-DIvrx9M_.js" as="script"><link rel="prefetch" href="/assets/index.html-DymN6sBe.js" as="script"><link rel="prefetch" href="/assets/index.html-D12kYdZ7.js" as="script"><link rel="prefetch" href="/assets/index.html-CE9-vc7S.js" as="script"><link rel="prefetch" href="/assets/index.html-R4-wXX9q.js" as="script"><link rel="prefetch" href="/assets/index.html-C5lWNcEB.js" as="script"><link rel="prefetch" href="/assets/index.html-CNBC7h0k.js" as="script"><link rel="prefetch" href="/assets/index.html-CwtCQoEq.js" as="script"><link rel="prefetch" href="/assets/index.html-FpvglhkP.js" as="script"><link rel="prefetch" href="/assets/index.html-DYewPzYK.js" as="script"><link rel="prefetch" href="/assets/index.html-DlHraM5W.js" as="script"><link rel="prefetch" href="/assets/index.html-B1U9NMIg.js" as="script"><link rel="prefetch" href="/assets/index.html-CMVjLthT.js" as="script"><link rel="prefetch" href="/assets/index.html-BAIUxd4b.js" as="script"><link rel="prefetch" href="/assets/index.html-CcXHauUc.js" as="script"><link rel="prefetch" href="/assets/index.html-DlWFhQAh.js" as="script"><link rel="prefetch" href="/assets/index.html-5Y8FuIY3.js" as="script"><link rel="prefetch" href="/assets/index.html-J1p_eGlb.js" as="script"><link rel="prefetch" href="/assets/index.html-BZCRz5gv.js" as="script"><link rel="prefetch" href="/assets/index.html-CQhckmWh.js" as="script"><link rel="prefetch" href="/assets/index.html-jHP9nIpi.js" as="script"><link rel="prefetch" href="/assets/index.html-Cm26WBxm.js" as="script"><link rel="prefetch" href="/assets/index.html-B3hg6GV3.js" as="script"><link rel="prefetch" href="/assets/index.html-BIX27Gmp.js" as="script"><link rel="prefetch" href="/assets/index.html-DVHEGjMt.js" as="script"><link rel="prefetch" href="/assets/index.html-RK-J8b_u.js" as="script"><link rel="prefetch" href="/assets/index.html-B16ztYg-.js" as="script"><link rel="prefetch" href="/assets/index.html-DDrc9TiV.js" as="script"><link rel="prefetch" href="/assets/index.html-DKjI7Y2e.js" as="script"><link rel="prefetch" href="/assets/index.html-CnwSR7Wc.js" as="script"><link rel="prefetch" href="/assets/index.html-B8nSGQOu.js" as="script"><link rel="prefetch" href="/assets/index.html-nNkowOzK.js" as="script"><link rel="prefetch" href="/assets/index.html-D1UCmhni.js" as="script"><link rel="prefetch" href="/assets/index.html-CDxMLJ1l.js" as="script"><link rel="prefetch" href="/assets/index.html-BDPZVId-.js" as="script"><link rel="prefetch" href="/assets/index.html-BcSiMV1v.js" as="script"><link rel="prefetch" href="/assets/index.html-dpHuK_DW.js" as="script"><link rel="prefetch" href="/assets/index.html-DC2uo5lk.js" as="script"><link rel="prefetch" href="/assets/index.html-id-krpAg.js" as="script"><link rel="prefetch" href="/assets/index.html-B-k9gcpd.js" as="script"><link rel="prefetch" href="/assets/index.html-Bg_WCly5.js" as="script"><link rel="prefetch" href="/assets/index.html-C_W5ueSp.js" as="script"><link rel="prefetch" href="/assets/index.html-CGs-6kN0.js" as="script"><link rel="prefetch" href="/assets/index.html-DOki0epm.js" as="script"><link rel="prefetch" href="/assets/index.html-D-NEPBbq.js" as="script"><link rel="prefetch" href="/assets/index.html-De-X1HAS.js" as="script"><link rel="prefetch" href="/assets/index.html-DL5BYvCo.js" as="script"><link rel="prefetch" href="/assets/index.html-abQVA6uc.js" as="script"><link rel="prefetch" href="/assets/index.html-jDzwgSn3.js" as="script"><link rel="prefetch" href="/assets/index.html-DOCal--h.js" as="script"><link rel="prefetch" href="/assets/index.html-BOJ9A6eV.js" as="script"><link rel="prefetch" href="/assets/index.html-CfB_E_cN.js" as="script"><link rel="prefetch" href="/assets/index.html-CxNo7H5e.js" as="script"><link rel="prefetch" href="/assets/index.html-DqVxGmUF.js" as="script"><link rel="prefetch" href="/assets/index.html-6rJ2y6ZE.js" as="script"><link rel="prefetch" href="/assets/index.html-BDCXUTNd.js" as="script"><link rel="prefetch" href="/assets/index.html-ZZMw3JNl.js" as="script"><link rel="prefetch" href="/assets/index.html-mOHm16pi.js" as="script"><link rel="prefetch" href="/assets/index.html-3Rh-0wxr.js" as="script"><link rel="prefetch" href="/assets/index.html-DJgGto4P.js" as="script"><link rel="prefetch" href="/assets/index.html-DT4XkccF.js" as="script"><link rel="prefetch" href="/assets/index.html-F0b1YsrA.js" as="script"><link rel="prefetch" href="/assets/index.html-CL83qZdD.js" as="script"><link rel="prefetch" href="/assets/index.html-ChFeFdmx.js" as="script"><link rel="prefetch" href="/assets/index.html-DoMFsb2J.js" as="script"><link rel="prefetch" href="/assets/index.html-CP1_xS0g.js" as="script"><link rel="prefetch" href="/assets/index.html-D_cKi3ai.js" as="script"><link rel="prefetch" href="/assets/index.html-CPQBrBFc.js" as="script"><link rel="prefetch" href="/assets/index.html-BBjUgv6N.js" as="script"><link rel="prefetch" href="/assets/index.html-DDN9wQxt.js" as="script"><link rel="prefetch" href="/assets/index.html-YjWLNNBB.js" as="script"><link rel="prefetch" href="/assets/index.html-CH-icHGX.js" as="script"><link rel="prefetch" href="/assets/index.html-BcHdmWER.js" as="script"><link rel="prefetch" href="/assets/index.html-GgGR4x_9.js" as="script"><link rel="prefetch" href="/assets/index.html-Br06Ugs_.js" as="script"><link rel="prefetch" href="/assets/index.html-Bs7Umwxc.js" as="script"><link rel="prefetch" href="/assets/index.html-Dbp1NkcC.js" as="script"><link rel="prefetch" href="/assets/index.html-DL4uIEZx.js" as="script"><link rel="prefetch" href="/assets/index.html-DkJeuH-O.js" as="script"><link rel="prefetch" href="/assets/flowchart-CTwbLKUk.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-B5TJVwBc.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-DXWKOczD.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container external-link-icon has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">doc</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/AI/" aria-label="  AI  "><!--[--><span class="font-icon icon iconfont icon-ai-robot" style=""></span><!--]-->  AI  <!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Java"><!--[--><span class="font-icon icon iconfont icon-java" style=""></span>Java<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Javaå¼€å‘çŸ¥è¯†ä½“ç³»</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/base/" aria-label="JavaåŸºç¡€è¯­æ³•å…¥é—¨"><!---->JavaåŸºç¡€è¯­æ³•å…¥é—¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/core/" aria-label="Javaè¿›é˜¶åŠæ ¸å¿ƒç‰¹æ€§"><!---->Javaè¿›é˜¶åŠæ ¸å¿ƒç‰¹æ€§<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/frame/" aria-label="JavaWebåŠå¸¸ç”¨æ¡†æ¶"><!---->JavaWebåŠå¸¸ç”¨æ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link route-link-active auto-link" href="/java/database/" aria-label="æ•°æ®åº“ä¸ORMæ¡†æ¶"><!---->æ•°æ®åº“ä¸ORMæ¡†æ¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/java/service/" aria-label="åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡æ¶æ„"><!---->åˆ†å¸ƒå¼ä¸å¾®æœåŠ¡æ¶æ„<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Javaé¡¹ç›®åŠè§£å†³æ–¹æ¡ˆ</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/base/" aria-label="å¸¸è§å·¥å…·å’Œç¯å¢ƒ"><!---->å¸¸è§å·¥å…·å’Œç¯å¢ƒ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/mall/" aria-label="ç”µå•†é¡¹ç›®ç»¼åˆå®è·µ"><!---->ç”µå•†é¡¹ç›®ç»¼åˆå®è·µ<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/project/solution/" aria-label="é¡¹ç›®åœºæ™¯è§£å†³æ–¹æ¡ˆ"><!---->é¡¹ç›®åœºæ™¯è§£å†³æ–¹æ¡ˆ<!----></a></li></ul></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/java/interview/" aria-label="Javaå¸¸è§é¢è¯•é¢˜åˆ†æ"><!--[--><span class="font-icon icon iconfont icon-microservice" style=""></span><!--]-->Javaå¸¸è§é¢è¯•é¢˜åˆ†æ<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Web"><!--[--><span class="font-icon icon iconfont icon-net" style=""></span>Web<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/base/" aria-label="å‰ç«¯åŸºç¡€çŸ¥è¯†"><!--[--><span class="font-icon icon iconfont icon-net" style=""></span><!--]-->å‰ç«¯åŸºç¡€çŸ¥è¯†<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/core/" aria-label="å¼€å‘æ¡†æ¶å’Œå·¥å…·"><!--[--><span class="font-icon icon iconfont icon-cloud" style=""></span><!--]-->å¼€å‘æ¡†æ¶å’Œå·¥å…·<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/web/security/" aria-label="æ€§èƒ½ä¼˜åŒ–ä¸Webå®‰å…¨"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span><!--]-->æ€§èƒ½ä¼˜åŒ–ä¸Webå®‰å…¨<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Python"><!--[--><span class="font-icon icon iconfont icon-python" style=""></span>Python<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/base/" aria-label="å¼€å‘ç¯å¢ƒå’ŒåŸºç¡€è¯­æ³•"><!--[--><span class="font-icon icon iconfont icon-python" style=""></span><!--]-->å¼€å‘ç¯å¢ƒå’ŒåŸºç¡€è¯­æ³•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/frame/" aria-label="å¸¸ç”¨åº“å’Œæ¡†æ¶"><!--[--><span class="font-icon icon iconfont icon-app" style=""></span><!--]-->å¸¸ç”¨åº“å’Œæ¡†æ¶<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/image/" aria-label="Pythonå›¾åƒå¤„ç†"><!--[--><span class="font-icon icon iconfont icon-img" style=""></span><!--]-->Pythonå›¾åƒå¤„ç†<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/python/Project/" aria-label="ç›¸å…³é¡¹ç›®åŠåº”ç”¨"><!--[--><span class="font-icon icon iconfont icon-project" style=""></span><!--]-->ç›¸å…³é¡¹ç›®åŠåº”ç”¨<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="C++"><!--[--><span class="font-icon icon iconfont icon-cpp" style=""></span>C++<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/cpp/base/" aria-label="C/C++åŸºç¡€è¯­æ³•å…¥é—¨"><!---->C/C++åŸºç¡€è¯­æ³•å…¥é—¨<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/cpp/ed/" aria-label="å•ç‰‡æœºå’ŒåµŒå…¥å¼å¼€å‘"><!---->å•ç‰‡æœºå’ŒåµŒå…¥å¼å¼€å‘<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="Blog"><!--[--><span class="font-icon icon iconfont icon-blog" style=""></span>Blog<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/blog.html" aria-label="Blog HomePage"><!--[--><span class="font-icon icon iconfont icon-home" style=""></span><!--]-->Blog HomePage<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/blog/" aria-label="å¯¼èˆª/æ—¥å¸¸åšå®¢è®°å½•"><!---->å¯¼èˆª/æ—¥å¸¸åšå®¢è®°å½•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/cs/" aria-label="è®¡ç®—æœºç†è®ºåŸºç¡€"><!---->è®¡ç®—æœºç†è®ºåŸºç¡€<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/java/" aria-label="Java/AIå¼€å‘ç›¸å…³è®°å½•"><!---->Java/AIå¼€å‘ç›¸å…³è®°å½•<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/db/" aria-label="æ•°æ®åº“ç›¸å…³åšå®¢"><!---->æ•°æ®åº“ç›¸å…³åšå®¢<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/om/" aria-label="è¿ç»´åŸºç¡€åŠç¯å¢ƒæ­å»º"><!---->è¿ç»´åŸºç¡€åŠç¯å¢ƒæ­å»º<!----></a></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/ventixy/notebook" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><span class="font-icon icon iconfont icon-db" style=""></span><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/java/database/" aria-label="æ•°æ®åº“ä¸ORMæ¡†æ¶"><!---->æ•°æ®åº“ä¸ORMæ¡†æ¶<!----></a><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><!----><span class="vp-sidebar-title">å¸¸ç”¨æ•°æ®åº“</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/sql.html" aria-label="MySQLæ•°æ®åº“"><!---->MySQLæ•°æ®åº“<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/java/database/db/Architecture.html" aria-label="MySQLä½“ç³»æ¶æ„"><!---->MySQLä½“ç³»æ¶æ„<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/Transaction.html" aria-label="äº‹åŠ¡ä¸é”æœºåˆ¶"><!---->äº‹åŠ¡ä¸é”æœºåˆ¶<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/mysql-index.html" aria-label="ç´¢å¼•åŠä¼˜åŒ–"><!---->ç´¢å¼•åŠä¼˜åŒ–<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/redis.html" aria-label="Redisæ•°æ®ç¼“å­˜"><!---->Redisæ•°æ®ç¼“å­˜<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/db/redis-java.html" aria-label="Javaæ“ä½œRedis"><!---->Javaæ“ä½œRedis<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><!----><span class="vp-sidebar-title">ORMæ¡†æ¶</span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/Hibernate.html" aria-label="Hibernate"><!---->Hibernate<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/mybatis.html" aria-label="Mybatis"><!---->Mybatis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/tk-mybatis.html" aria-label="tk-mybatis"><!---->tk-mybatis<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/generator.html" aria-label="ä»£ç ç”Ÿæˆ"><!---->ä»£ç ç”Ÿæˆ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/java/database/orm/mybatis-resource.html" aria-label="mybatisæºç å‰–æ"><!---->mybatisæºç å‰–æ<!----></a></li></ul></section></li></ul></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->MySQLä½“ç³»æ¶æ„</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.ventix.top" target="_blank" rel="noopener noreferrer">ventixy</a></span><span property="author" content="ventixy"></span></span><!----><span class="page-date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2025-01-19T15:33:28.000Z"></span><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 27 min</span><meta property="timeRequired" content="PT27M"></span><!----><!----></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!----><div class="vp-toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysqlä½“ç³»æ¶æ„">MySQLä½“ç³»æ¶æ„</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#mysql-server">MySQL Server</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#file-system">File System</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#innodbå­˜å‚¨å¼•æ“">Innodbå­˜å‚¨å¼•æ“</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#architecture">Architecture</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#buffer-pool">Buffer Pool</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#change-buffer">Change Buffer</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#innodbæ–‡ä»¶å­˜å‚¨ç»“æ„">InnoDBæ–‡ä»¶å­˜å‚¨ç»“æ„</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#innodbæ–‡ä»¶å­˜å‚¨æ ¼å¼">InnoDBæ–‡ä»¶å­˜å‚¨æ ¼å¼</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#tablespaces">Tablespaces</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#selectæŸ¥è¯¢æµç¨‹">SelectæŸ¥è¯¢æµç¨‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#é€šè®¯æœºåˆ¶ä¸çº¿ç¨‹">é€šè®¯æœºåˆ¶ä¸çº¿ç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æŸ¥è¯¢ç¼“å­˜">æŸ¥è¯¢ç¼“å­˜</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è§£æå™¨å’Œä¼˜åŒ–å™¨">è§£æå™¨å’Œä¼˜åŒ–å™¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#updateæµç¨‹ä¸æ—¥å¿—æœºåˆ¶">Updateæµç¨‹ä¸æ—¥å¿—æœºåˆ¶</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#walæŠ€æœ¯">WALæŠ€æœ¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#updateæ›´æ–°æµç¨‹">Updateæ›´æ–°æµç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä¸¤é˜¶æ®µæäº¤-å†…éƒ¨xa">ä¸¤é˜¶æ®µæäº¤(å†…éƒ¨XA)</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#redo-log">Redo Log</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#binlog">Binlog</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#mysqlæ—¥å¿—ç®¡ç†">MySQLæ—¥å¿—ç®¡ç†</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content"><h2 id="mysqlä½“ç³»æ¶æ„" tabindex="-1"><a class="header-anchor" href="#mysqlä½“ç³»æ¶æ„"><span>MySQLä½“ç³»æ¶æ„</span></a></h2><p>MySQL Serveræ¶æ„è‡ªé¡¶å‘ä¸‹å¤§è‡´å¯ä»¥åˆ†ç½‘ç»œè¿æ¥å±‚ã€æœåŠ¡å±‚ã€å­˜å‚¨å¼•æ“å±‚å’Œç³»ç»Ÿæ–‡ä»¶å±‚ã€‚</p><ul><li><p><strong>Connectors</strong>ï¼šä¸MySQLæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚ç›®å‰å‡ ä¹æ”¯æŒæ‰€æœ‰ä¸»æµçš„æœåŠ¡ç«¯ç¼–ç¨‹æŠ€æœ¯ï¼Œä¾‹å¦‚å¸¸è§çš„ Javaã€Cã€Pythonã€.NETç­‰ï¼Œå®ƒä»¬é€šè¿‡å„è‡ªAPIæŠ€æœ¯ä¸MySQLå»ºç«‹è¿æ¥</p></li><li><p><strong>MySQL Server</strong>ï¼šæœåŠ¡å±‚æ˜¯MySQLçš„æ ¸å¿ƒï¼Œä¸»è¦åŒ…å«ç³»ç»Ÿç®¡ç†å’Œæ§åˆ¶å·¥å…·ã€è¿æ¥æ± ã€SQLæ¥å£ã€è§£æå™¨ã€æŸ¥è¯¢ä¼˜åŒ–å™¨å’Œç¼“å­˜å…­ä¸ªéƒ¨åˆ†ã€‚</p></li><li><p><strong>Pluggable Storage Engines</strong>ï¼šå­˜å‚¨å¼•æ“è´Ÿè´£MySQLä¸­æ•°æ®çš„å­˜å‚¨ä¸æå–ï¼Œä¸åº•å±‚ç³»ç»Ÿæ–‡ä»¶è¿›è¡Œäº¤äº’ã€‚MySQLå­˜å‚¨å¼•æ“æ˜¯æ’ä»¶å¼çš„ï¼ŒæœåŠ¡å™¨ä¸­çš„æŸ¥è¯¢æ‰§è¡Œå¼•æ“é€šè¿‡æ¥å£ä¸å­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ï¼Œæ¥å£å±è”½äº†ä¸åŒå­˜å‚¨å¼•æ“ä¹‹é—´çš„å·®å¼‚ ã€‚ç°åœ¨æœ‰å¾ˆå¤šç§å­˜å‚¨å¼•æ“ï¼Œå„æœ‰å„çš„ç‰¹ç‚¹ï¼Œæœ€å¸¸è§çš„æ˜¯MyISAMå’ŒInnoDBã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ¨èä½¿ç”¨InnoDB</p></li><li><p><strong>File System</strong>ï¼šè¯¥å±‚è´Ÿè´£å°†æ•°æ®åº“çš„æ•°æ®å’Œæ—¥å¿—å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’ï¼Œæ˜¯æ–‡ä»¶çš„ç‰©ç†å­˜å‚¨å±‚ã€‚ä¸»è¦åŒ…å«æ—¥å¿—æ–‡ä»¶ï¼Œæ•°æ®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ï¼Œpid æ–‡ä»¶ï¼Œsocket æ–‡ä»¶ç­‰ã€‚</p></li></ul><figure><img src="https://image.ventix.top/img02/mysql-architecture.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="mysql-server" tabindex="-1"><a class="header-anchor" href="#mysql-server"><span>MySQL Server</span></a></h3><ul><li><p>è¿æ¥æ± ï¼ˆConnection Poolï¼‰ï¼šè´Ÿè´£å­˜å‚¨å’Œç®¡ç†å®¢æˆ·ç«¯ä¸æ•°æ®åº“çš„è¿æ¥ã€‚</p></li><li><p>ç³»ç»Ÿç®¡ç†å’Œæ§åˆ¶å·¥å…·ï¼ˆManagement Services &amp; Utilitiesï¼‰ï¼šå¦‚å¤‡ä»½æ¢å¤ã€å®‰å…¨ç®¡ç†ã€é›†ç¾¤ç®¡ç†ç­‰</p></li><li><p>SQLæ¥å£ï¼ˆSQL Interfaceï¼‰ï¼šç”¨äºæ¥å—å®¢æˆ·ç«¯å‘é€çš„å„ç§SQLå‘½ä»¤ï¼Œå¹¶ä¸”è¿”å›ç”¨æˆ·éœ€è¦æŸ¥è¯¢çš„ç»“æœã€‚æ¯”å¦‚DMLã€DDLã€å­˜å‚¨è¿‡ç¨‹ã€è§†å›¾ã€è§¦å‘å™¨ç­‰ã€‚</p></li><li><p>è§£æå™¨ï¼ˆParserï¼‰ï¼šè´Ÿè´£å°†è¯·æ±‚çš„SQLè§£æç”Ÿæˆä¸€ä¸ª&quot;è§£ææ ‘&quot;ã€‚ç„¶åæ ¹æ®ä¸€äº›MySQLè§„åˆ™è¿›ä¸€æ­¥æ£€æŸ¥è§£ææ ‘æ˜¯å¦åˆæ³•ã€‚</p></li><li><p>æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰ï¼šå½“â€œè§£ææ ‘â€é€šè¿‡è§£æå™¨è¯­æ³•æ£€æŸ¥åï¼Œå°†äº¤ç”±ä¼˜åŒ–å™¨å°†å…¶è½¬åŒ–æˆæ‰§è¡Œè®¡åˆ’ï¼Œç„¶åä¸å­˜å‚¨å¼•æ“äº¤äº’ã€‚</p></li><li><p>ç¼“å­˜ï¼ˆCache&amp;Bufferï¼‰ï¼š ç¼“å­˜æœºåˆ¶æ˜¯ç”±ä¸€ç³»åˆ—å°ç¼“å­˜ç»„æˆçš„ã€‚æ¯”å¦‚è¡¨ç¼“å­˜ï¼Œè®°å½•ç¼“å­˜ï¼Œæƒé™ç¼“å­˜ï¼Œå¼•æ“ç¼“å­˜ç­‰ã€‚å¦‚æœæŸ¥è¯¢ç¼“å­˜æœ‰å‘½ä¸­çš„æŸ¥è¯¢ç»“æœï¼ŒæŸ¥è¯¢è¯­å¥å°±å¯ä»¥ç›´æ¥å»æŸ¥è¯¢ç¼“å­˜ä¸­å–æ•°æ®ã€‚</p></li></ul><h3 id="file-system" tabindex="-1"><a class="header-anchor" href="#file-system"><span>File System</span></a></h3><ul><li><p>pid æ–‡ä»¶: pid æ–‡ä»¶æ˜¯ <code>mysqld</code> åº”ç”¨ç¨‹åºåœ¨ Unix/Linux ç¯å¢ƒä¸‹çš„ä¸€ä¸ªè¿›ç¨‹æ–‡ä»¶ï¼Œå’Œè®¸å¤šå…¶ä»– Unix/Linux æœåŠ¡ç«¯ç¨‹åºä¸€æ ·ï¼Œå®ƒå­˜æ”¾ç€è‡ªå·±çš„è¿›ç¨‹ id</p></li><li><p>socket æ–‡ä»¶: socket æ–‡ä»¶ä¹Ÿæ˜¯åœ¨ Unix/Linux ç¯å¢ƒä¸‹æ‰æœ‰çš„ï¼Œç”¨æˆ·åœ¨ Unix/Linux ç¯å¢ƒä¸‹å®¢æˆ·ç«¯è¿æ¥å¯ä»¥ä¸é€šè¿‡<code>TCP/IP</code> ç½‘ç»œè€Œç›´æ¥ä½¿ç”¨ Unix Socket æ¥è¿æ¥ MySQLã€‚</p></li><li><p><strong>é…ç½®æ–‡ä»¶</strong>: ç”¨äºå­˜æ”¾MySQLæ‰€æœ‰çš„é…ç½®ä¿¡æ¯æ–‡ä»¶ï¼Œæ¯”å¦‚my.cnfã€my.iniç­‰ã€‚</p></li><li><p><strong>æ•°æ®æ–‡ä»¶</strong></p><ul><li>db.opt æ–‡ä»¶ï¼šè®°å½•è¿™ä¸ªåº“çš„é»˜è®¤ä½¿ç”¨çš„å­—ç¬¦é›†å’Œæ ¡éªŒè§„åˆ™ã€‚</li><li>frm æ–‡ä»¶ï¼šå­˜å‚¨ä¸è¡¨ç›¸å…³çš„å…ƒæ•°æ®ï¼ˆmetaï¼‰ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„çš„å®šä¹‰ä¿¡æ¯ç­‰ï¼Œæ¯ä¸€å¼ è¡¨éƒ½ä¼šæœ‰ä¸€ä¸ª<code>frm</code> æ–‡ä»¶ã€‚</li><li>MYD æ–‡ä»¶ï¼šMyISAM å­˜å‚¨å¼•æ“ä¸“ç”¨ï¼Œå­˜æ”¾ MyISAM è¡¨çš„æ•°æ®ï¼ˆdata)ï¼Œæ¯ä¸€å¼ è¡¨éƒ½ä¼šæœ‰ä¸€ä¸ª<code>.MYD</code> æ–‡ä»¶ã€‚</li><li>MYI æ–‡ä»¶ï¼šMyISAM å­˜å‚¨å¼•æ“ä¸“ç”¨ï¼Œå­˜æ”¾ MyISAM è¡¨çš„ç´¢å¼•ç›¸å…³ä¿¡æ¯ï¼Œæ¯ä¸€å¼  MyISAM è¡¨å¯¹åº”ä¸€ä¸ª <code>.MYI</code> æ–‡ä»¶ã€‚</li><li>ibdæ–‡ä»¶å’Œ IBDATA æ–‡ä»¶ï¼šå­˜æ”¾ InnoDB çš„æ•°æ®æ–‡ä»¶ï¼ˆåŒ…æ‹¬ç´¢å¼•ï¼‰ã€‚InnoDB å­˜å‚¨å¼•æ“æœ‰ä¸¤ç§è¡¨ç©ºé—´æ–¹å¼ï¼šç‹¬äº«è¡¨ç©ºé—´å’Œå…±äº«è¡¨ç©ºé—´ã€‚ç‹¬äº«è¡¨ç©ºé—´ä½¿ç”¨ <code>.ibd</code> æ–‡ä»¶æ¥å­˜æ”¾æ•°æ®ï¼Œä¸”æ¯ä¸€å¼ InnoDB è¡¨å¯¹åº”ä¸€ä¸ª <code>.ibd</code> æ–‡ä»¶ã€‚å…±äº«è¡¨ç©ºé—´ä½¿ç”¨ <code>.ibdata</code> æ–‡ä»¶ï¼Œæ‰€æœ‰è¡¨å…±åŒä½¿ç”¨ä¸€ä¸ªï¼ˆæˆ–å¤šä¸ªï¼Œè‡ªè¡Œé…ç½®ï¼‰<code>.ibdata</code> æ–‡ä»¶ã€‚</li><li>ibdata1 æ–‡ä»¶ï¼šç³»ç»Ÿè¡¨ç©ºé—´æ•°æ®æ–‡ä»¶ï¼Œå­˜å‚¨è¡¨å…ƒæ•°æ®ã€Undoæ—¥å¿—ç­‰ ã€‚</li><li><code>ib_logfile0</code>ã€<code>ib_logfile1</code> æ–‡ä»¶ï¼šRedo log æ—¥å¿—æ–‡ä»¶ã€‚</li></ul></li><li><p><strong>æ—¥å¿—æ–‡ä»¶</strong>ï¼šäºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinary Logï¼‰ã€æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆSlow query logï¼‰ã€é€šç”¨æŸ¥è¯¢æ—¥å¿—ï¼ˆGeneral query logï¼‰å’Œé”™è¯¯æ—¥å¿—ï¼ˆError logï¼‰ç­‰ã€‚</p></li></ul><h2 id="innodbå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#innodbå­˜å‚¨å¼•æ“"><span>Innodbå­˜å‚¨å¼•æ“</span></a></h2><p>ä»MySQL 5.5ç‰ˆæœ¬å¼€å§‹é»˜è®¤ä½¿ç”¨InnoDBä½œä¸ºå¼•æ“ï¼Œå®ƒæ“…é•¿å¤„ç†äº‹åŠ¡ï¼Œå…·æœ‰è‡ªåŠ¨å´©æºƒæ¢å¤çš„ç‰¹æ€§ï¼Œåœ¨æ—¥å¸¸å¼€å‘ä¸­ä½¿ç”¨éå¸¸å¹¿æ³›ã€‚</p><h3 id="architecture" tabindex="-1"><a class="header-anchor" href="#architecture"><span>Architecture</span></a></h3><p>ä¸‹é¢æ˜¯å®˜æ–¹çš„<a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-architecture.html" target="_blank" rel="noopener noreferrer">InnoDBå¼•æ“æ¶æ„å›¾(MySQL5.7)</a>ï¼Œ<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-architecture.html" target="_blank" rel="noopener noreferrer">MySQL8</a>åœ¨ç£ç›˜ç»“æ„æ–¹é¢æœ‰æ‰€ä¸åŒã€‚</p><figure><img src="https://dev.mysql.com/doc/refman/5.7/en/images/innodb-architecture-5-7.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>Innodbå­˜å‚¨ç»“æ„ä¸»è¦åˆ†ä¸ºå†…å­˜ç»“æ„å’Œç£ç›˜ç»“æ„ä¸¤å¤§éƒ¨åˆ†</p><ul><li><p>å†…å­˜ç»“æ„ä¸»è¦åŒ…æ‹¬<code>Buffer Pool</code>ã€<code>Change Buffer</code>ã€<code>Adaptive Hash Index</code>å’Œ<code>Log Buffer</code></p></li><li><p>InnoDBç£ç›˜ä¸»è¦åŒ…å«<code>Tablespaces</code>ï¼Œ<code>InnoDB Data Dictionary</code>ï¼Œ<code>Doublewrite Buffer</code>ã€<code>Redo Log</code>å’Œ<code>Undo Logs</code></p></li></ul><h3 id="buffer-pool" tabindex="-1"><a class="header-anchor" href="#buffer-pool"><span>Buffer Pool</span></a></h3><p>Buffer Poolï¼šç¼“å†²æ± ï¼Œç®€ç§°BPã€‚BPä»¥<code>Page</code>é¡µä¸ºå•ä½ï¼ŒBPçš„åº•å±‚é‡‡ç”¨é“¾è¡¨æ•°æ®ç»“æ„ç®¡ç†Pageã€‚è®¿é—®è¡¨è®°å½•å’Œç´¢å¼•æ—¶ä¼šåœ¨Pageé¡µä¸­ç¼“å­˜ï¼Œä»¥åä½¿ç”¨å¯ä»¥å‡å°‘ç£ç›˜IOæ“ä½œï¼Œæå‡æ•ˆç‡</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;innodb_buffer_pool_size&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨èè®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„ 70% åˆ° 80%</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> global</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> innodb_buffer_pool_size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 256</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1024</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># MySQL5.7å¼€å§‹å¯ä»¥åœ¨çº¿åŠ¨æ€è°ƒæ•´</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">Pageç®¡ç†æœºåˆ¶</p><p>ç¼“å†²æ± ä»¥Pageé¡µä¸ºå•ä½ï¼Œ<mark>é»˜è®¤å¤§å°16K</mark>ï¼Œåº•å±‚é‡‡ç”¨é“¾è¡¨æ•°æ®ç»“æ„ç®¡ç†Pageã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%innodb_page_size%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹pageé¡µå¤§å°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ ¹æ®çŠ¶æ€ï¼Œå°†Pageåˆ†ä¸ºä¸‰ç§ç±»å‹:</p><ul><li>free page: ç©ºé—²pageï¼Œæœªè¢«ä½¿ç”¨ã€‚</li><li>clean page: æœªè¢«ä½¿ç”¨pageï¼Œæ•°æ®æ²¡æœ‰è¢«ä¿®æ”¹è¿‡</li><li><mark>dirty page: è„é¡µ</mark>ï¼Œè¢«ä½¿ç”¨pageï¼Œæ•°æ®è¢«ä¿®æ”¹è¿‡ï¼Œå†…å­˜æ•°æ®ä¸ç£ç›˜çš„æ•°æ®äº§ç”Ÿäº†ä¸ä¸€è‡´ã€‚</li></ul><p>é’ˆå¯¹ä¸Šè¿°ä¸‰ç§pageç±»å‹ï¼ŒInnoDBé€šè¿‡ä¸‰ç§é“¾è¡¨ç»“æ„æ¥ç»´æŠ¤å’Œç®¡ç†</p><ul><li>free list ï¼šè¡¨ç¤ºç©ºé—²ç¼“å†²åŒºï¼Œç®¡ç†free page</li><li>flush listï¼šè¡¨ç¤ºéœ€è¦åˆ·æ–°åˆ°ç£ç›˜çš„ç¼“å†²åŒºï¼Œç®¡ç†dirty pageï¼Œå†…éƒ¨pageæŒ‰ä¿®æ”¹æ—¶é—´æ’åºã€‚</li><li><mark>lru list</mark>ï¼šè¡¨ç¤ºæ­£åœ¨ä½¿ç”¨çš„ç¼“å†²åŒºï¼Œç®¡ç†<code>clean page</code>å’Œ<code>dirty page</code>ï¼Œç¼“å†²åŒºä»¥<code>midpoint</code>ä¸ºåŸºç‚¹ï¼Œå‰é¢é“¾è¡¨ç§°ä¸ºnewåˆ—è¡¨åŒºï¼Œå­˜æ”¾ç»å¸¸è®¿é—®çš„æ•°æ®ï¼Œå 63%ï¼›åé¢çš„é“¾è¡¨ç§°ä¸ºoldåˆ—è¡¨åŒºï¼Œå­˜æ”¾ä½¿ç”¨è¾ƒå°‘æ•°æ®ï¼Œå 37%ã€‚ ï¼ˆLRUï¼šleast recently used algorithmï¼‰</li></ul><p>è„é¡µå³å­˜åœ¨äºflushé“¾è¡¨ï¼Œä¹Ÿåœ¨LRUé“¾è¡¨ä¸­ï¼Œä½†æ˜¯ä¸¤ç§äº’ä¸å½±å“ï¼ŒLRUé“¾è¡¨è´Ÿè´£ç®¡ç†pageçš„å¯ç”¨æ€§å’Œé‡Šæ”¾ï¼Œè€Œflushé“¾è¡¨è´Ÿè´£ç®¡ç†è„é¡µçš„åˆ·ç›˜æ“ä½œã€‚</p></div><p>ç¼“å†²æ± ä½œä¸ºä¸€ä¸ªåˆ—è¡¨è¿›è¡Œç®¡ç†ï¼Œä½¿ç”¨äº†ä¸€ç§å˜ä½“çš„ LRU ç®—æ³• --&gt;<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-buffer-pool.html" target="_blank" rel="noopener noreferrer">a variation of the LRU algorithm</a></p><figure><img src="https://image.ventix.top/img02/20220118130345103.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åŠ å…¥å…ƒç´ æ—¶å¹¶ä¸æ˜¯ä»è¡¨å¤´æ’å…¥ï¼Œè€Œæ˜¯ä»ä¸­é—´<code>midpoint</code>ä½ç½®æ’å…¥ï¼Œå¦‚æœæ•°æ®å¾ˆå¿«è¢«è®¿é—®ï¼Œé‚£ä¹ˆpageå°±ä¼šå‘newåˆ—è¡¨å¤´éƒ¨ç§»åŠ¨ï¼Œå¦‚æœæ•°æ®æ²¡æœ‰è¢«è®¿é—®ï¼Œä¼šé€æ­¥å‘oldå°¾éƒ¨ç§»åŠ¨ï¼Œç­‰å¾…æ·˜æ±°ã€‚</p><p>æ¯å½“æœ‰æ–°çš„pageæ•°æ®è¯»å–åˆ°buffer poolæ—¶ï¼ŒInnoDbå¼•æ“ä¼šåˆ¤æ–­æ˜¯å¦æœ‰ç©ºé—²é¡µï¼Œæ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœæœ‰å°±å°†free pageä»free liståˆ—è¡¨åˆ é™¤ï¼Œæ”¾å…¥åˆ°LRUåˆ—è¡¨ä¸­ã€‚æ²¡æœ‰ç©ºé—²é¡µï¼Œå°±ä¼šæ ¹æ®LRUç®—æ³•æ·˜æ±°LRUé“¾è¡¨é»˜è®¤çš„é¡µï¼Œå°†å†…å­˜ç©ºé—´é‡Šæ”¾åˆ†é…ç»™æ–°çš„é¡µã€‚</p><h3 id="change-buffer" tabindex="-1"><a class="header-anchor" href="#change-buffer"><span>Change Buffer</span></a></h3><p>Change Bufferï¼šå†™ç¼“å†²åŒºã€‚åœ¨è¿›è¡ŒDMLæ“ä½œæ—¶ï¼Œå¦‚æœBPæ²¡æœ‰å…¶ç›¸åº”çš„Pageæ•°æ®ï¼Œå¹¶ä¸ä¼šç«‹åˆ»å°†ç£ç›˜é¡µåŠ è½½åˆ°ç¼“å†²æ± ï¼Œè€Œæ˜¯åœ¨CBè®°å½•ç¼“å†²å˜æ›´ï¼Œç­‰æœªæ¥æ•°æ®è¢«è¯»å–æ—¶ï¼Œå†å°†æ•°æ®åˆå¹¶æ¢å¤åˆ°BPä¸­ã€‚</p><p>ChangeBufferå ç”¨BufferPoolç©ºé—´ï¼Œé»˜è®¤å <code>25%</code>ï¼Œæœ€å¤§å…è®¸å <code>50%</code>ï¼Œå¯ä»¥æ ¹æ®è¯»å†™ä¸šåŠ¡é‡æ¥è¿›è¡Œè°ƒæ•´ã€‚å‚æ•°<code>innodb_change_buffer_max_size</code>;</p><div class="hint-container warning"><p class="hint-container-title">å†™ç¼“å†²åŒºä¸ºä»€ä¹ˆä»…é€‚ç”¨äºéå”¯ä¸€æ™®é€šç´¢å¼•é¡µ</p><p>å¦‚æœç´¢å¼•å…·å¤‡å”¯ä¸€æ€§ï¼Œåœ¨è¿›è¡Œä¿®æ”¹æ—¶ï¼ŒInnoDBå¿…é¡»è¦åš<code>å”¯ä¸€æ€§æ ¡éªŒ</code>ï¼Œå› æ­¤å¿…é¡»æŸ¥è¯¢ç£ç›˜ï¼Œåšä¸€æ¬¡IOæ“ä½œã€‚ä¼šç›´æ¥å°†è®°å½•æŸ¥è¯¢åˆ°BufferPoolä¸­ï¼Œç„¶ååœ¨ç¼“å†²æ± ä¿®æ”¹ï¼Œä¸ä¼šåœ¨ChangeBufferæ“ä½œã€‚</p></div><p>Adaptive Hash Indexï¼šè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ï¼Œç”¨äºä¼˜åŒ–å¯¹BPæ•°æ®çš„æŸ¥è¯¢ã€‚InnoDBå­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ç´¢å¼•çš„æŸ¥æ‰¾ï¼Œå¦‚æœè§‚å¯Ÿåˆ°å»ºç«‹å“ˆå¸Œç´¢å¼•å¯ä»¥å¸¦æ¥é€Ÿåº¦çš„æå‡ï¼Œåˆ™å»ºç«‹å“ˆå¸Œç´¢å¼•ï¼Œæ‰€ä»¥ç§°ä¹‹ä¸ºè‡ªé€‚åº”ã€‚InnoDBå­˜å‚¨å¼•æ“ä¼šè‡ªåŠ¨æ ¹æ®è®¿é—®çš„é¢‘ç‡å’Œæ¨¡å¼æ¥ä¸ºæŸäº›é¡µå»ºç«‹å“ˆå¸Œç´¢å¼•ã€‚</p><h3 id="innodbæ–‡ä»¶å­˜å‚¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#innodbæ–‡ä»¶å­˜å‚¨ç»“æ„"><span>InnoDBæ–‡ä»¶å­˜å‚¨ç»“æ„</span></a></h3><h3 id="innodbæ–‡ä»¶å­˜å‚¨æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#innodbæ–‡ä»¶å­˜å‚¨æ ¼å¼"><span>InnoDBæ–‡ä»¶å­˜å‚¨æ ¼å¼</span></a></h3><h3 id="tablespaces" tabindex="-1"><a class="header-anchor" href="#tablespaces"><span>Tablespaces</span></a></h3><h2 id="selectæŸ¥è¯¢æµç¨‹" tabindex="-1"><a class="header-anchor" href="#selectæŸ¥è¯¢æµç¨‹"><span>SelectæŸ¥è¯¢æµç¨‹</span></a></h2><p>Selectæ‰§è¡Œæµç¨‹: ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</p><figure><img src="https://image.ventix.top/img02/20220115174918720.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æŸ¥è¯¢æ‰§è¡Œå¼•æ“è´Ÿè´£æ‰§è¡Œ SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ‰§è¡Œå¼•æ“ä¼šæ ¹æ® SQL è¯­å¥ä¸­è¡¨çš„å­˜å‚¨å¼•æ“ç±»å‹ï¼Œä»¥åŠå¯¹åº”çš„APIæ¥å£ä¸åº•å±‚å­˜å‚¨å¼•æ“ç¼“å­˜æˆ–è€…ç‰©ç†æ–‡ä»¶çš„äº¤äº’ï¼Œå¾—åˆ°æŸ¥è¯¢ç»“æœå¹¶è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>è‹¥å¼€å¯ç”¨æŸ¥è¯¢ç¼“å­˜ï¼Œè¿™æ—¶ä¼šå°†SQL è¯­å¥å’Œç»“æœå®Œæ•´åœ°ä¿å­˜åˆ°æŸ¥è¯¢ç¼“å­˜ï¼ˆCache&amp;Bufferï¼‰ä¸­ï¼Œä»¥åè‹¥æœ‰ç›¸åŒçš„ SQL è¯­å¥æ‰§è¡Œåˆ™ç›´æ¥è¿”å›ç»“æœã€‚</p><ul><li>å¦‚æœå¼€å¯äº†æŸ¥è¯¢ç¼“å­˜ï¼Œå…ˆå°†æŸ¥è¯¢ç»“æœåšç¼“å­˜æ“ä½œ</li><li>è¿”å›ç»“æœè¿‡å¤šï¼Œé‡‡ç”¨å¢é‡æ¨¡å¼è¿”å›</li></ul><h3 id="é€šè®¯æœºåˆ¶ä¸çº¿ç¨‹" tabindex="-1"><a class="header-anchor" href="#é€šè®¯æœºåˆ¶ä¸çº¿ç¨‹"><span>é€šè®¯æœºåˆ¶ä¸çº¿ç¨‹</span></a></h3><p>é€šè¿‡å®¢æˆ·ç«¯/æœåŠ¡å™¨é€šä¿¡åè®®ä¸MySQLå»ºç«‹è¿æ¥ï¼ˆConnectors&amp;Connection Poolï¼‰ã€‚MySQL å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„é€šä¿¡æ–¹å¼æ˜¯ <mark>åŠåŒå·¥</mark>ã€‚</p><div class="hint-container info"><p class="hint-container-title">é€šè®¯æœºåˆ¶</p><ul><li>å…¨åŒå·¥ï¼šèƒ½åŒæ—¶å‘é€å’Œæ¥æ”¶æ•°æ®ï¼Œä¾‹å¦‚å¹³æ—¶æ‰“ç”µè¯ã€‚</li><li>åŠåŒå·¥ï¼šæŒ‡çš„æŸä¸€æ—¶åˆ»ï¼Œè¦ä¹ˆå‘é€æ•°æ®ï¼Œè¦ä¹ˆæ¥æ”¶æ•°æ®ï¼Œä¸èƒ½åŒæ—¶ã€‚ä¾‹å¦‚æ—©æœŸå¯¹è®²æœº</li><li>å•å·¥ï¼šåªèƒ½å‘é€æ•°æ®æˆ–åªèƒ½æ¥æ”¶æ•°æ®ã€‚ä¾‹å¦‚å•è¡Œé“</li></ul></div><p>å¯¹äºæ¯ä¸€ä¸ª MySQL çš„è¿æ¥ï¼Œæ—¶åˆ»éƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹çŠ¶æ€æ¥æ ‡è¯†è¿™ä¸ªè¿æ¥æ­£åœ¨åšä»€ä¹ˆã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹ç”¨æˆ·æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ä¿¡æ¯ï¼Œrootç”¨æˆ·èƒ½æŸ¥çœ‹æ‰€æœ‰çº¿ç¨‹ï¼Œå…¶ä»–ç”¨æˆ·åªèƒ½çœ‹è‡ªå·±çš„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> processlist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+----+-----------------+-----------+------+---------+------+------------------------+------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">User</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Host</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">db</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">State</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                  | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">             |</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+----+-----------------+-----------+------+---------+------+------------------------+------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">event_scheduler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Daemon</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  |  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">139</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Waiting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> empty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> queue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">             |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|  </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">localhost</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Query</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   |    </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">init</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                   | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> processlist</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+----+-----------------+-----------+------+---------+------+------------------------+------------------+</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rows</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> set,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> warning</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0.00 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>idï¼šçº¿ç¨‹IDï¼Œå¯ä»¥ä½¿ç”¨ <code>kill xx;</code></li><li>userï¼šå¯åŠ¨è¿™ä¸ªçº¿ç¨‹çš„ç”¨æˆ·</li><li>Hostï¼šå‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯çš„IPå’Œç«¯å£å·</li><li>dbï¼šå½“å‰å‘½ä»¤åœ¨å“ªä¸ªåº“æ‰§è¡Œ</li><li>Commandï¼šè¯¥çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ“ä½œå‘½ä»¤ <ul><li>Create DBï¼šæ­£åœ¨åˆ›å»ºåº“æ“ä½œ</li><li>Drop DBï¼šæ­£åœ¨åˆ é™¤åº“æ“ä½œ</li><li>Executeï¼šæ­£åœ¨æ‰§è¡Œä¸€ä¸ªPreparedStatement</li><li>Close Stmtï¼šæ­£åœ¨å…³é—­ä¸€ä¸ªPreparedStatement</li><li>Queryï¼šæ­£åœ¨æ‰§è¡Œä¸€ä¸ªè¯­å¥</li><li>Sleepï¼šæ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€è¯­å¥</li><li>Quitï¼šæ­£åœ¨é€€å‡º</li><li>Shutdownï¼šæ­£åœ¨å…³é—­æœåŠ¡å™¨</li></ul></li><li>Timeï¼šè¡¨ç¤ºè¯¥çº¿ç¨‹å¤„äºå½“å‰çŠ¶æ€çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’</li><li>Stateï¼šçº¿ç¨‹çŠ¶æ€ <ul><li>Updatingï¼šæ­£åœ¨æœç´¢åŒ¹é…è®°å½•ï¼Œè¿›è¡Œä¿®æ”¹</li><li>Sleepingï¼šæ­£åœ¨ç­‰å¾…å®¢æˆ·ç«¯å‘é€æ–°è¯·æ±‚</li><li>Startingï¼šæ­£åœ¨æ‰§è¡Œè¯·æ±‚å¤„ç†</li><li>Checking tableï¼šæ­£åœ¨æ£€æŸ¥æ•°æ®è¡¨</li><li>Closing table : æ­£åœ¨å°†è¡¨ä¸­æ•°æ®åˆ·æ–°åˆ°ç£ç›˜ä¸­</li><li>Lockedï¼šè¢«å…¶ä»–æŸ¥è¯¢é”ä½äº†è®°å½•</li><li>Sending Dataï¼šæ­£åœ¨å¤„ç†SelectæŸ¥è¯¢ï¼ŒåŒæ—¶å°†ç»“æœå‘é€ç»™å®¢æˆ·ç«¯</li></ul></li><li>Infoï¼šä¸€èˆ¬è®°å½•çº¿ç¨‹æ‰§è¡Œçš„è¯­å¥ï¼Œé»˜è®¤æ˜¾ç¤ºå‰100ä¸ªå­—ç¬¦ã€‚æƒ³æŸ¥çœ‹å®Œæ•´çš„ä½¿ç”¨<code>show full processlist;</code></li></ul><p>æ›´å¤šä¿¡æ¯å‚ç…§ï¼š<a href="https://dev.mysql.com/doc/refman/8.0/en/show-processlist.html" target="_blank" rel="noopener noreferrer">MySQL8 show-processlist</a></p><h3 id="æŸ¥è¯¢ç¼“å­˜" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢ç¼“å­˜"><span>æŸ¥è¯¢ç¼“å­˜</span></a></h3><p>å¦‚æœå¼€å¯äº†æŸ¥è¯¢ç¼“å­˜ä¸”åœ¨æŸ¥è¯¢ç¼“å­˜è¿‡ç¨‹ä¸­æŸ¥è¯¢åˆ°å®Œå…¨ç›¸åŒçš„SQLè¯­å¥ï¼Œåˆ™å°†æŸ¥è¯¢ç»“æœç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼›å¦‚æœæ²¡æœ‰å¼€å¯æŸ¥è¯¢ç¼“å­˜æˆ–è€…æ²¡æœ‰æŸ¥è¯¢åˆ°å®Œå…¨ç›¸åŒçš„ SQL è¯­å¥åˆ™ä¼šç”±è§£æå™¨è¿›è¡Œè¯­æ³•è¯­ä¹‰è§£æï¼Œå¹¶ç”Ÿæˆâ€œè§£ææ ‘â€ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%query_cache%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹æŸ¥è¯¢ç¼“å­˜æ˜¯å¦å¯ç”¨ï¼Œç©ºé—´å¤§å°ï¼Œé™åˆ¶ç­‰</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Qcache%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æŸ¥çœ‹æ›´è¯¦ç»†çš„ç¼“å­˜å‚æ•°ï¼Œå¯ç”¨ç¼“å­˜ç©ºé—´ï¼Œç¼“å­˜å—ï¼Œç¼“å­˜å¤šå°‘ç­‰</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SET</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GLOBAL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> query_cache_type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DEMAND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¸å»ºè®®ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ–è€…å¯ä»¥åœ¨ MySQL çš„é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>my.cnf</code> æˆ– <code>my.ini</code>ï¼‰ä¸­è®¾ç½®ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[mysqld]  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">query_cache_type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DEMAND</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">MySQLç¼“å­˜çš„ä½œç”¨å’Œæ³¨æ„äº‹é¡¹</p><ul><li>ç¼“å­˜SelectæŸ¥è¯¢çš„ç»“æœå’ŒSQLè¯­å¥</li><li>æ‰§è¡ŒSelectæŸ¥è¯¢æ—¶ï¼Œå…ˆæŸ¥è¯¢ç¼“å­˜ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯ç”¨çš„è®°å½•é›†ï¼Œè¦æ±‚æ˜¯å¦å®Œå…¨ç›¸åŒï¼ˆåŒ…æ‹¬å‚æ•°å€¼ï¼‰ï¼Œè¿™æ ·æ‰ä¼šåŒ¹é…ç¼“å­˜æ•°æ®å‘½ä¸­ã€‚</li><li>å³ä½¿å¼€å¯æŸ¥è¯¢ç¼“å­˜ï¼Œä»¥ä¸‹æƒ…å½¢ä¹Ÿä¸èƒ½ç¼“å­˜ <ul><li>æŸ¥è¯¢è¯­å¥ä½¿ç”¨<code>SQL_NO_CACHE</code></li><li>æŸ¥è¯¢çš„ç»“æœå¤§äº <code>query_cache_limit</code>è®¾ç½®</li><li>æŸ¥è¯¢ä¸­æœ‰ä¸€äº›ä¸ç¡®å®šçš„å‚æ•°ï¼Œæ¯”å¦‚<code>now()</code></li></ul></li></ul></div><p>æ³¨æ„ï¼ŒMySQL 8.0 ç‰ˆæœ¬ç›´æ¥å°†æŸ¥è¯¢ç¼“å­˜çš„æ•´å—åŠŸèƒ½åˆ æ‰äº†ã€‚</p><div class="hint-container warning"><p class="hint-container-title">ä¸ºä»€ä¹ˆ MySQL8.0 ç‰ˆæœ¬ä¸­ç§»é™¤äº†æŸ¥è¯¢ç¼“å­˜åŠŸèƒ½</p><p>æŸ¥è¯¢ç¼“å­˜çš„åˆè¡·æ˜¯é€šè¿‡ç¼“å­˜å®Œæ•´çš„ SQL æŸ¥è¯¢ç»“æœæ¥åŠ é€Ÿç›¸åŒæŸ¥è¯¢çš„æ‰§è¡Œã€‚ä½†å…¶è®¾è®¡å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š</p><h4 id="_1-ç¼“å­˜ç²’åº¦è¿‡å¤§" tabindex="-1"><a class="header-anchor" href="#_1-ç¼“å­˜ç²’åº¦è¿‡å¤§"><span>ï¼ˆ1ï¼‰ç¼“å­˜ç²’åº¦è¿‡å¤§</span></a></h4><ul><li>æŸ¥è¯¢ç¼“å­˜å­˜å‚¨çš„æ˜¯<strong>å®Œæ•´çš„æŸ¥è¯¢ç»“æœ</strong>ï¼Œå¯¹åŒä¸€è¡¨çš„æ‰€æœ‰æŸ¥è¯¢æ“ä½œéƒ½æ²¡æœ‰åŒºåˆ†æ›´æ–°ç²’åº¦ã€‚</li><li>ä¸€æ—¦è¡¨ä¸­çš„æ•°æ®å‘ç”Ÿä»»ä½•ä¿®æ”¹ï¼ˆåŒ…æ‹¬ <code>INSERT</code>ã€<code>UPDATE</code>ã€<code>DELETE</code> ç­‰æ“ä½œï¼‰ï¼Œæ‰€æœ‰æ¶‰åŠè¯¥è¡¨çš„ç¼“å­˜ç»“æœéƒ½ä¼šå¤±æ•ˆï¼Œæ— è®ºä¿®æ”¹æ˜¯å¦å½±å“ç¼“å­˜ç»“æœã€‚è¿™ç§æœºåˆ¶åœ¨<strong>å†™æ“ä½œé¢‘ç¹</strong>çš„åœºæ™¯ä¸­ä½¿æŸ¥è¯¢ç¼“å­˜å‡ ä¹æ²¡æœ‰å‘½ä¸­ç‡ã€‚</li></ul><h4 id="_2-ç¼“å­˜å‘½ä¸­ç‡ä½" tabindex="-1"><a class="header-anchor" href="#_2-ç¼“å­˜å‘½ä¸­ç‡ä½"><span>ï¼ˆ2ï¼‰ç¼“å­˜å‘½ä¸­ç‡ä½</span></a></h4><ul><li>æŸ¥è¯¢ç¼“å­˜åªèƒ½å‘½ä¸­å®Œå…¨ç›¸åŒçš„ SQL æŸ¥è¯¢ï¼ˆåŒ…æ‹¬å¤§å°å†™ã€ç©ºæ ¼ç­‰ç»†å¾®å·®å¼‚ï¼‰ã€‚</li><li>å¦‚æœæŸ¥è¯¢å¸¦æœ‰åŠ¨æ€æ¡ä»¶ï¼ˆå¦‚æ—¶é—´æˆ³æˆ–éšæœºæ•°ï¼‰ï¼Œå‡ ä¹ä¸å¯èƒ½å‘½ä¸­ç¼“å­˜ã€‚</li></ul><h4 id="_3-æ›´æ–°å’Œç»´æŠ¤å¼€é”€é«˜" tabindex="-1"><a class="header-anchor" href="#_3-æ›´æ–°å’Œç»´æŠ¤å¼€é”€é«˜"><span>ï¼ˆ3ï¼‰æ›´æ–°å’Œç»´æŠ¤å¼€é”€é«˜</span></a></h4><ul><li>æŸ¥è¯¢ç¼“å­˜ä¸ä»…éœ€è¦å ç”¨å†…å­˜ï¼Œä¸”éœ€è¦åœ¨æ¯æ¬¡è¡¨æ›´æ–°æ—¶å¯¹ç›¸å…³ç¼“å­˜æ¡ç›®è¿›è¡Œæ¸…ç†ï¼Œè¿™ä¼šå¼•å…¥é¢å¤–çš„é”å¼€é”€ã€‚</li><li>åœ¨é«˜å¹¶å‘å†™å…¥åœºæ™¯ä¸­ï¼Œé¢‘ç¹çš„ç¼“å­˜å¤±æ•ˆå’Œæ¸…ç†æ“ä½œä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½ç“¶é¢ˆã€‚ä¸”é™åˆ¶äº†å…¶åœ¨å¤šæ ¸ CPU å’Œåˆ†å¸ƒå¼åœºæ™¯ä¸‹çš„æ‰©å±•æ€§ã€‚</li></ul><p>ç§»é™¤æŸ¥è¯¢ç¼“å­˜åï¼Œæ¨èä½¿ç”¨ <strong>InnoDB ç¼“å†²æ± </strong> å’Œ <strong>å¤–éƒ¨ç¼“å­˜ç³»ç»Ÿï¼ˆå¦‚ Redisï¼‰</strong> æ¥ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½ï¼Œä»¥æ»¡è¶³ç°ä»£åº”ç”¨çš„éœ€æ±‚ã€‚</p></div><h3 id="è§£æå™¨å’Œä¼˜åŒ–å™¨" tabindex="-1"><a class="header-anchor" href="#è§£æå™¨å’Œä¼˜åŒ–å™¨"><span>è§£æå™¨å’Œä¼˜åŒ–å™¨</span></a></h3><p><strong>è§£æå™¨ï¼ˆParserï¼‰</strong> å°†å®¢æˆ·ç«¯å‘é€çš„SQLè¿›è¡Œè¯­æ³•è§£æï¼Œç”Ÿæˆ <strong>&quot;è§£ææ ‘&quot;</strong>ã€‚ <mark>é¢„å¤„ç†å™¨</mark>æ ¹æ®ä¸€äº›MySQLè§„åˆ™è¿›ä¸€æ­¥æ£€æŸ¥â€œè§£ææ ‘â€æ˜¯å¦åˆæ³•ï¼Œä¾‹å¦‚è¿™é‡Œå°†æ£€æŸ¥æ•°æ®è¡¨å’Œæ•°æ®åˆ—æ˜¯å¦å­˜åœ¨ï¼Œè¿˜ä¼šè§£æåå­—å’Œåˆ«åï¼Œçœ‹çœ‹å®ƒä»¬æ˜¯å¦æœ‰æ­§ä¹‰ï¼Œæœ€åç”Ÿæˆ<mark>æ–°çš„â€œè§£ææ ‘â€</mark>ã€‚</p><p><strong>æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ˆOptimizerï¼‰</strong> æ ¹æ®â€œè§£ææ ‘â€ç”Ÿæˆæœ€ä¼˜çš„æ‰§è¡Œè®¡åˆ’ã€‚MySQLä½¿ç”¨å¾ˆå¤šä¼˜åŒ–ç­–ç•¥ç”Ÿæˆæœ€ä¼˜çš„æ‰§è¡Œè®¡åˆ’ï¼Œå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€ä¼˜åŒ–ï¼ˆç¼–è¯‘æ—¶ä¼˜åŒ–ï¼‰ã€åŠ¨æ€ä¼˜åŒ–ï¼ˆè¿è¡Œæ—¶ä¼˜åŒ–ï¼‰ã€‚</p><ul><li>ç­‰ä»·å˜æ¢ç­–ç•¥ <ul><li>5=5 and a&gt;5 æ”¹æˆ a &gt; 5</li><li>a &lt; b and a=5 æ”¹æˆb&gt;5 and a=5</li><li>åŸºäºè”åˆç´¢å¼•ï¼Œè°ƒæ•´æ¡ä»¶ä½ç½®ç­‰</li></ul></li><li>ä¼˜åŒ–countã€minã€maxç­‰å‡½æ•° <ul><li>InnoDBå¼•æ“minå‡½æ•°åªéœ€è¦æ‰¾ç´¢å¼•æœ€å·¦è¾¹</li><li>InnoDBå¼•æ“maxå‡½æ•°åªéœ€è¦æ‰¾ç´¢å¼•æœ€å³è¾¹</li><li>MyISAMå¼•æ“count(*)ï¼Œä¸éœ€è¦è®¡ç®—ï¼Œç›´æ¥è¿”å›</li></ul></li><li>æå‰ç»ˆæ­¢æŸ¥è¯¢: ä½¿ç”¨äº†limitæŸ¥è¯¢ï¼Œè·å–limitæ‰€éœ€çš„æ•°æ®ï¼Œå°±ä¸åœ¨ç»§ç»­éå†åé¢æ•°æ®</li><li>inçš„ä¼˜åŒ–: MySQLå¯¹inæŸ¥è¯¢ï¼Œä¼šå…ˆè¿›è¡Œæ’åºï¼Œå†é‡‡ç”¨äºŒåˆ†æ³•æŸ¥æ‰¾æ•°æ®ã€‚æ¯”å¦‚where id in (2,1,3)ï¼Œå˜æˆ in (1,2,3)</li></ul><h2 id="updateæµç¨‹ä¸æ—¥å¿—æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#updateæµç¨‹ä¸æ—¥å¿—æœºåˆ¶"><span>Updateæµç¨‹ä¸æ—¥å¿—æœºåˆ¶</span></a></h2><h3 id="walæŠ€æœ¯" tabindex="-1"><a class="header-anchor" href="#walæŠ€æœ¯"><span>WALæŠ€æœ¯</span></a></h3><p>ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰: æ˜¯ä¸»å†…å­˜ä¸­çš„ä¸€ä¸ªåŒºåŸŸï¼Œé‡Œé¢å¯ä»¥ç¼“å­˜ç£ç›˜ä¸Šç»å¸¸æ“ä½œçš„çœŸå®æ•°æ®ï¼Œåœ¨æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œæ—¶ï¼Œå…ˆæ“ä½œç¼“å†²æ± ä¸­çš„æ•°æ®(è‹¥ç¼“å†²æ± æ²¡æœ‰æ•°æ®ï¼Œåˆ™ä»ç£ç›˜åŠ è½½å¹¶ç¼“å­˜)ï¼Œç„¶åå†ä»¥ä¸€å®šé¢‘ç‡åˆ·æ–°åˆ°ç£ç›˜ï¼Œä»è€Œå‡å°‘ç£ç›˜IOï¼ŒåŠ å¿«å¤„ç†é€Ÿåº¦ã€‚</p><p>å¦‚æœç¼“å­˜çš„å†…å®¹æ›´æ–°å¥½äº†ï¼Œä½†ç£ç›˜çš„å†…å®¹è¿˜æ˜¯æ—§çš„ï¼Œä½•æ—¶æ›´æ–°åˆ°ç£ç›˜å‘¢ï¼Ÿå¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§å‘¢ï¼Ÿ</p><div class="hint-container warning"><p class="hint-container-title">WALï¼ˆWrite-Ahead Loggingï¼‰</p><p><strong>WAL æŠ€æœ¯ï¼šå…ˆå†™æ—¥å¿—ï¼Œå†åˆ·å…¥ç£ç›˜</strong>ã€‚ä¿è¯æ¯ä¸ªæ›´æ–°è¯·æ±‚éƒ½æ˜¯æ›´æ–°å†…å­˜<code>Buffer Pool</code>ï¼Œç„¶å<mark>é¡ºåºå†™æ—¥å¿—æ–‡ä»¶</mark>ï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯å„ç§å¼‚å¸¸æƒ…å†µä¸‹çš„æ•°æ®ä¸€è‡´æ€§ã€‚</p><ul><li>å…ˆå†™æ—¥å¿—ï¼šè®°å½• <code>undo log</code> å’Œ <code>Redo Log</code>æ—¥å¿—æ–‡ä»¶ï¼ˆé¡ºåºå†™ï¼‰ <ul><li>redo logç§°ä¸ºé‡åšæ—¥å¿—ï¼Œæ¯å½“æœ‰æ“ä½œæ—¶ï¼Œåœ¨æ•°æ®å˜æ›´ä¹‹å‰å°†æ“ä½œå†™å…¥redo logï¼Œè¿™æ ·å½“å‘ç”Ÿæ‰ç”µä¹‹ç±»çš„æƒ…å†µæ—¶ç³»ç»Ÿå¯ä»¥åœ¨é‡å¯åç»§ç»­æ“ä½œã€‚ï¼ˆäº‹åŠ¡çš„æŒä¹…æ€§ï¼‰</li><li>undo logåˆç§°ä¸ºæ’¤é”€æ—¥å¿—ï¼Œå½“ä¸€äº›å˜æ›´æ‰§è¡Œåˆ°ä¸€åŠæ— æ³•å®Œæˆæ—¶ï¼Œå¯ä»¥æ ¹æ®æ’¤é”€æ—¥å¿—æ¢å¤åˆ°å˜æ›´ä¹‹é—´çš„çŠ¶æ€ã€‚(äº‹åŠ¡çš„åŸå­æ€§)</li></ul></li><li>å†åˆ·å…¥ç£ç›˜ï¼šå°†<code>Buffer Pool</code>ä¸­çš„è„é¡µå†™å…¥ç£ç›˜ï¼ˆéšæœºå†™ï¼‰</li></ul></div><p>ä¸ºä»€ä¹ˆMysqlä¸èƒ½ç›´æ¥æ›´æ–°ç£ç›˜ä¸Šçš„æ•°æ®, è€Œè®¾ç½®è¿™ä¹ˆä¸€å¥—å¤æ‚çš„æœºåˆ¶æ¥æ‰§è¡ŒSQLäº†ï¼Ÿ</p><ul><li>InnoDBæ˜¯ä»¥é¡µä¸ºå•ä½æ¥è¿›è¡Œç£ç›˜IOçš„, ä¸€ä¸ªå¾®å°çš„æ›´æ–°å°±åˆ·æ–°ä¸€ä¸ªå®Œæ•´çš„æ•°æ®é¡µåˆ°ç£ç›˜å¤ªæµªè´¹äº†</li><li>éšæœºIOåˆ·èµ·æ¥æ¯”è¾ƒæ…¢, Redo Log çš„é¡ºåºå†™å‡å°‘äº†éšæœº I/Oï¼Œå¯¹ä¼ ç»Ÿæœºæ¢°ç¡¬ç›˜æ€§èƒ½æå‡æ˜¾è‘—ã€‚</li></ul><h3 id="updateæ›´æ–°æµç¨‹" tabindex="-1"><a class="header-anchor" href="#updateæ›´æ–°æµç¨‹"><span>Updateæ›´æ–°æµç¨‹</span></a></h3><p>æ›´æ–°è¯­å¥ä¸ä½†éœ€è¦å…ˆæŸ¥è¯¢ï¼Œä¸”åœ¨æ›´æ–°æ‰§è¡Œæµç¨‹ä¸­ï¼Œ<strong>æ—¥å¿—çš„å†™å…¥</strong>å’Œ<strong>ä¸¤é˜¶æ®µæäº¤æœºåˆ¶</strong>è‡³å…³é‡è¦ï¼Œå®ƒä»¬ç¡®ä¿äº†äº‹åŠ¡çš„æŒä¹…æ€§å’Œä¸€è‡´æ€§ã€‚</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> where</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol><li><p><strong>åŠ è½½æ•°æ®é¡µåˆ°ç¼“å†²æ± ï¼ˆBuffer Poolï¼‰ï¼š</strong> æ ¹æ®æ›´æ–°æ¡ä»¶æŸ¥æ‰¾ç›®æ ‡è®°å½•ã€‚</p><ul><li>å¦‚æœç›®æ ‡è®°å½•æ‰€åœ¨çš„æ•°æ®é¡µä¸åœ¨ç¼“å†²æ± ä¸­ï¼Œä»ç£ç›˜åŠ è½½åˆ°ç¼“å†²æ± ã€‚</li><li>å¦‚æœå·²ç»åœ¨ç¼“å†²æ± ä¸­ï¼Œåˆ™ç›´æ¥æ“ä½œã€‚</li><li>ç›®æ ‡è®°å½•æ‰€åœ¨çš„æ•°æ®é¡µè¢«åŠ é”ï¼ˆå¦‚è¡Œé”æˆ–é—´éš™é”ï¼Œå…·ä½“å–å†³äºäº‹åŠ¡éš”ç¦»çº§åˆ«ï¼‰ã€‚</li></ul></li><li><p><strong>è®°å½• Undo Logï¼ˆç”¨äºå›æ»šå’Œ MVCCï¼‰ï¼š</strong> åœ¨å¯¹è®°å½•è¿›è¡Œæ›´æ–°ä¹‹å‰ï¼Œç”Ÿæˆ Undo Log å¹¶å­˜å‚¨åœ¨<strong>å›æ»šæ®µ</strong>ä¸­ï¼Œè®°å½•è¢«ä¿®æ”¹å‰çš„æ—§å€¼ã€‚Undo Log ç”¨äºæ”¯æŒ <code>äº‹åŠ¡å›æ»šï¼ˆå›é€€åˆ°åŸå§‹çŠ¶æ€ï¼‰</code> å’Œ <code>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰çš„ä¸€è‡´æ€§è¯»</code>ã€‚</p></li><li><p><strong>æ›´æ–°ç¼“å†²æ± ä¸­çš„æ•°æ®ï¼š</strong> ä¿®æ”¹ç¼“å†²æ± ä¸­çš„ç›®æ ‡æ•°æ®é¡µï¼Œå°†æ•°æ®æ ‡è®°ä¸ºâ€œè„é¡µâ€ï¼ˆDirty Pageï¼‰ã€‚ æ•°æ®å°šæœªåŒæ­¥åˆ°ç£ç›˜ï¼Œåªæ˜¯æ›´æ–°äº†å†…å­˜ä¸­çš„ç¼“å­˜ã€‚</p></li><li><p><strong>è®°å½• Redo Logï¼ˆæ—¥å¿—ç¼“å†²åŒºï¼‰ï¼š</strong> å°†æ›´æ–°æ“ä½œå†™å…¥ <strong>Redo Log Buffer</strong>ï¼ˆå†…å­˜ä¸­çš„æ—¥å¿—ç¼“å†²åŒºï¼‰ï¼Œä»¥ç‰©ç†æ—¥å¿—çš„å½¢å¼è®°å½•â€œå¯¹å“ªäº›æ•°æ®é¡µè¿›è¡Œäº†å“ªäº›æ›´æ”¹â€ã€‚Redo Log Buffer ä¸ä¼šç«‹å³å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯ç”±ä»¥ä¸‹è§„åˆ™è§¦å‘å†™å…¥ï¼š</p><ul><li>å½“äº‹åŠ¡è¿›å…¥ <strong>Prepare é˜¶æ®µ</strong>ã€‚</li><li>å½“ Redo Log Buffer çš„ä½¿ç”¨é‡è¾¾åˆ°é˜ˆå€¼ï¼ˆç”± <code>innodb_log_buffer_size</code> æ§åˆ¶ï¼‰ã€‚</li><li>æ¯ç§’çš„åå°åˆ·æ–°ï¼ˆé»˜è®¤ç”± <code>innodb_flush_log_at_trx_commit</code> å‚æ•°æ§åˆ¶ï¼‰ã€‚</li></ul></li><li><p><strong>Redo Log çš„ Prepare é˜¶æ®µï¼š</strong> Redo Log Buffer çš„å†…å®¹è¢«<strong>é¡ºåºå†™å…¥ç£ç›˜ï¼ˆRedo Log æ–‡ä»¶ï¼‰</strong>ï¼Œå¹¶æ ‡è®°ä¸ºâ€œPrepareâ€çŠ¶æ€ã€‚ æ­¤é˜¶æ®µçš„å…³é”®ç‚¹ï¼š</p><ul><li><strong>ç¡®ä¿æ•°æ®çš„æŒä¹…æ€§</strong>ï¼šä¸€æ—¦ç³»ç»Ÿå´©æºƒï¼ŒRedo Log ä¸­çš„è®°å½•å¯ä»¥ç”¨æ¥æ¢å¤åˆ° Prepare é˜¶æ®µçš„çŠ¶æ€ã€‚</li><li>äº‹åŠ¡å°šæœªæäº¤ï¼Œå¯¹å¤–ä»ä¸å¯è§ã€‚</li></ul></li><li><p><strong>è®°å½• Binlogï¼ˆé€»è¾‘æ—¥å¿—ï¼‰ï¼š</strong> Server å±‚ç”Ÿæˆ Binlog æ—¥å¿—ï¼ˆé€»è¾‘æ—¥å¿—ï¼‰ï¼Œè®°å½• SQL è¯­å¥çš„æ“ä½œã€‚ Binlog è¢«å†™å…¥ Binlog Bufferï¼ˆæ—¥å¿—ç¼“å†²åŒºï¼‰ï¼Œç„¶åæŒ‰ç…§äº‹åŠ¡æäº¤æ—¶çš„ç­–ç•¥ï¼ˆ<code>sync_binlog</code> å‚æ•°ï¼‰å†³å®šæ˜¯å¦åŒæ­¥åˆ°ç£ç›˜ã€‚</p><ul><li><code>sync_binlog=1</code>ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶å°† Binlog ä»ç¼“å†²åŒºåˆ·åˆ°ç£ç›˜ï¼Œç¡®ä¿æŒä¹…æ€§ã€‚</li><li><code>sync_binlog&gt;1</code>ï¼šå»¶è¿ŸåŒæ­¥ï¼Œå¯èƒ½ä¸¢å¤±éƒ¨åˆ† Binlogã€‚</li></ul></li><li><p><strong>Redo Log çš„ Commit é˜¶æ®µï¼š</strong> äº‹åŠ¡è¿›å…¥ Commit é˜¶æ®µï¼ŒRedo Log æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸ª<strong>Commit æ ‡è®°</strong>ã€‚Commit æ ‡è®°è¡¨ç¤ºäº‹åŠ¡æäº¤å®Œæˆï¼Œæ•°æ®å¯¹å¤–å¯è§ã€‚Redo Log çš„ Commit æ ‡è®°åŒæ­¥åˆ°ç£ç›˜åï¼Œäº‹åŠ¡æ‰ç®—çœŸæ­£å®Œæˆã€‚</p></li><li><p><strong>æ•°æ®æœ€ç»ˆå†™å…¥ç£ç›˜ï¼ˆåˆ·è„é¡µï¼‰ï¼š</strong> æ›´æ–°æ“ä½œåªä¿®æ”¹ç¼“å†²æ± ä¸­çš„æ•°æ®é¡µï¼Œå®é™…æ•°æ®é¡µçš„å†™å…¥ç”±åå°çº¿ç¨‹å®Œæˆï¼ˆå¼‚æ­¥æ“ä½œï¼‰ã€‚ è„é¡µåˆ·ç›˜çš„è§¦å‘æ¡ä»¶ï¼š</p><ul><li>ç¼“å†²æ± ä½¿ç”¨ç‡è¾¾åˆ°é˜ˆå€¼ï¼ˆç”± <code>innodb_max_dirty_pages_pct</code> æ§åˆ¶ï¼‰ã€‚</li><li>Redo Log çš„ç©ºé—´ä¸è¶³ã€‚</li><li>æ‰‹åŠ¨è§¦å‘ï¼ˆå¦‚æ‰§è¡Œ <code>FLUSH</code> æ“ä½œï¼‰ã€‚</li></ul></li></ol><h3 id="ä¸¤é˜¶æ®µæäº¤-å†…éƒ¨xa" tabindex="-1"><a class="header-anchor" href="#ä¸¤é˜¶æ®µæäº¤-å†…éƒ¨xa"><span>ä¸¤é˜¶æ®µæäº¤(å†…éƒ¨XA)</span></a></h3><p>ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰åœ¨ Redo Log å’Œ Binlog çš„åè°ƒä¸­èµ·åˆ°æ ¸å¿ƒä½œç”¨ï¼Œç¡®ä¿ä¸¤è€…ä¸€è‡´æ€§ã€‚</p><ol><li><strong>Prepare é˜¶æ®µï¼š</strong> Redo Log çš„ Prepare çŠ¶æ€åœ¨ Binlog å†™å…¥ä¹‹å‰å®Œæˆã€‚ å³ä½¿ç³»ç»Ÿå´©æºƒï¼Œåªè¦æœ‰ Redo Log çš„ Prepare æ—¥å¿—ï¼Œæ•°æ®ä»å¯ä»¥æ¢å¤åˆ°ä¸€è‡´æ€§çŠ¶æ€ã€‚</li></ol><div class="hint-container important"><p class="hint-container-title">XAäº‹åŠ¡--extra disk flush for transaction preparation</p><p>MySQLå®˜æ–¹æ–‡æ¡£æ˜ç¡®æŒ‡å‡ºäº†åœ¨ XA äº‹åŠ¡çš„ä¸¤é˜¶æ®µæäº¤è¿‡ç¨‹ä¸­ï¼Œprepare é˜¶æ®µä¹Ÿä¼šæ¶‰åŠåˆ°ç£ç›˜åˆ·æ–°æ“ä½œã€‚è¯¦è§ï¼š<a href="https://dev.mysql.com/doc/refman/5.7/en/innodb-parameters.html#sysvar_innodb_support_xa" target="_blank" rel="noopener noreferrer">innodb_support_xa</a></p><p>ç¦ç”¨ <code>innodb_support_xa</code> å¯èƒ½ä¼šå¯¼è‡´å¤åˆ¶ä¸å®‰å…¨ï¼Œå› æ­¤MySQLç¦æ­¢äº†ä¸äºŒè¿›åˆ¶æ—¥å¿—ç»„æäº¤ç›¸å…³çš„æ€§èƒ½æå‡ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä» MySQL 5.7.10 ç‰ˆæœ¬å¼€å§‹ï¼Œè¿™ä¸ªåŠŸèƒ½å§‹ç»ˆæ˜¯å¼€å¯çš„ï¼Œä¸å…è®¸å†ç¦ç”¨ã€‚</p></div><ol start="2"><li><p><strong>Binlog å†™å…¥ï¼š</strong> Binlog å†™å…¥æˆåŠŸåï¼Œå†è¿›å…¥ Redo Log çš„ Commit é˜¶æ®µã€‚ ç¡®ä¿ Binlog å’Œ Redo Log çš„ä½ç½®ï¼ˆLSNï¼‰ä¸€è‡´ã€‚</p></li><li><p><strong>Commit é˜¶æ®µï¼š</strong> Redo Log å†™å…¥ Commit æ ‡è®°ï¼Œè¡¨ç¤ºäº‹åŠ¡å®Œæˆã€‚ è‹¥ç³»ç»Ÿå´©æºƒååªæ‰¾åˆ° Prepare çŠ¶æ€çš„ Redo Logï¼Œäº‹åŠ¡ä¼šè¢«å›æ»šï¼ˆä¿è¯ä¸€è‡´æ€§ï¼‰ã€‚</p></li></ol><div class="hint-container info"><p class="hint-container-title">Redo Log -- å´©æºƒæ¢å¤ï¼ˆè‡ªåŠ¨æ¢å¤æœºåˆ¶ï¼‰</p><p>MySQL çš„æ¢å¤è¿‡ç¨‹æ˜¯å®Œå…¨è‡ªåŠ¨çš„ï¼Œå‘ç”Ÿåœ¨å®ä¾‹å¯åŠ¨æ—¶ï¼ˆå¯åŠ¨æ—¶å´©æºƒæ¢å¤ï¼‰ï¼š</p><ul><li>MySQL æ£€æŸ¥ InnoDB çš„äº‹åŠ¡æ—¥å¿—ï¼ˆRedo Logï¼‰å’Œ Server å±‚çš„ Binlogã€‚</li><li>æ ¹æ® Redo Log çš„ <strong>Prepare</strong> å’Œ <strong>Commit</strong> çŠ¶æ€ç¡®å®šäº‹åŠ¡çš„å®Œæˆæƒ…å†µã€‚</li><li>æœªæäº¤çš„äº‹åŠ¡ä¼šè¢«å›æ»šï¼Œå·²æäº¤çš„äº‹åŠ¡ä¼šé€šè¿‡é‡æ”¾æ—¥å¿—æ¢å¤ã€‚</li></ul><h4 id="_1-äº‹åŠ¡æœªå®Œæˆ-æœªæäº¤" tabindex="-1"><a class="header-anchor" href="#_1-äº‹åŠ¡æœªå®Œæˆ-æœªæäº¤"><span><strong>ï¼ˆ1ï¼‰äº‹åŠ¡æœªå®Œæˆï¼ˆæœªæäº¤ï¼‰ï¼š</strong></span></a></h4><p>å¦‚æœäº‹åŠ¡åœ¨ <strong>Commit é˜¶æ®µä¹‹å‰</strong>ï¼ˆRedo Log è¿˜å¤„äº <strong>Prepare çŠ¶æ€</strong>ï¼‰ï¼ŒMySQL ä¼šè‡ªåŠ¨å›æ»šè¯¥äº‹åŠ¡ï¼šä½¿ç”¨ <strong>Undo Log</strong> å›æ»šäº‹åŠ¡ï¼Œå°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹ä¹‹å‰çš„çŠ¶æ€ã€‚</p><h4 id="_2-äº‹åŠ¡å·²æäº¤" tabindex="-1"><a class="header-anchor" href="#_2-äº‹åŠ¡å·²æäº¤"><span><strong>ï¼ˆ2ï¼‰äº‹åŠ¡å·²æäº¤ï¼š</strong></span></a></h4><p>å¦‚æœäº‹åŠ¡å·²ç»å®Œæˆ <strong>Commit é˜¶æ®µ</strong>ï¼ˆRedo Log æœ‰ <strong>Commit æ ‡è®°</strong>ï¼‰ï¼Œä½†å°šæœªå°†æ•°æ®é¡µåˆ·å›ç£ç›˜ï¼ŒMySQL ä¼šé€šè¿‡ <strong>Redo Log</strong> è‡ªåŠ¨é‡åšäº‹åŠ¡ï¼šé€šè¿‡è¯»å– Redo Logï¼Œå°†äº‹åŠ¡å¯¹åº”çš„æ•°æ®ä¿®æ”¹é‡æ–°åº”ç”¨åˆ°æ•°æ®é¡µï¼ˆå³ä½¿æ•°æ®é¡µå°šæœªå†™å…¥ç£ç›˜ï¼‰ã€‚</p><h4 id="_3-ç»“åˆ-binlog-å’Œ-redo-log-çš„ä¸€è‡´æ€§æ¢å¤" tabindex="-1"><a class="header-anchor" href="#_3-ç»“åˆ-binlog-å’Œ-redo-log-çš„ä¸€è‡´æ€§æ¢å¤"><span><strong>ï¼ˆ3ï¼‰ç»“åˆ Binlog å’Œ Redo Log çš„ä¸€è‡´æ€§æ¢å¤ï¼š</strong></span></a></h4><p>å¯¹äºç»å¤§å¤šæ•°åœºæ™¯ï¼Œæ¢å¤è¿‡ç¨‹æ˜¯å…¨è‡ªåŠ¨çš„ï¼Œä½†å»ºè®®å®šæœŸå¤‡ä»½æ•°æ®ä»¥åº”å¯¹æç«¯æƒ…å†µã€‚</p></div><p><strong>å…³é”®å‚æ•°çš„æç¤ºå’Œä¼˜åŒ–</strong></p><ol><li><p><strong><code>innodb_flush_log_at_trx_commit</code>ï¼š</strong> æ§åˆ¶ Redo Log çš„åˆ·ç›˜ç­–ç•¥ï¼š</p><ul><li><code>1</code>ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶åˆ·ç›˜ï¼Œæä¾›æœ€é«˜çš„æ•°æ®å®‰å…¨æ€§ã€‚</li><li><code>0</code>ï¼šä¸å®æ—¶åˆ·ç›˜ï¼Œæ€§èƒ½é«˜ä½†å¯èƒ½ä¸¢å¤±æ•°æ®ã€‚</li><li><code>2</code>ï¼šäº‹åŠ¡æäº¤æ—¶å†™å…¥ OS ç¼“å†²åŒºï¼Œå®šæ—¶åˆ·ç›˜ã€‚</li></ul></li><li><p><strong><code>sync_binlog</code>ï¼š</strong> æ§åˆ¶ Binlog çš„åˆ·ç›˜ç­–ç•¥ï¼š</p><ul><li><code>1</code>ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶åŒæ­¥åˆ°ç£ç›˜ï¼Œç¡®ä¿ Binlog çš„æŒä¹…æ€§ã€‚</li><li>è¾ƒå¤§çš„å€¼ï¼ˆå¦‚ <code>100</code>ï¼‰å¯ä»¥æé«˜æ€§èƒ½ï¼Œä½†å¯èƒ½ä¸¢å¤±æœ€è¿‘çš„äº‹åŠ¡æ—¥å¿—ã€‚</li></ul></li><li><p><strong><code>innodb_log_buffer_size</code>ï¼š</strong> å¢å¤§æ—¥å¿—ç¼“å†²åŒºå¯ä»¥å‡å°‘ç£ç›˜ I/Oï¼Œä½†è¿‡å¤§å¯èƒ½æµªè´¹å†…å­˜ã€‚</p></li></ol><div class="hint-container warning"><p class="hint-container-title">æ€»ç»“</p><ul><li><strong>MySQL è‡ªåŠ¨æ¢å¤æ•°æ®</strong>ï¼šå½“æœºå™¨æ–­ç”µæˆ–å´©æºƒæ—¶ï¼ŒMySQL ä¼šæ ¹æ® <strong>Redo Log</strong> å’Œ <strong>Binlog</strong> è‡ªåŠ¨æ¢å¤äº‹åŠ¡ï¼Œç¡®ä¿æ•°æ®ä¸€è‡´æ€§å’ŒæŒä¹…æ€§ã€‚</li><li><strong>ä¸¤é˜¶æ®µæäº¤ä¿éšœä¸€è‡´æ€§</strong>ï¼šé€šè¿‡ä¸¤é˜¶æ®µæäº¤æœºåˆ¶ï¼Œç¡®ä¿ Redo Log å’Œ Binlog çš„ä¸€è‡´æ€§ï¼Œæ— éœ€æ‰‹åŠ¨ä»‹å…¥ã€‚</li><li><strong>å»ºè®®å¯ç”¨å®‰å…¨å‚æ•°</strong>ï¼šå¦‚ <code>innodb_flush_log_at_trx_commit=1</code> å’Œ <code>sync_binlog=1</code>ï¼Œä»¥æœ€å¤§ç¨‹åº¦å‡å°‘æ•°æ®ä¸¢å¤±é£é™©ã€‚</li></ul></div><h3 id="redo-log" tabindex="-1"><a class="header-anchor" href="#redo-log"><span>Redo Log</span></a></h3><p>Redo Log æ˜¯ç‰©ç†å¢é‡æ—¥å¿—ï¼Œæ ¸å¿ƒåœ¨äºæŒä¹…æ€§ã€æ€§èƒ½ä¼˜åŒ–å’Œå´©æºƒæ¢å¤ã€‚</p><ul><li><strong>æŒä¹…æ€§ä¿è¯ï¼ˆDurabilityï¼‰ï¼š</strong> ç¡®ä¿äº‹åŠ¡çš„ä¿®æ”¹åœ¨æäº¤å‰å·²å†™å…¥æ—¥å¿—ï¼Œå³ä½¿ç³»ç»Ÿå´©æºƒä¹Ÿèƒ½æ¢å¤ã€‚</li><li><strong>å´©æºƒæ¢å¤ï¼š</strong> ä¸‡ä¸€æ–­ç”µæˆ–è€…æ•°æ®åº“æŒ‚äº†ï¼Œåœ¨é‡å¯æ—¶æ ¹æ®redoæ—¥å¿—ä¸­çš„è®°å½•å°±å¯ä»¥å°†æ•°æ®è‡ªåŠ¨æ¢å¤ã€‚</li></ul><div class="hint-container important"><p class="hint-container-title">Redo Log æ–‡ä»¶</p><ul><li><strong>æ—¥å¿—æ¡ç›®ç»“æ„ï¼š</strong> åŒ…æ‹¬äº‹åŠ¡ IDã€æ•°æ®é¡µç¼–å·ã€é¡µåç§»é‡ã€ä¿®æ”¹å†…å®¹ç­‰ä¿¡æ¯ã€‚</li><li><strong>æ–‡ä»¶ç»„æˆï¼š</strong> Redo Log ç”±å¤šä¸ªæ—¥å¿—æ–‡ä»¶ç»„æˆï¼ˆå¦‚ <code>ib_logfile0</code>ã€<code>ib_logfile1</code>ï¼Œé»˜è®¤ä¸º 2 ä¸ª, ä½äº MySQL æ•°æ®ç›®å½•ä¸­ï¼‰ï¼Œä»¥ç¯å½¢æ–¹å¼å†™å…¥</li></ul><figure><img src="https://image.ventix.top/img02/20220117040655928.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ul><li>write posï¼ˆå†™å…¥ä½ç½®ï¼‰è¡¨ç¤ºå½“å‰æ—¥å¿—å†™å…¥çš„ä½ç½®ã€‚éšç€äº‹åŠ¡æ‰§è¡Œï¼Œwrite pos å‘å‰ç§»åŠ¨ã€‚</li><li>åªæœ‰å¯¹åº”æ—¥å¿—åˆ·å…¥æ•°æ®æ–‡ä»¶ï¼ˆå³æ•°æ®é¡µå†™å…¥ç£ç›˜ï¼‰åï¼Œcheckpoint æ‰èƒ½æ¨è¿›ã€‚</li></ul><p>å¦‚æœ write pos è¿½ä¸Šäº† checkpointï¼Œè¯´æ˜ç¯å½¢æ—¥å¿—ç©ºé—´å·²æ»¡ï¼ŒMySQL æš‚æ—¶åœæ­¢å†™å…¥ã€‚æ­¤æ—¶åº”è¯¥æ¨è¿› checkpointï¼Œæ“¦é™¤å·²åˆ·å…¥ç£ç›˜çš„æ•°æ®æ—¥å¿—ï¼Œé‡Šæ”¾æ›´å¤šç©ºé—´ã€‚</p></div><p>ä» MySQL 8.0 å¼€å§‹ï¼ŒRedo Log æ–‡ä»¶æœ‰æ‰€å˜åŒ–ï¼š<code>/var/lib/mysql/&#39;#innodb_redo&#39;/&#39;#ib_redo13&#39;</code></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%innodb_log_group_home_dir%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ./ æ•°æ®ç›®å½•</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SHOW</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> VARIABLES</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LIKE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;datadir&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  datadir  /var/lib/mysql/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ç›¸å…³å‚æ•°åŠä½œç”¨" tabindex="-1"><a class="header-anchor" href="#ç›¸å…³å‚æ•°åŠä½œç”¨"><span><strong>ç›¸å…³å‚æ•°åŠä½œç”¨</strong></span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%innodb_log_file_size%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%innodb_log_files_in_group%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th><strong>å‚æ•°</strong></th><th><strong>ä½œç”¨</strong></th><th><strong>é»˜è®¤å€¼</strong></th></tr></thead><tbody><tr><td><code>innodb_log_file_size</code></td><td>æ¯ä¸ª Redo Log æ–‡ä»¶çš„å¤§å°ï¼Œå½±å“æ—¥å¿—å¾ªç¯é¢‘ç‡å’Œå´©æºƒæ¢å¤æ—¶é—´</td><td>48MB</td></tr><tr><td><code>innodb_log_files_in_group</code></td><td>Redo Log æ–‡ä»¶çš„æ•°é‡ï¼Œé»˜è®¤ 2 ä¸ªï¼Œç»„æˆç¯å½¢æ—¥å¿—ç»„</td><td>2</td></tr><tr><td><code>innodb_log_buffer_size</code></td><td>Redo Log Buffer çš„å¤§å°ï¼Œè¾ƒå¤§çš„å€¼å‡å°‘åˆ·ç›˜é¢‘ç‡ï¼ˆé€‚åˆé«˜äº‹åŠ¡é‡åœºæ™¯ï¼‰</td><td>16MB</td></tr><tr><td><code>innodb_flush_log_at_trx_commit</code></td><td>æ§åˆ¶äº‹åŠ¡æäº¤æ—¶æ—¥å¿—åˆ·ç›˜çš„ç­–ç•¥</td><td>1</td></tr><tr><td><code>innodb_flush_method</code></td><td>æ§åˆ¶æ—¥å¿—å’Œæ•°æ®æ–‡ä»¶åˆ·ç›˜æ–¹å¼ï¼šå¦‚ <code>O_DIRECT</code>ï¼ˆè·³è¿‡æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼‰ã€<code>fsync</code>ï¼ˆé»˜è®¤ï¼‰ã€‚</td><td><code>fsync</code></td></tr></tbody></table><p>Redo Logåˆ·ç›˜æ—¶æœºç”±<code>innodb_flush_log_at_trx_commit</code>å‚æ•°æ§åˆ¶ï¼Œè¯¦è§ï¼š<a href="https://dev.mysql.com/doc/refman/8.4/en/innodb-parameters.html#sysvar_innodb_flush_log_at_trx_commit" target="_blank" rel="noopener noreferrer">innodb-parameters</a></p><p>è¿™é‡Œçš„<mark>åˆ·ç›˜</mark>æŒ‡çš„æ˜¯<code>Redo Buffer -&gt; OS cache -&gt; flush cache to disk</code>ï¼Œ<code>fsync()</code> çš„ä½œç”¨å°±æ˜¯å¼ºåˆ¶å°†å†…æ ¸ç¼“å†²åŒºä¸­çš„æ•°æ®å†™å…¥åˆ°ç£ç›˜</p><ul><li>1ï¼ˆdefaultï¼‰: æ¯æ¬¡äº‹åŠ¡æäº¤éƒ½æ‰§è¡Œåˆ·ç›˜ï¼Œæœ€å®‰å…¨ï¼Œæ€§èƒ½æœ€å·®çš„æ–¹å¼</li><li>0ï¼šæ¯ç§’æ‰§è¡Œä¸€æ¬¡åˆ·ç›˜ï¼Œå¯èƒ½ä¸¢å¤±ä¸€ç§’å†…çš„äº‹åŠ¡æ•°æ®</li><li>2ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ‰§è¡Œ <code>Redo Buffer -&gt; OS cache</code>ï¼Œç”±åå°Masterçº¿ç¨‹æ¯éš”1ç§’è°ƒç”¨<code>fsync()</code></li></ul><div class="hint-container tip"><p class="hint-container-title">åˆ·ç›˜æœºåˆ¶ç›¸å…³çš„æ€§èƒ½ä¼˜åŒ–</p><ol><li><strong>å‚æ•°è°ƒä¼˜ï¼š</strong><ul><li>å¢å¤§ <code>innodb_log_file_size</code> å’Œ <code>innodb_log_buffer_size</code>ï¼Œå‡å°‘æ—¥å¿—åˆ‡æ¢å’Œåˆ·ç›˜é¢‘ç‡ã€‚</li><li>æ ¹æ®ä¸šåŠ¡éœ€æ±‚è°ƒæ•´ <code>innodb_flush_log_at_trx_commit</code>ï¼ˆå¦‚è®¾ç½®ä¸º <code>2</code> æå‡æ€§èƒ½ï¼‰ã€‚</li></ul></li><li><strong>ç¡¬ä»¶ä¼˜åŒ–ï¼š</strong><ul><li>ä½¿ç”¨é«˜é€Ÿå­˜å‚¨è®¾å¤‡ï¼ˆå¦‚ NVMe SSDï¼‰æå‡åˆ·ç›˜é€Ÿåº¦ã€‚</li><li>ä¸ºæ—¥å¿—å­˜å‚¨ç‹¬ç«‹åˆ†åŒºï¼Œé¿å…ä¸æ•°æ®æ–‡ä»¶ç«äº‰ I/Oã€‚</li></ul></li><li><strong>æ‰¹é‡äº‹åŠ¡ï¼š</strong> åˆå¹¶å¤šä¸ªå°äº‹åŠ¡ä¸ºä¸€ä¸ªå¤§äº‹åŠ¡ï¼Œé™ä½æ—¥å¿—å†™å…¥é¢‘ç‡ã€‚</li></ol></div><h3 id="binlog" tabindex="-1"><a class="header-anchor" href="#binlog"><span>Binlog</span></a></h3><p>Binary logï¼ˆäºŒè¿›åˆ¶æ—¥å¿—ï¼‰ï¼Œç®€ç§°Binlogï¼ˆMySQL Serverè‡ªå·±çš„æ—¥å¿—ï¼‰ã€‚Binlogæ˜¯è®°å½•æ‰€æœ‰æ•°æ®åº“<mark>è¡¨ç»“æ„å˜æ›´</mark>ä»¥åŠ<mark>è¡¨æ•°æ®ä¿®æ”¹</mark>çš„<strong>äºŒè¿›åˆ¶æ—¥å¿—</strong>ï¼Œä¸ä¼šè®°å½•SELECTå’ŒSHOWè¿™ç±»æ“ä½œã€‚Binlogæ—¥å¿—æ˜¯ä»¥<strong>äº‹ä»¶å½¢å¼</strong>è®°å½•ï¼Œè¿˜åŒ…å«è¯­å¥æ‰€æ‰§è¡Œçš„æ¶ˆè€—æ—¶é—´ã€‚å¼€å¯Binlogæ—¥å¿—æœ‰ä»¥ä¸‹ä¸¤ä¸ªæœ€é‡è¦çš„ä½¿ç”¨åœºæ™¯ã€‚</p><ul><li>ä¸»ä»å¤åˆ¶ï¼šåœ¨ä¸»åº“ä¸­å¼€å¯BinlogåŠŸèƒ½ï¼Œè¿™æ ·ä¸»åº“å°±å¯ä»¥æŠŠBinlogä¼ é€’ç»™ä»åº“ï¼Œä»åº“æ‹¿åˆ°Binlogåå®ç°æ•°æ®æ¢å¤è¾¾åˆ°ä¸»ä»æ•°æ®ä¸€è‡´æ€§ã€‚</li><li>æ•°æ®æ¢å¤ï¼šé€šè¿‡<code>mysqlbinlog</code>å·¥å…·æ¥æ¢å¤æ•°æ®ã€‚</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;log_bin&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;      </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># BinlogçŠ¶æ€æŸ¥çœ‹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;                   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Binlogå¼€å¯åå¯ä»¥æŸ¥çœ‹æœ‰å¤šå°‘binlogæ–‡ä»¶</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>MySQL5.7 ç‰ˆæœ¬ä¸­Binlogé»˜è®¤æ˜¯å…³é—­çš„ï¼Œ8.0ç‰ˆæœ¬é»˜è®¤æ˜¯å¼€å¯çš„ã€‚å¼€å¯Binlogéœ€è¦ä¿®æ”¹<code>my.cnf</code>æˆ–<code>my.ini</code>é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯MySQLæœåŠ¡ã€‚</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">log_bin</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/var/lib/mysql/mysql-binlog</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">binlog-format</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">ROW</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">server-id</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">expire_logs_days</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¼€å¯ Binlog åï¼Œé»˜è®¤å¯ä»¥åœ¨æ•°æ®ç›®å½•æŸ¥çœ‹åˆ°å…·ä½“çš„ Binlog æ–‡ä»¶ï¼š<code>ls /var/lib/mysql/</code></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">topple@Ubuntu22:~$</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ls</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /docker/mysql/mysql5.7/data/</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">auto.cnf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         client-key.pem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ib_logfile1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  mysql-bin.000001</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  mysql-binlog.000001</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  private_key.pem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  sys</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ca-key.pem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       demo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            ibdata1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      mysql-bin.000002</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  mysql-binlog.index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   public_key.pem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ca.pem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           ib_buffer_pool</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ibtmp1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       mysql-bin.000003</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  mysql.sock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           server-cert.pem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">client-cert.pem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  ib_logfile0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     mysql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        mysql-bin.index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   performance_schema</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   server-key.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å‘ç”Ÿä»¥ä¸‹ä»»ä½•äº‹ä»¶æ—¶, binlogæ—¥å¿—æ–‡ä»¶ä¼šé‡æ–°ç”Ÿæˆï¼š</p><ul><li>æœåŠ¡å™¨å¯åŠ¨æˆ–é‡æ–°å¯åŠ¨</li><li>æœåŠ¡å™¨åˆ·æ–°æ—¥å¿—ï¼Œæ‰§è¡Œå‘½ä»¤<code>flush logs</code></li><li>æ—¥å¿—æ–‡ä»¶å¤§å°è¾¾åˆ°Â <code>max_binlog_size</code>Â å€¼ï¼Œé»˜è®¤å€¼ä¸ºÂ 1GB</li></ul><div class="hint-container info"><p class="hint-container-title">binlog-formatï¼ˆBinlogæ–‡ä»¶æ ¼å¼ï¼‰</p><p><code>binlog_format</code> å‚æ•°å¯ä»¥è®¾ç½®binlogæ—¥å¿—çš„è®°å½•æ ¼å¼ï¼Œè¯¦è§ï¼š<a href="https://dev.mysql.com/doc/refman/8.4/en/replication-options-binary-log.html#sysvar_binlog_format" target="_blank" rel="noopener noreferrer">binlog_format</a></p><ul><li>ROWï¼ˆrow-based replication, RBRï¼‰ï¼šæ—¥å¿—ä¸­ä¼šè®°å½•æ¯ä¸€è¡Œæ•°æ®è¢«ä¿®æ”¹çš„æƒ…å†µï¼Œç„¶ååœ¨slaveç«¯å¯¹ç›¸åŒçš„æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚<br> ä¼˜ç‚¹ï¼šèƒ½æ¸…æ¥šè®°å½•æ¯ä¸€ä¸ªè¡Œæ•°æ®çš„ä¿®æ”¹ç»†èŠ‚ï¼Œèƒ½å®Œå…¨å®ç°ä¸»ä»æ•°æ®åŒæ­¥å’Œæ•°æ®çš„æ¢å¤ã€‚<br> ç¼ºç‚¹ï¼šæ‰¹é‡æ“ä½œï¼Œä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—ï¼Œå°¤å…¶æ˜¯alter tableä¼šè®©æ—¥å¿—æš´æ¶¨ã€‚</li><li>STATMENTï¼ˆstatement-based replication, SBRï¼‰ï¼šæ¯ä¸€æ¡è¢«ä¿®æ”¹æ•°æ®çš„SQLéƒ½ä¼šè®°å½•åˆ°masterçš„Binlogä¸­ï¼Œslaveåœ¨å¤åˆ¶çš„æ—¶å€™SQLè¿›ç¨‹ä¼šè§£ææˆå’ŒåŸæ¥masterç«¯æ‰§è¡Œè¿‡çš„ç›¸åŒçš„SQLå†æ¬¡æ‰§è¡Œã€‚ç®€ç§°SQLè¯­å¥å¤åˆ¶ã€‚<br> ä¼˜ç‚¹ï¼šæ—¥å¿—é‡å°ï¼Œå‡å°‘ç£ç›˜IOï¼Œæå‡å­˜å‚¨å’Œæ¢å¤é€Ÿåº¦<br> ç¼ºç‚¹ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ä¼šå¯¼è‡´ä¸»ä»æ•°æ®ä¸ä¸€è‡´ï¼Œæ¯”å¦‚last_insert_id()ã€now()ç­‰å‡½æ•°ã€‚</li><li>MIXEDï¼ˆmixed-based replication, MBRï¼‰ï¼šä»¥ä¸Šä¸¤ç§æ¨¡å¼çš„æ··åˆä½¿ç”¨ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨STATEMENTæ¨¡å¼ä¿å­˜binlogï¼Œå¯¹äºSTATEMENTæ¨¡å¼æ— æ³•å¤åˆ¶çš„æ“ä½œä½¿ç”¨ROWæ¨¡å¼ä¿å­˜binlogï¼ŒMySQLä¼šæ ¹æ®æ‰§è¡Œçš„SQLè¯­å¥é€‰æ‹©å†™å…¥æ¨¡å¼ã€‚</li></ul></div><p>è¯¥å‚æ•°åœ¨MySQL5.7.7é»˜è®¤å€¼ä¸º<code>STATEMENT</code>. MySQL5.7.7åŠä»¥åé»˜è®¤å€¼ä¸º <code>ROW</code>. 8.0.34ä¸­è¢«å¼ƒç”¨ï¼Œæœªæ¥å¯èƒ½ä¼šç§»é™¤ï¼Œé»˜è®¤ä½¿ç”¨<code>ROW</code></p><div class="hint-container important"><p class="hint-container-title">sync_binlogï¼ˆBinlogåˆ·ç›˜æœºåˆ¶ï¼‰</p><ul><li>0(default): è¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åª write åˆ° <code>page cache</code>ï¼Œç”±ç³»ç»Ÿè‡ªè¡Œåˆ¤æ–­ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ <code>fsync</code> å†™å…¥ç£ç›˜ã€‚è™½ç„¶æ€§èƒ½å¾—åˆ°æå‡ï¼Œä½†æ˜¯æœºå™¨å®•æœºï¼Œ<code>page cache</code>é‡Œé¢çš„ binlog ä¼šä¸¢å¤±ã€‚</li><li>1ï¼šè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šæ‰§è¡Œ <code>fsync</code> å†™å…¥ç£ç›˜ï¼Œè¿™ç§æ–¹å¼æœ€å®‰å…¨ã€‚</li><li>N(N&gt;1)ï¼šè¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ write åˆ°<code>page cache</code>ï¼Œä½†ç´¯ç§¯Nä¸ªäº‹åŠ¡åæ‰ <code>fsync</code> å†™å…¥ç£ç›˜ï¼Œè¿™ç§å¦‚æœæœºå™¨å®•æœºä¼šä¸¢å¤±Nä¸ªäº‹åŠ¡çš„binlogã€‚</li></ul></div><p>å…³äºMySQLçš„Binlogæ–‡ä»¶æ“ä½œå’Œæ•°æ®æ¢å¤å‚ç…§ï¼š<a class="route-link" href="/posts/db/mysql-binlog.html">mysqlbinlog</a></p><h2 id="mysqlæ—¥å¿—ç®¡ç†" tabindex="-1"><a class="header-anchor" href="#mysqlæ—¥å¿—ç®¡ç†"><span>MySQLæ—¥å¿—ç®¡ç†</span></a></h2><p>MySQL ä¸­çš„æ—¥å¿—æ˜¯æ•°æ®åº“ç®¡ç†å’Œæ•…éšœæ¢å¤çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚åŒ…æ‹¬äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinary Logï¼‰ã€é‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰ã€å›æ»šæ—¥å¿—ï¼ˆUndo Logï¼‰ç­‰ã€‚</p><ul><li><strong>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBinary Logï¼‰</strong>ï¼šè®°å½•æ‰€æœ‰æ›´æ”¹æ“ä½œï¼Œç”¨äºæ•°æ®æ¢å¤å’Œä¸»ä»å¤åˆ¶ã€‚</li><li><strong>é‡åšæ—¥å¿—ï¼ˆRedo Logï¼‰</strong>ï¼šè®°å½•äº‹åŠ¡çš„æ›´æ”¹ï¼Œç”¨äºäº‹åŠ¡æŒä¹…æ€§å’Œå´©æºƒæ¢å¤ã€‚</li><li><strong>å›æ»šæ—¥å¿—ï¼ˆUndo Logï¼‰</strong>ï¼šè®°å½•äº‹åŠ¡å¼€å§‹æ—¶çš„æ•°æ®å¿«ç…§ï¼Œç”¨äºäº‹åŠ¡å›æ»šå’ŒMVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)</li><li><strong>é”™è¯¯æ—¥å¿—ï¼ˆError Logï¼‰</strong>ï¼šè®°å½•æœåŠ¡å™¨çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ã€‚</li><li><strong>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆSlow Query Logï¼‰</strong>ï¼šè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼çš„æŸ¥è¯¢è¯­å¥ã€‚</li><li><strong>æŸ¥è¯¢æ—¥å¿—ï¼ˆGeneral Query Logï¼‰</strong>ï¼šè®°å½•æ‰€æœ‰å®¢æˆ·ç«¯å‘é€çš„æŸ¥è¯¢è¯­å¥ã€‚</li></ul><div class="vp-tabs"><div class="vp-tabs-nav" role="tablist"><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-1254-0" aria-selected="false">BinLog</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-1254-1" aria-selected="false">Redo Log</button><button type="button" class="vp-tab-nav active" role="tab" aria-controls="tab-1254-2" aria-selected="true">Undo Log</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-1254-3" aria-selected="false">é”™è¯¯æ—¥å¿—</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-1254-4" aria-selected="false">æ…¢æŸ¥è¯¢æ—¥å¿—</button><button type="button" class="vp-tab-nav" role="tab" aria-controls="tab-1254-5" aria-selected="false">æŸ¥è¯¢æ—¥å¿—</button></div><!--[--><div class="vp-tab" id="tab-1254-0" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">BinLog</div><!--[--><p>äºŒè¿›åˆ¶æ—¥å¿—è®°å½•äº†æ‰€æœ‰å¯¹æ•°æ®åº“çš„æ›´æ”¹æ“ä½œï¼ŒåŒ…æ‹¬æ•°æ®ä¿®æ”¹ï¼ˆå¦‚ <code>INSERT</code>ã€<code>UPDATE</code>ã€<code>DELETE</code>ï¼‰å’Œç»“æ„ä¿®æ”¹ï¼ˆå¦‚ <code>CREATE</code>ã€<code>ALTER</code>ï¼‰ã€‚è¿™äº›æ—¥å¿—ä»¥äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨ï¼Œä¸»è¦ç”¨äºæ•°æ®æ¢å¤ã€ä¸»ä»å¤åˆ¶å’Œå®¡è®¡ã€‚</p><p>åœ¨ MySQL é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ <code>my.cnf</code> æˆ– <code>my.ini</code>ï¼‰ä¸­å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">log_bin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /path/to/binlog/mysql-bin.log</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">server_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æ¸…é™¤æ—§çš„äºŒè¿›åˆ¶æ—¥å¿—</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">PURGE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BINARY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> LOGS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">TO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;mysql-bin.000005&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">PURGE </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BINARY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> LOGS </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BEFORE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2023-10-01 00:00:00&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-tab" id="tab-1254-1" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">Redo Log</div><!--[--><p>é‡åšæ—¥å¿—æ˜¯ InnoDB å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œç”¨äºå®ç°äº‹åŠ¡çš„æŒä¹…æ€§å’Œå´©æºƒæ¢å¤ã€‚æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶ï¼ŒInnoDB ä¼šå°†äº‹åŠ¡çš„æ›´æ”¹è®°å½•åˆ°é‡åšæ—¥å¿—ä¸­ã€‚å¦‚æœæ•°æ®åº“å‘ç”Ÿå´©æºƒï¼Œå¯ä»¥é€šè¿‡é‡åšæ—¥å¿—æ¢å¤æœªå®Œæˆçš„äº‹åŠ¡ã€‚</p><p>é‡åšæ—¥å¿—çš„é…ç½®å‚æ•°åŒ…æ‹¬æ—¥å¿—æ–‡ä»¶çš„æ•°é‡å’Œå¤§å°ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_file_size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 512M</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_log_files_in_group</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åˆå§‹åŒ–æˆ–æ›´æ”¹é‡åšæ—¥å¿—å¤§å°</strong>ï¼šéœ€è¦å…ˆå…³é—­ MySQL æœåŠ¡ï¼Œåˆ é™¤ç°æœ‰çš„é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œç„¶åé‡æ–°å¯åŠ¨ MySQL æœåŠ¡ã€‚</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/mysql/ib_logfile</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="vp-tab active" id="tab-1254-2" role="tabpanel" aria-expanded="true"><div class="vp-tab-title">Undo Log</div><!--[--><p>å›æ»šæ—¥å¿—ä¹Ÿæ˜¯ InnoDB å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œç”¨äºå®ç°äº‹åŠ¡çš„å›æ»šå’Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰ã€‚æ¯ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼ŒInnoDB ä¼šè®°å½•äº‹åŠ¡å¼€å§‹æ—¶çš„æ•°æ®å¿«ç…§ï¼Œä»¥ä¾¿åœ¨äº‹åŠ¡å›æ»šæˆ–è¯»å–å†å²ç‰ˆæœ¬æ•°æ®æ—¶ä½¿ç”¨ã€‚å›æ»šæ—¥å¿—çš„é…ç½®å‚æ•°åŒ…æ‹¬æ—¥å¿—æ®µçš„æ•°é‡å’Œå¤§å°ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_undo_tablespaces</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">innodb_undo_logs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 128</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å›æ»šæ—¥å¿—çš„ç©ºé—´ç®¡ç†</strong>ï¼šé•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡å¯èƒ½ä¼šå¯¼è‡´å›æ»šæ—¥å¿—ç©ºé—´å ç”¨è¿‡å¤§ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´ <code>innodb_max_undo_log_size</code> å‚æ•°æ¥æ§åˆ¶æœ€å¤§å›æ»šæ—¥å¿—å¤§å°ã€‚</p><p></p><!--]--></div><div class="vp-tab" id="tab-1254-3" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">é”™è¯¯æ—¥å¿—</div><!--[--><p>é”™è¯¯æ—¥å¿—è®°å½•äº† MySQL æœåŠ¡å™¨çš„é”™è¯¯ä¿¡æ¯ã€è­¦å‘Šä¿¡æ¯å’Œå¯åŠ¨ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å¯¹äºè¯Šæ–­å’Œè§£å†³æ•°æ®åº“é—®é¢˜éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ MySQL é…ç½®æ–‡ä»¶ä¸­å¯ç”¨é”™è¯¯æ—¥å¿—ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">log_error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /path/to/error.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>æŸ¥çœ‹é”™è¯¯æ—¥å¿—</strong>ï¼š<div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /path/to/error.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%log_error%&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><!--]--></div><div class="vp-tab" id="tab-1254-4" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">æ…¢æŸ¥è¯¢æ—¥å¿—</div><!--[--><p>æ…¢æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šé˜ˆå€¼çš„æŸ¥è¯¢è¯­å¥ã€‚è¿™äº›æ—¥å¿—æœ‰åŠ©äºè¯†åˆ«å’Œä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆã€‚</p><p>åœ¨ MySQL é…ç½®æ–‡ä»¶ä¸­å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">slow_query_log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">slow_query_log_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /path/to/slow-query.log</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">long_query_time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%slow_query%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;       </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ˜¯å¦å¼€å¯</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> variables</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%long_query_time%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ—¶é•¿</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /path/to/slow-query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>åŠ¨æ€å¯ç”¨æˆ–ç¦ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> GLOBAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> slow_query_log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;ON&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> GLOBAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> slow_query_log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;OFF&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><!--]--></div><div class="vp-tab" id="tab-1254-5" role="tabpanel" aria-expanded="false"><div class="vp-tab-title">æŸ¥è¯¢æ—¥å¿—</div><!--[--><p>æŸ¥è¯¢æ—¥å¿—è®°å½•äº†æ‰€æœ‰å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡å™¨çš„æŸ¥è¯¢è¯­å¥ã€‚è¿™äº›æ—¥å¿—å¯¹äºè°ƒè¯•å’Œå®¡è®¡éå¸¸æœ‰ç”¨ã€‚</p><p>åœ¨ MySQL é…ç½®æ–‡ä»¶ä¸­å¯ç”¨æŸ¥è¯¢æ—¥å¿—ï¼š</p><div class="language-ini line-numbers-mode" data-highlighter="shiki" data-ext="ini" data-title="ini" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">general_log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> 1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#C678DD;">general_log_file</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#98C379;"> /path/to/general-query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>æŸ¥çœ‹æŸ¥è¯¢æ—¥å¿—</strong>ï¼š</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /path/to/general-query.log</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>åŠ¨æ€å¯ç”¨æˆ–ç¦ç”¨æŸ¥è¯¢æ—¥å¿—</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> GLOBAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> general_log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;ON&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SET</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> GLOBAL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> general_log </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;OFF&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">show variables </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">like</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;%general%&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><!--]--></div><!--]--></div></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/ventixy/notebook/edit/main/src/java/database/db/Architecture.md" aria-label="Edit this page on GitHub" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">Last update: </span><!----></div><div class="contributors"><span class="vp-meta-label">Contributors: </span><!--[--><!--[--><span class="vp-meta-info" title="email: msdrizzle@outlook.com">drizzle</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/java/database/db/sql.html" aria-label="MySQLæ•°æ®åº“"><div class="hint"><span class="arrow start"></span>Prev</div><div class="link"><!---->MySQLæ•°æ®åº“</div></a><a class="route-link auto-link next" href="/java/database/db/Transaction.html" aria-label="äº‹åŠ¡ä¸é”æœºåˆ¶"><div class="hint">Next<span class="arrow end"></span></div><div class="link">äº‹åŠ¡ä¸é”æœºåˆ¶<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Default footer</div><div class="vp-copyright">Copyright Â© 2025 ventixy </div></footer></div><!--]--><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-CYbEao8O.js" defer></script>
  </body>
</html>
