import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,b as n,o as l}from"./app-CFnJr-xU.js";const h={};function e(t,i){return l(),a("div",null,i[0]||(i[0]=[n(`<h2 id="binlog文件操作" tabindex="-1"><a class="header-anchor" href="#binlog文件操作"><span>Binlog文件操作</span></a></h2><p>使用MySQL内部命令查看 Binlog 文件基本信息：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;    </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 管理和监控所有的 binlog 文件, 等价于show master logs;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 仅显示当前正在使用的 binlog 文件及其状态信息</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binlog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binlog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> events</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;mysql-binlog.000001&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Binlog文件记录了所有对数据库进行的更改操作，包括 DDL（数据定义语言）和 DML（数据操作语言）语句。这些更改以事件的形式存储在 binlog 文件中，每个事件称为一个 Log Event。<br><code>SHOW BINLOG EVENTS;</code> 命令用于查看 binlog 文件中的这些事件。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binlog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> events</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+---------------------+-----+----------------+-----------+-------------+---------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Log_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Event_type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Server_id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">End_log_pos</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Info</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                                  |</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+---------------------+-----+----------------+-----------+-------------+---------------------------------------+</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |   </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Format_desc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Server</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ver:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5.7.44-log,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Binlog</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ver:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">123</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Previous_gtids</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">154</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |                                       |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">154</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Anonymous_Gtid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">219</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">SET</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> @@SESSION.GTID_NEXT=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;ANONYMOUS&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">219</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Query</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">          |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">291</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">BEGIN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                                 |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">291</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Table_map</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">352</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">table_id:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 109</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (demo.employees)        |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">352</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Update_rows</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">460</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">table_id:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 109</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> STMT_END_F</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       |</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql-binlog.000001</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">460</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Xid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> |         </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">491</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">COMMIT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xid=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">149</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                  |</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+---------------------+-----+----------------+-----------+-------------+---------------------------------------+</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mysqlbinlog" tabindex="-1"><a class="header-anchor" href="#mysqlbinlog"><span>mysqlbinlog</span></a></h3><p><code>mysqlbinlog</code> 是一个用于处理binlog文件的工具，它能够解析并显示 binlog 文件中的内容</p><p>mysqlbinlog相关文档：<a href="https://dev.mysql.com/doc/refman/8.4/en/mysqlbinlog.html" target="_blank" rel="noopener noreferrer">mysqlbinlog</a> ，<a href="https://dev.mysql.com/doc/refman/8.4/en/mysqlbinlog-row-events.html" target="_blank" rel="noopener noreferrer">mysqlbinlog Row Event Display</a></p><div class="hint-container important"><p class="hint-container-title">使用 mysqlbinlog 查看binlog日志内容示例及参数解释</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlbinlog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --no-defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --base64-output=decode-rows</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /docker/mysql/mysql5.7/data/mysql-binlog.000001</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><p><strong><code>--no-defaults</code></strong>：忽略默认配置文件, 确保命令的行为完全由命令行参数控制</p></li><li><p><strong><code>-v</code> (verbose)</strong>：详细模式，增加输出的详细程度，包括更多的元数据和上下文信息</p></li><li><p><strong><code>--base64-output=decode-rows</code></strong>：解码基于行的日志，当 binlog 使用 ROW 格式时，MySQL 会将更改的数据序列化为 Base64 编码的字符串存储在 binlog 中。此选项指示 <code>mysqlbinlog</code> 解码这些 Base64 字符串，并显示实际的行数据变化。</p></li></ul><p>还可以在上述命令末尾加上以下两个查询条件：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">start-datetime</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2021-01-22 00:00:00&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> stop-datetime</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;2021-02-01 00:00:00&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">start-position</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;100&quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> stop-position</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;1230&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>以下是执行 <code>update employees set email=&#39;dee.email@example.com&#39; where customer_id = 1;</code> 这句SQL相关的部分部分Binlog内容：</p><div class="language-log line-numbers-mode" data-highlighter="shiki" data-ext="log" data-title="log" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">/*!*/;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># at </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">291</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">#</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">210117</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 18:38:04</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> server id </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  end_log_pos </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">352</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CRC32 </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0xb48d0531</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  Table_map: \`demo\`.\`employees\` mapped to number </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">109</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># at </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">352</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">#</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">210117</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 18:38:04</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> server id </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  end_log_pos </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">460</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CRC32 </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0x33bb9cf4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  Update_rows: table id </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">109</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> flags: STMT_END_F</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">### UPDATE \`demo\`.\`employees\`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">### WHERE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;John&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Doe&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;new.email@example.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">### SET</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;John&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Doe&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">###   @</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;dee.email@example.com&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># at </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">460</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">#</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">210117</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 18:38:04</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> server id </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  end_log_pos </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">491</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CRC32 </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0xa2da7c66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  Xid = </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">149</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">COMMIT/*!*/;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SET @@</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">SESSION.GTID_NEXT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">= </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;AUTOMATIC&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /* added by mysqlbinlog */ /*!*/;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">DELIMITER ;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"># End of log file</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="hint-container details"><summary>Docker容器内MySQL没有 mysqlbinlog 命令解决办法</summary><h4 id="_1-使用宿主机的mysqlbinlog命令查看-容器映射到宿主机的-binlog-文件" tabindex="-1"><a class="header-anchor" href="#_1-使用宿主机的mysqlbinlog命令查看-容器映射到宿主机的-binlog-文件"><span>1. 使用宿主机的mysqlbinlog命令查看 容器映射到宿主机的 Binlog 文件</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysqlbinlog</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --no-defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -v</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --base64-output=decode-rows</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /docker/mysql/mysql5.7/data/mysql-binlog.000001</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="_2-如果宿主机没有安装mysql-可以单独安装-mysql-client" tabindex="-1"><a class="header-anchor" href="#_2-如果宿主机没有安装mysql-可以单独安装-mysql-client"><span>2. 如果宿主机没有安装MySQL，可以单独安装 mysql-client</span></a></h4><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt-get</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-client</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></details><h3 id="删除binlog文件" tabindex="-1"><a class="header-anchor" href="#删除binlog文件"><span>删除Binlog文件</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除当前的binlog文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除指定日志文件之前的所有日志文件，下面这个是删除6之前的所有日志文件，当前这个文件不删除</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">purge</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;mysql-binlog.000006&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除指定日期前的日志索引中binlog日志文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">purge</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> master</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> logs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> before</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;2021-01-21 14:00:00&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="binlog恢复数据示例" tabindex="-1"><a class="header-anchor" href="#binlog恢复数据示例"><span>Binlog恢复数据示例</span></a></h2><p><a href="https://www.modb.pro/db/1782939026445635584" target="_blank" rel="noopener noreferrer">MySQL使用binlog日志恢复误删的数据</a></p><p><a href="https://note.youdao.com/ynoteshare/index.html?id=f030268c54f18d2116837f8f3ef045bf" target="_blank" rel="noopener noreferrer">Innodb底层原理与Mysql日志机制深入剖析</a></p>`,17)]))}const d=s(h,[["render",e],["__file","mysql-binlog.html.vue"]]),r=JSON.parse(`{"path":"/posts/db/mysql-binlog.html","title":"mysqlbinlog | Binlog文件操作 | 数据恢复","lang":"en-US","frontmatter":{"article":true,"date":"2021-02-09T00:00:00.000Z","category":["Database","MySQL"],"tag":["Database","MySQL","Binlog","mysqlbinlog"],"shortTitle":"Binlog","title":"mysqlbinlog | Binlog文件操作 | 数据恢复","description":"Binlog文件操作 使用MySQL内部命令查看 Binlog 文件基本信息： Binlog文件记录了所有对数据库进行的更改操作，包括 DDL（数据定义语言）和 DML（数据操作语言）语句。这些更改以事件的形式存储在 binlog 文件中，每个事件称为一个 Log Event。 SHOW BINLOG EVENTS; 命令用于查看 binlog 文件中...","head":[["meta",{"property":"og:url","content":"https://x.app/posts/db/mysql-binlog.html"}],["meta",{"property":"og:site_name","content":"Home"}],["meta",{"property":"og:title","content":"mysqlbinlog | Binlog文件操作 | 数据恢复"}],["meta",{"property":"og:description","content":"Binlog文件操作 使用MySQL内部命令查看 Binlog 文件基本信息： Binlog文件记录了所有对数据库进行的更改操作，包括 DDL（数据定义语言）和 DML（数据操作语言）语句。这些更改以事件的形式存储在 binlog 文件中，每个事件称为一个 Log Event。 SHOW BINLOG EVENTS; 命令用于查看 binlog 文件中..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-01-19T15:33:28.000Z"}],["meta",{"property":"article:author","content":"ventixy"}],["meta",{"property":"article:tag","content":"Database"}],["meta",{"property":"article:tag","content":"MySQL"}],["meta",{"property":"article:tag","content":"Binlog"}],["meta",{"property":"article:tag","content":"mysqlbinlog"}],["meta",{"property":"article:published_time","content":"2021-02-09T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-19T15:33:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"mysqlbinlog | Binlog文件操作 | 数据恢复\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-02-09T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-19T15:33:28.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"ventixy\\",\\"url\\":\\"https://www.ventix.top\\"}]}"]]},"headers":[{"level":2,"title":"Binlog文件操作","slug":"binlog文件操作","link":"#binlog文件操作","children":[{"level":3,"title":"mysqlbinlog","slug":"mysqlbinlog","link":"#mysqlbinlog","children":[]},{"level":3,"title":"删除Binlog文件","slug":"删除binlog文件","link":"#删除binlog文件","children":[]}]},{"level":2,"title":"Binlog恢复数据示例","slug":"binlog恢复数据示例","link":"#binlog恢复数据示例","children":[]}],"git":{"createdTime":1737300808000,"updatedTime":1737300808000,"contributors":[{"name":"drizzle","email":"msdrizzle@outlook.com","commits":1}]},"readingTime":{"minutes":2.79,"words":837},"filePathRelative":"posts/db/mysql-binlog.md","localizedDate":"February 9, 2021","excerpt":"<h2>Binlog文件操作</h2>\\n<p>使用MySQL内部命令查看 Binlog 文件基本信息：</p>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">show</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> binary</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> logs</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;    </span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 管理和监控所有的 binlog 文件, 等价于show master logs;</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">show</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> master</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> status</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;  </span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 仅显示当前正在使用的 binlog 文件及其状态信息</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">show</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> binlog</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> events</span><span style=\\"--shiki-light:#383A42;--shiki-dark:#ABB2BF\\">;</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">show</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> binlog</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> events</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> in</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> 'mysql-binlog.000001'</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{d as comp,r as data};
